Log file created at: 2019/02/10 16:36:17
Running on machine: lin-MS-7B47
Log line format: [IWEF]mmdd hh:mm:ss.uuuuuu threadid file:line] msg
I0210 16:36:17.314432 16731 caffe.cpp:218] Using GPUs 0
I0210 16:36:17.327632 16731 caffe.cpp:223] GPU 0: GeForce GTX 1080 Ti
I0210 16:36:17.508469 16731 solver.cpp:44] Initializing solver from parameters: 
train_net: "./alexnet-train-ignet-embed.prototxt"
test_net: "./alexnet-test-ignet-embed.prototxt"
test_iter: 1
test_interval: 5000
base_lr: 0.01
display: 100
max_iter: 20000
lr_policy: "triangular"
power: 1
momentum: 0.9
weight_decay: 0.0005
snapshot: 5000
snapshot_prefix: "./snapshot/1/alex-ignet-embed"
solver_mode: GPU
device_id: 0
train_state {
  level: 0
  stage: ""
}
test_initialization: false
split_iter: 2000
I0210 16:36:17.508572 16731 solver.cpp:77] Creating training net from train_net file: ./alexnet-train-ignet-embed.prototxt
I0210 16:36:17.509004 16731 net.cpp:51] Initializing net from parameters: 
name: "AlexNet-train-ignet"
state {
  phase: TRAIN
  level: 0
  stage: ""
}
layer {
  name: "data"
  type: "ImageData"
  top: "data"
  top: "label"
  top: "extra"
  transform_param {
    scale: 0.0039215689
    mirror: true
    crop_size: 224
    mean_file: "../../data/1/256_train_mean.binaryproto"
  }
  image_data_param {
    source: "../../data/1/train_1.txt"
    batch_size: 32
    shuffle: true
    new_height: 256
    new_width: 256
    root_folder: "../../data/faces/"
    reference: false
  }
}
layer {
  name: "embedding_fc1"
  type: "InnerProduct"
  bottom: "extra"
  top: "embedding_fc1"
  param {
    lr_mult: 0.1
    decay_mult: 0.1
  }
  param {
    lr_mult: 0.2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 256
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "bn_embedding_fc1"
  type: "BatchNorm"
  bottom: "embedding_fc1"
  top: "embedding_fc1"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_embedding_fc1"
  type: "Scale"
  bottom: "embedding_fc1"
  top: "embedding_fc1"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu_embedding_fc1"
  type: "ReLU"
  bottom: "embedding_fc1"
  top: "embedding_fc1"
}
layer {
  name: "embedding_fc2"
  type: "InnerProduct"
  bottom: "embedding_fc1"
  top: "embedding_fc2"
  param {
    lr_mult: 0.1
    decay_mult: 0.1
  }
  param {
    lr_mult: 0.2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 1
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  param {
    name: "conv1_w"
    lr_mult: 1
    decay_mult: 1
  }
  param {
    name: "conv1_b"
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
  }
}
layer {
  name: "bn_conv1"
  type: "BatchNorm"
  bottom: "conv1"
  top: "conv1"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_conv1"
  type: "Scale"
  bottom: "conv1"
  top: "conv1"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "filter_ip2"
  type: "InnerProduct"
  bottom: "embedding_fc2"
  top: "filter_ip2"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 307200
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "pool1"
  bottom: "filter_ip2"
  top: "conv2"
  param {
    name: "conv2_w"
    lr_mult: 1
    decay_mult: 1
  }
  param {
    name: "conv2_b"
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
    weight_operation: COPY
  }
}
layer {
  name: "bn_conv2"
  type: "BatchNorm"
  bottom: "conv2"
  top: "conv2"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_conv2"
  type: "Scale"
  bottom: "conv2"
  top: "conv2"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "filter_ip3"
  type: "InnerProduct"
  bottom: "embedding_fc2"
  top: "filter_ip3"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 884736
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "pool2"
  bottom: "filter_ip3"
  top: "conv3"
  param {
    name: "conv3_w"
    lr_mult: 1
    decay_mult: 1
  }
  param {
    name: "conv3_b"
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
    weight_operation: COPY
  }
}
layer {
  name: "bn_conv3"
  type: "BatchNorm"
  bottom: "conv3"
  top: "conv3"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_conv3"
  type: "Scale"
  bottom: "conv3"
  top: "conv3"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "filter_ip4"
  type: "InnerProduct"
  bottom: "embedding_fc2"
  top: "filter_ip4"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 663552
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  bottom: "filter_ip4"
  top: "conv4"
  param {
    name: "conv4_w"
    lr_mult: 1
    decay_mult: 1
  }
  param {
    name: "conv4_b"
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
    weight_operation: COPY
  }
}
layer {
  name: "bn_conv4"
  type: "BatchNorm"
  bottom: "conv4"
  top: "conv4"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_conv4"
  type: "Scale"
  bottom: "conv4"
  top: "conv4"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "filter_ip5"
  type: "InnerProduct"
  bottom: "embedding_fc2"
  top: "filter_ip5"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 442368
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  bottom: "filter_ip5"
  top: "conv5"
  param {
    name: "conv5_w"
    lr_mult: 1
    decay_mult: 1
  }
  param {
    name: "conv5_b"
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
    weight_operation: COPY
  }
}
layer {
  name: "bn_conv5"
  type: "BatchNorm"
  bottom: "conv5"
  top: "conv5"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_conv5"
  type: "Scale"
  bottom: "conv5"
  top: "conv5"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "filter_ip6"
  type: "InnerProduct"
  bottom: "embedding_fc2"
  top: "filter_ip6"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 4718592
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "feat0"
  type: "Convolution"
  bottom: "pool5"
  bottom: "filter_ip6"
  top: "feat0"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 512
    kernel_size: 6
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
    weight_operation: COPY
  }
}
layer {
  name: "bn_feat0"
  type: "BatchNorm"
  bottom: "feat0"
  top: "feat0"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_feat0"
  type: "Scale"
  bottom: "feat0"
  top: "feat0"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu_feat0"
  type: "ReLU"
  bottom: "feat0"
  top: "feat0"
}
layer {
  name: "filter_ip7"
  type: "InnerProduct"
  bottom: "embedding_fc2"
  top: "filter_ip7"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 512
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "feat1"
  type: "Convolution"
  bottom: "feat0"
  bottom: "filter_ip7"
  top: "feat1"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 1
    kernel_size: 1
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
    weight_operation: COPY
  }
}
layer {
  name: "eucli_loss"
  type: "EuclideanLoss"
  bottom: "feat1"
  bottom: "label"
  top: "eucli_loss"
}
I0210 16:36:17.509327 16731 layer_factory.hpp:77] Creating layer data
I0210 16:36:17.509349 16731 net.cpp:84] Creating Layer data
I0210 16:36:17.509356 16731 net.cpp:380] data -> data
I0210 16:36:17.509369 16731 net.cpp:380] data -> label
I0210 16:36:17.509377 16731 net.cpp:380] data -> extra
I0210 16:36:17.509384 16731 data_transformer.cpp:28] Loading mean file from: ../../data/1/256_train_mean.binaryproto
I0210 16:36:17.511512 16731 image_data_layer.cpp:38] Opening file ../../data/1/train_1.txt
I0210 16:36:17.512238 16731 image_data_layer.cpp:53] Shuffling data
I0210 16:36:17.512333 16731 image_data_layer.cpp:63] A total of 4400 images.
I0210 16:36:17.514838 16731 image_data_layer.cpp:90] output data size: 32,3,224,224
I0210 16:36:17.541429 16731 net.cpp:122] Setting up data
I0210 16:36:17.541455 16731 net.cpp:129] Top shape: 32 3 224 224 (4816896)
I0210 16:36:17.541460 16731 net.cpp:129] Top shape: 32 (32)
I0210 16:36:17.541462 16731 net.cpp:129] Top shape: 32 2 1 1 (64)
I0210 16:36:17.541465 16731 net.cpp:137] Memory required for data: 19267968
I0210 16:36:17.541471 16731 layer_factory.hpp:77] Creating layer embedding_fc1
I0210 16:36:17.541483 16731 net.cpp:84] Creating Layer embedding_fc1
I0210 16:36:17.541489 16731 net.cpp:406] embedding_fc1 <- extra
I0210 16:36:17.541499 16731 net.cpp:380] embedding_fc1 -> embedding_fc1
I0210 16:36:17.542173 16731 net.cpp:122] Setting up embedding_fc1
I0210 16:36:17.542183 16731 net.cpp:129] Top shape: 32 256 (8192)
I0210 16:36:17.542186 16731 net.cpp:137] Memory required for data: 19300736
I0210 16:36:17.542201 16731 layer_factory.hpp:77] Creating layer bn_embedding_fc1
I0210 16:36:17.542207 16731 net.cpp:84] Creating Layer bn_embedding_fc1
I0210 16:36:17.542210 16731 net.cpp:406] bn_embedding_fc1 <- embedding_fc1
I0210 16:36:17.542215 16731 net.cpp:367] bn_embedding_fc1 -> embedding_fc1 (in-place)
I0210 16:36:17.542325 16731 net.cpp:122] Setting up bn_embedding_fc1
I0210 16:36:17.542348 16731 net.cpp:129] Top shape: 32 256 (8192)
I0210 16:36:17.542351 16731 net.cpp:137] Memory required for data: 19333504
I0210 16:36:17.542358 16731 layer_factory.hpp:77] Creating layer scale_embedding_fc1
I0210 16:36:17.542364 16731 net.cpp:84] Creating Layer scale_embedding_fc1
I0210 16:36:17.542366 16731 net.cpp:406] scale_embedding_fc1 <- embedding_fc1
I0210 16:36:17.542371 16731 net.cpp:367] scale_embedding_fc1 -> embedding_fc1 (in-place)
I0210 16:36:17.542397 16731 layer_factory.hpp:77] Creating layer scale_embedding_fc1
I0210 16:36:17.542457 16731 net.cpp:122] Setting up scale_embedding_fc1
I0210 16:36:17.542462 16731 net.cpp:129] Top shape: 32 256 (8192)
I0210 16:36:17.542465 16731 net.cpp:137] Memory required for data: 19366272
I0210 16:36:17.542469 16731 layer_factory.hpp:77] Creating layer relu_embedding_fc1
I0210 16:36:17.542474 16731 net.cpp:84] Creating Layer relu_embedding_fc1
I0210 16:36:17.542477 16731 net.cpp:406] relu_embedding_fc1 <- embedding_fc1
I0210 16:36:17.542481 16731 net.cpp:367] relu_embedding_fc1 -> embedding_fc1 (in-place)
I0210 16:36:17.957996 16731 net.cpp:122] Setting up relu_embedding_fc1
I0210 16:36:17.958057 16731 net.cpp:129] Top shape: 32 256 (8192)
I0210 16:36:17.958061 16731 net.cpp:137] Memory required for data: 19399040
I0210 16:36:17.958067 16731 layer_factory.hpp:77] Creating layer embedding_fc2
I0210 16:36:17.958093 16731 net.cpp:84] Creating Layer embedding_fc2
I0210 16:36:17.958097 16731 net.cpp:406] embedding_fc2 <- embedding_fc1
I0210 16:36:17.958106 16731 net.cpp:380] embedding_fc2 -> embedding_fc2
I0210 16:36:17.958200 16731 net.cpp:122] Setting up embedding_fc2
I0210 16:36:17.958206 16731 net.cpp:129] Top shape: 32 1 (32)
I0210 16:36:17.958209 16731 net.cpp:137] Memory required for data: 19399168
I0210 16:36:17.958218 16731 layer_factory.hpp:77] Creating layer embedding_fc2_embedding_fc2_0_split
I0210 16:36:17.958223 16731 net.cpp:84] Creating Layer embedding_fc2_embedding_fc2_0_split
I0210 16:36:17.958226 16731 net.cpp:406] embedding_fc2_embedding_fc2_0_split <- embedding_fc2
I0210 16:36:17.958230 16731 net.cpp:380] embedding_fc2_embedding_fc2_0_split -> embedding_fc2_embedding_fc2_0_split_0
I0210 16:36:17.958235 16731 net.cpp:380] embedding_fc2_embedding_fc2_0_split -> embedding_fc2_embedding_fc2_0_split_1
I0210 16:36:17.958240 16731 net.cpp:380] embedding_fc2_embedding_fc2_0_split -> embedding_fc2_embedding_fc2_0_split_2
I0210 16:36:17.958245 16731 net.cpp:380] embedding_fc2_embedding_fc2_0_split -> embedding_fc2_embedding_fc2_0_split_3
I0210 16:36:17.958250 16731 net.cpp:380] embedding_fc2_embedding_fc2_0_split -> embedding_fc2_embedding_fc2_0_split_4
I0210 16:36:17.958254 16731 net.cpp:380] embedding_fc2_embedding_fc2_0_split -> embedding_fc2_embedding_fc2_0_split_5
I0210 16:36:17.958307 16731 net.cpp:122] Setting up embedding_fc2_embedding_fc2_0_split
I0210 16:36:17.958312 16731 net.cpp:129] Top shape: 32 1 (32)
I0210 16:36:17.958314 16731 net.cpp:129] Top shape: 32 1 (32)
I0210 16:36:17.958317 16731 net.cpp:129] Top shape: 32 1 (32)
I0210 16:36:17.958320 16731 net.cpp:129] Top shape: 32 1 (32)
I0210 16:36:17.958323 16731 net.cpp:129] Top shape: 32 1 (32)
I0210 16:36:17.958325 16731 net.cpp:129] Top shape: 32 1 (32)
I0210 16:36:17.958328 16731 net.cpp:137] Memory required for data: 19399936
I0210 16:36:17.958329 16731 layer_factory.hpp:77] Creating layer conv1
I0210 16:36:17.958341 16731 net.cpp:84] Creating Layer conv1
I0210 16:36:17.958344 16731 net.cpp:406] conv1 <- data
I0210 16:36:17.958369 16731 net.cpp:380] conv1 -> conv1
I0210 16:36:17.960299 16731 net.cpp:122] Setting up conv1
I0210 16:36:17.960325 16731 net.cpp:129] Top shape: 32 96 54 54 (8957952)
I0210 16:36:17.960328 16731 net.cpp:137] Memory required for data: 55231744
I0210 16:36:17.960337 16731 layer_factory.hpp:77] Creating layer bn_conv1
I0210 16:36:17.960350 16731 net.cpp:84] Creating Layer bn_conv1
I0210 16:36:17.960355 16731 net.cpp:406] bn_conv1 <- conv1
I0210 16:36:17.960362 16731 net.cpp:367] bn_conv1 -> conv1 (in-place)
I0210 16:36:17.960646 16731 net.cpp:122] Setting up bn_conv1
I0210 16:36:17.960654 16731 net.cpp:129] Top shape: 32 96 54 54 (8957952)
I0210 16:36:17.960656 16731 net.cpp:137] Memory required for data: 91063552
I0210 16:36:17.960662 16731 layer_factory.hpp:77] Creating layer scale_conv1
I0210 16:36:17.960669 16731 net.cpp:84] Creating Layer scale_conv1
I0210 16:36:17.960671 16731 net.cpp:406] scale_conv1 <- conv1
I0210 16:36:17.960675 16731 net.cpp:367] scale_conv1 -> conv1 (in-place)
I0210 16:36:17.960703 16731 layer_factory.hpp:77] Creating layer scale_conv1
I0210 16:36:17.960783 16731 net.cpp:122] Setting up scale_conv1
I0210 16:36:17.960788 16731 net.cpp:129] Top shape: 32 96 54 54 (8957952)
I0210 16:36:17.960791 16731 net.cpp:137] Memory required for data: 126895360
I0210 16:36:17.960795 16731 layer_factory.hpp:77] Creating layer relu1
I0210 16:36:17.960799 16731 net.cpp:84] Creating Layer relu1
I0210 16:36:17.960803 16731 net.cpp:406] relu1 <- conv1
I0210 16:36:17.960805 16731 net.cpp:367] relu1 -> conv1 (in-place)
I0210 16:36:17.961205 16731 net.cpp:122] Setting up relu1
I0210 16:36:17.961212 16731 net.cpp:129] Top shape: 32 96 54 54 (8957952)
I0210 16:36:17.961216 16731 net.cpp:137] Memory required for data: 162727168
I0210 16:36:17.961233 16731 layer_factory.hpp:77] Creating layer pool1
I0210 16:36:17.961239 16731 net.cpp:84] Creating Layer pool1
I0210 16:36:17.961242 16731 net.cpp:406] pool1 <- conv1
I0210 16:36:17.961247 16731 net.cpp:380] pool1 -> pool1
I0210 16:36:17.961287 16731 net.cpp:122] Setting up pool1
I0210 16:36:17.961292 16731 net.cpp:129] Top shape: 32 96 27 27 (2239488)
I0210 16:36:17.961295 16731 net.cpp:137] Memory required for data: 171685120
I0210 16:36:17.961298 16731 layer_factory.hpp:77] Creating layer filter_ip2
I0210 16:36:17.961302 16731 net.cpp:84] Creating Layer filter_ip2
I0210 16:36:17.961305 16731 net.cpp:406] filter_ip2 <- embedding_fc2_embedding_fc2_0_split_0
I0210 16:36:17.961309 16731 net.cpp:380] filter_ip2 -> filter_ip2
I0210 16:36:17.964156 16731 net.cpp:122] Setting up filter_ip2
I0210 16:36:17.964190 16731 net.cpp:129] Top shape: 32 307200 (9830400)
I0210 16:36:17.964195 16731 net.cpp:137] Memory required for data: 211006720
I0210 16:36:17.964205 16731 layer_factory.hpp:77] Creating layer conv2
I0210 16:36:17.964229 16731 net.cpp:84] Creating Layer conv2
I0210 16:36:17.964233 16731 net.cpp:406] conv2 <- pool1
I0210 16:36:17.964237 16731 net.cpp:406] conv2 <- filter_ip2
I0210 16:36:17.964241 16731 net.cpp:380] conv2 -> conv2
I0210 16:36:17.966773 16731 net.cpp:122] Setting up conv2
I0210 16:36:17.966784 16731 net.cpp:129] Top shape: 32 256 27 27 (5971968)
I0210 16:36:17.966786 16731 net.cpp:137] Memory required for data: 234894592
I0210 16:36:17.966790 16731 layer_factory.hpp:77] Creating layer bn_conv2
I0210 16:36:17.966796 16731 net.cpp:84] Creating Layer bn_conv2
I0210 16:36:17.966799 16731 net.cpp:406] bn_conv2 <- conv2
I0210 16:36:17.966802 16731 net.cpp:367] bn_conv2 -> conv2 (in-place)
I0210 16:36:17.966924 16731 net.cpp:122] Setting up bn_conv2
I0210 16:36:17.966930 16731 net.cpp:129] Top shape: 32 256 27 27 (5971968)
I0210 16:36:17.966933 16731 net.cpp:137] Memory required for data: 258782464
I0210 16:36:17.966938 16731 layer_factory.hpp:77] Creating layer scale_conv2
I0210 16:36:17.966943 16731 net.cpp:84] Creating Layer scale_conv2
I0210 16:36:17.966945 16731 net.cpp:406] scale_conv2 <- conv2
I0210 16:36:17.966948 16731 net.cpp:367] scale_conv2 -> conv2 (in-place)
I0210 16:36:17.966974 16731 layer_factory.hpp:77] Creating layer scale_conv2
I0210 16:36:17.967044 16731 net.cpp:122] Setting up scale_conv2
I0210 16:36:17.967049 16731 net.cpp:129] Top shape: 32 256 27 27 (5971968)
I0210 16:36:17.967053 16731 net.cpp:137] Memory required for data: 282670336
I0210 16:36:17.967056 16731 layer_factory.hpp:77] Creating layer relu2
I0210 16:36:17.967062 16731 net.cpp:84] Creating Layer relu2
I0210 16:36:17.967065 16731 net.cpp:406] relu2 <- conv2
I0210 16:36:17.967068 16731 net.cpp:367] relu2 -> conv2 (in-place)
I0210 16:36:17.967486 16731 net.cpp:122] Setting up relu2
I0210 16:36:17.967512 16731 net.cpp:129] Top shape: 32 256 27 27 (5971968)
I0210 16:36:17.967515 16731 net.cpp:137] Memory required for data: 306558208
I0210 16:36:17.967519 16731 layer_factory.hpp:77] Creating layer pool2
I0210 16:36:17.967523 16731 net.cpp:84] Creating Layer pool2
I0210 16:36:17.967525 16731 net.cpp:406] pool2 <- conv2
I0210 16:36:17.967530 16731 net.cpp:380] pool2 -> pool2
I0210 16:36:17.967558 16731 net.cpp:122] Setting up pool2
I0210 16:36:17.967563 16731 net.cpp:129] Top shape: 32 256 13 13 (1384448)
I0210 16:36:17.967566 16731 net.cpp:137] Memory required for data: 312096000
I0210 16:36:17.967568 16731 layer_factory.hpp:77] Creating layer filter_ip3
I0210 16:36:17.967573 16731 net.cpp:84] Creating Layer filter_ip3
I0210 16:36:17.967576 16731 net.cpp:406] filter_ip3 <- embedding_fc2_embedding_fc2_0_split_1
I0210 16:36:17.967579 16731 net.cpp:380] filter_ip3 -> filter_ip3
I0210 16:36:17.975119 16731 net.cpp:122] Setting up filter_ip3
I0210 16:36:17.975142 16731 net.cpp:129] Top shape: 32 884736 (28311552)
I0210 16:36:17.975145 16731 net.cpp:137] Memory required for data: 425342208
I0210 16:36:17.975152 16731 layer_factory.hpp:77] Creating layer conv3
I0210 16:36:17.975162 16731 net.cpp:84] Creating Layer conv3
I0210 16:36:17.975167 16731 net.cpp:406] conv3 <- pool2
I0210 16:36:17.975172 16731 net.cpp:406] conv3 <- filter_ip3
I0210 16:36:17.975178 16731 net.cpp:380] conv3 -> conv3
I0210 16:36:17.981745 16731 net.cpp:122] Setting up conv3
I0210 16:36:17.981765 16731 net.cpp:129] Top shape: 32 384 13 13 (2076672)
I0210 16:36:17.981766 16731 net.cpp:137] Memory required for data: 433648896
I0210 16:36:17.981772 16731 layer_factory.hpp:77] Creating layer bn_conv3
I0210 16:36:17.981779 16731 net.cpp:84] Creating Layer bn_conv3
I0210 16:36:17.981782 16731 net.cpp:406] bn_conv3 <- conv3
I0210 16:36:17.981786 16731 net.cpp:367] bn_conv3 -> conv3 (in-place)
I0210 16:36:17.981915 16731 net.cpp:122] Setting up bn_conv3
I0210 16:36:17.981921 16731 net.cpp:129] Top shape: 32 384 13 13 (2076672)
I0210 16:36:17.981925 16731 net.cpp:137] Memory required for data: 441955584
I0210 16:36:17.981930 16731 layer_factory.hpp:77] Creating layer scale_conv3
I0210 16:36:17.981935 16731 net.cpp:84] Creating Layer scale_conv3
I0210 16:36:17.981937 16731 net.cpp:406] scale_conv3 <- conv3
I0210 16:36:17.981940 16731 net.cpp:367] scale_conv3 -> conv3 (in-place)
I0210 16:36:17.981966 16731 layer_factory.hpp:77] Creating layer scale_conv3
I0210 16:36:17.982044 16731 net.cpp:122] Setting up scale_conv3
I0210 16:36:17.982050 16731 net.cpp:129] Top shape: 32 384 13 13 (2076672)
I0210 16:36:17.982053 16731 net.cpp:137] Memory required for data: 450262272
I0210 16:36:17.982060 16731 layer_factory.hpp:77] Creating layer relu3
I0210 16:36:17.982065 16731 net.cpp:84] Creating Layer relu3
I0210 16:36:17.982069 16731 net.cpp:406] relu3 <- conv3
I0210 16:36:17.982071 16731 net.cpp:367] relu3 -> conv3 (in-place)
I0210 16:36:17.982362 16731 net.cpp:122] Setting up relu3
I0210 16:36:17.982368 16731 net.cpp:129] Top shape: 32 384 13 13 (2076672)
I0210 16:36:17.982372 16731 net.cpp:137] Memory required for data: 458568960
I0210 16:36:17.982374 16731 layer_factory.hpp:77] Creating layer filter_ip4
I0210 16:36:17.982380 16731 net.cpp:84] Creating Layer filter_ip4
I0210 16:36:17.982383 16731 net.cpp:406] filter_ip4 <- embedding_fc2_embedding_fc2_0_split_2
I0210 16:36:17.982389 16731 net.cpp:380] filter_ip4 -> filter_ip4
I0210 16:36:17.988339 16731 net.cpp:122] Setting up filter_ip4
I0210 16:36:17.988373 16731 net.cpp:129] Top shape: 32 663552 (21233664)
I0210 16:36:17.988375 16731 net.cpp:137] Memory required for data: 543503616
I0210 16:36:17.988387 16731 layer_factory.hpp:77] Creating layer conv4
I0210 16:36:17.988404 16731 net.cpp:84] Creating Layer conv4
I0210 16:36:17.988423 16731 net.cpp:406] conv4 <- conv3
I0210 16:36:17.988428 16731 net.cpp:406] conv4 <- filter_ip4
I0210 16:36:17.988447 16731 net.cpp:380] conv4 -> conv4
I0210 16:36:17.993870 16731 net.cpp:122] Setting up conv4
I0210 16:36:17.993914 16731 net.cpp:129] Top shape: 32 384 13 13 (2076672)
I0210 16:36:17.993942 16731 net.cpp:137] Memory required for data: 551810304
I0210 16:36:17.993952 16731 layer_factory.hpp:77] Creating layer bn_conv4
I0210 16:36:17.993960 16731 net.cpp:84] Creating Layer bn_conv4
I0210 16:36:17.993964 16731 net.cpp:406] bn_conv4 <- conv4
I0210 16:36:17.993969 16731 net.cpp:367] bn_conv4 -> conv4 (in-place)
I0210 16:36:17.994148 16731 net.cpp:122] Setting up bn_conv4
I0210 16:36:17.994155 16731 net.cpp:129] Top shape: 32 384 13 13 (2076672)
I0210 16:36:17.994171 16731 net.cpp:137] Memory required for data: 560116992
I0210 16:36:17.994179 16731 layer_factory.hpp:77] Creating layer scale_conv4
I0210 16:36:17.994184 16731 net.cpp:84] Creating Layer scale_conv4
I0210 16:36:17.994187 16731 net.cpp:406] scale_conv4 <- conv4
I0210 16:36:17.994192 16731 net.cpp:367] scale_conv4 -> conv4 (in-place)
I0210 16:36:17.994223 16731 layer_factory.hpp:77] Creating layer scale_conv4
I0210 16:36:17.994307 16731 net.cpp:122] Setting up scale_conv4
I0210 16:36:17.994318 16731 net.cpp:129] Top shape: 32 384 13 13 (2076672)
I0210 16:36:17.994323 16731 net.cpp:137] Memory required for data: 568423680
I0210 16:36:17.994328 16731 layer_factory.hpp:77] Creating layer relu4
I0210 16:36:17.994333 16731 net.cpp:84] Creating Layer relu4
I0210 16:36:17.994336 16731 net.cpp:406] relu4 <- conv4
I0210 16:36:17.994339 16731 net.cpp:367] relu4 -> conv4 (in-place)
I0210 16:36:17.994771 16731 net.cpp:122] Setting up relu4
I0210 16:36:17.994799 16731 net.cpp:129] Top shape: 32 384 13 13 (2076672)
I0210 16:36:17.994802 16731 net.cpp:137] Memory required for data: 576730368
I0210 16:36:17.994804 16731 layer_factory.hpp:77] Creating layer filter_ip5
I0210 16:36:17.994810 16731 net.cpp:84] Creating Layer filter_ip5
I0210 16:36:17.994814 16731 net.cpp:406] filter_ip5 <- embedding_fc2_embedding_fc2_0_split_3
I0210 16:36:17.994820 16731 net.cpp:380] filter_ip5 -> filter_ip5
I0210 16:36:17.999318 16731 net.cpp:122] Setting up filter_ip5
I0210 16:36:17.999339 16731 net.cpp:129] Top shape: 32 442368 (14155776)
I0210 16:36:17.999342 16731 net.cpp:137] Memory required for data: 633353472
I0210 16:36:17.999349 16731 layer_factory.hpp:77] Creating layer conv5
I0210 16:36:17.999361 16731 net.cpp:84] Creating Layer conv5
I0210 16:36:17.999387 16731 net.cpp:406] conv5 <- conv4
I0210 16:36:17.999392 16731 net.cpp:406] conv5 <- filter_ip5
I0210 16:36:17.999397 16731 net.cpp:380] conv5 -> conv5
I0210 16:36:18.002918 16731 net.cpp:122] Setting up conv5
I0210 16:36:18.002935 16731 net.cpp:129] Top shape: 32 256 13 13 (1384448)
I0210 16:36:18.002939 16731 net.cpp:137] Memory required for data: 638891264
I0210 16:36:18.002944 16731 layer_factory.hpp:77] Creating layer bn_conv5
I0210 16:36:18.002950 16731 net.cpp:84] Creating Layer bn_conv5
I0210 16:36:18.002954 16731 net.cpp:406] bn_conv5 <- conv5
I0210 16:36:18.002959 16731 net.cpp:367] bn_conv5 -> conv5 (in-place)
I0210 16:36:18.003140 16731 net.cpp:122] Setting up bn_conv5
I0210 16:36:18.003145 16731 net.cpp:129] Top shape: 32 256 13 13 (1384448)
I0210 16:36:18.003149 16731 net.cpp:137] Memory required for data: 644429056
I0210 16:36:18.003154 16731 layer_factory.hpp:77] Creating layer scale_conv5
I0210 16:36:18.003157 16731 net.cpp:84] Creating Layer scale_conv5
I0210 16:36:18.003160 16731 net.cpp:406] scale_conv5 <- conv5
I0210 16:36:18.003163 16731 net.cpp:367] scale_conv5 -> conv5 (in-place)
I0210 16:36:18.003193 16731 layer_factory.hpp:77] Creating layer scale_conv5
I0210 16:36:18.003273 16731 net.cpp:122] Setting up scale_conv5
I0210 16:36:18.003279 16731 net.cpp:129] Top shape: 32 256 13 13 (1384448)
I0210 16:36:18.003283 16731 net.cpp:137] Memory required for data: 649966848
I0210 16:36:18.003286 16731 layer_factory.hpp:77] Creating layer relu5
I0210 16:36:18.003294 16731 net.cpp:84] Creating Layer relu5
I0210 16:36:18.003298 16731 net.cpp:406] relu5 <- conv5
I0210 16:36:18.003300 16731 net.cpp:367] relu5 -> conv5 (in-place)
I0210 16:36:18.003790 16731 net.cpp:122] Setting up relu5
I0210 16:36:18.003798 16731 net.cpp:129] Top shape: 32 256 13 13 (1384448)
I0210 16:36:18.003801 16731 net.cpp:137] Memory required for data: 655504640
I0210 16:36:18.003823 16731 layer_factory.hpp:77] Creating layer pool5
I0210 16:36:18.003830 16731 net.cpp:84] Creating Layer pool5
I0210 16:36:18.003834 16731 net.cpp:406] pool5 <- conv5
I0210 16:36:18.003839 16731 net.cpp:380] pool5 -> pool5
I0210 16:36:18.003872 16731 net.cpp:122] Setting up pool5
I0210 16:36:18.003880 16731 net.cpp:129] Top shape: 32 256 6 6 (294912)
I0210 16:36:18.003896 16731 net.cpp:137] Memory required for data: 656684288
I0210 16:36:18.003899 16731 layer_factory.hpp:77] Creating layer filter_ip6
I0210 16:36:18.003906 16731 net.cpp:84] Creating Layer filter_ip6
I0210 16:36:18.003908 16731 net.cpp:406] filter_ip6 <- embedding_fc2_embedding_fc2_0_split_4
I0210 16:36:18.003913 16731 net.cpp:380] filter_ip6 -> filter_ip6
I0210 16:36:18.042565 16731 net.cpp:122] Setting up filter_ip6
I0210 16:36:18.042593 16731 net.cpp:129] Top shape: 32 4718592 (150994944)
I0210 16:36:18.042598 16731 net.cpp:137] Memory required for data: 1260664064
I0210 16:36:18.042606 16731 layer_factory.hpp:77] Creating layer feat0
I0210 16:36:18.042618 16731 net.cpp:84] Creating Layer feat0
I0210 16:36:18.042623 16731 net.cpp:406] feat0 <- pool5
I0210 16:36:18.042629 16731 net.cpp:406] feat0 <- filter_ip6
I0210 16:36:18.042634 16731 net.cpp:380] feat0 -> feat0
I0210 16:36:18.076105 16731 net.cpp:122] Setting up feat0
I0210 16:36:18.076124 16731 net.cpp:129] Top shape: 32 512 1 1 (16384)
I0210 16:36:18.076128 16731 net.cpp:137] Memory required for data: 1260729600
I0210 16:36:18.076135 16731 layer_factory.hpp:77] Creating layer bn_feat0
I0210 16:36:18.076144 16731 net.cpp:84] Creating Layer bn_feat0
I0210 16:36:18.076148 16731 net.cpp:406] bn_feat0 <- feat0
I0210 16:36:18.076155 16731 net.cpp:367] bn_feat0 -> feat0 (in-place)
I0210 16:36:18.076297 16731 net.cpp:122] Setting up bn_feat0
I0210 16:36:18.076303 16731 net.cpp:129] Top shape: 32 512 1 1 (16384)
I0210 16:36:18.076305 16731 net.cpp:137] Memory required for data: 1260795136
I0210 16:36:18.076310 16731 layer_factory.hpp:77] Creating layer scale_feat0
I0210 16:36:18.076315 16731 net.cpp:84] Creating Layer scale_feat0
I0210 16:36:18.076318 16731 net.cpp:406] scale_feat0 <- feat0
I0210 16:36:18.076324 16731 net.cpp:367] scale_feat0 -> feat0 (in-place)
I0210 16:36:18.076354 16731 layer_factory.hpp:77] Creating layer scale_feat0
I0210 16:36:18.076436 16731 net.cpp:122] Setting up scale_feat0
I0210 16:36:18.076442 16731 net.cpp:129] Top shape: 32 512 1 1 (16384)
I0210 16:36:18.076444 16731 net.cpp:137] Memory required for data: 1260860672
I0210 16:36:18.076449 16731 layer_factory.hpp:77] Creating layer relu_feat0
I0210 16:36:18.076454 16731 net.cpp:84] Creating Layer relu_feat0
I0210 16:36:18.076457 16731 net.cpp:406] relu_feat0 <- feat0
I0210 16:36:18.076462 16731 net.cpp:367] relu_feat0 -> feat0 (in-place)
I0210 16:36:18.076813 16731 net.cpp:122] Setting up relu_feat0
I0210 16:36:18.076822 16731 net.cpp:129] Top shape: 32 512 1 1 (16384)
I0210 16:36:18.076824 16731 net.cpp:137] Memory required for data: 1260926208
I0210 16:36:18.076828 16731 layer_factory.hpp:77] Creating layer filter_ip7
I0210 16:36:18.076834 16731 net.cpp:84] Creating Layer filter_ip7
I0210 16:36:18.076838 16731 net.cpp:406] filter_ip7 <- embedding_fc2_embedding_fc2_0_split_5
I0210 16:36:18.076843 16731 net.cpp:380] filter_ip7 -> filter_ip7
I0210 16:36:18.076927 16731 net.cpp:122] Setting up filter_ip7
I0210 16:36:18.076933 16731 net.cpp:129] Top shape: 32 512 (16384)
I0210 16:36:18.076936 16731 net.cpp:137] Memory required for data: 1260991744
I0210 16:36:18.076941 16731 layer_factory.hpp:77] Creating layer feat1
I0210 16:36:18.076948 16731 net.cpp:84] Creating Layer feat1
I0210 16:36:18.076952 16731 net.cpp:406] feat1 <- feat0
I0210 16:36:18.076956 16731 net.cpp:406] feat1 <- filter_ip7
I0210 16:36:18.076961 16731 net.cpp:380] feat1 -> feat1
I0210 16:36:18.077142 16731 net.cpp:122] Setting up feat1
I0210 16:36:18.077148 16731 net.cpp:129] Top shape: 32 1 1 1 (32)
I0210 16:36:18.077152 16731 net.cpp:137] Memory required for data: 1260991872
I0210 16:36:18.077163 16731 layer_factory.hpp:77] Creating layer eucli_loss
I0210 16:36:18.077184 16731 net.cpp:84] Creating Layer eucli_loss
I0210 16:36:18.077189 16731 net.cpp:406] eucli_loss <- feat1
I0210 16:36:18.077193 16731 net.cpp:406] eucli_loss <- label
I0210 16:36:18.077199 16731 net.cpp:380] eucli_loss -> eucli_loss
I0210 16:36:18.077230 16731 net.cpp:122] Setting up eucli_loss
I0210 16:36:18.077235 16731 net.cpp:129] Top shape: (1)
I0210 16:36:18.077239 16731 net.cpp:132]     with loss weight 1
I0210 16:36:18.077251 16731 net.cpp:137] Memory required for data: 1260991876
I0210 16:36:18.077255 16731 net.cpp:198] eucli_loss needs backward computation.
I0210 16:36:18.077260 16731 net.cpp:198] feat1 needs backward computation.
I0210 16:36:18.077262 16731 net.cpp:198] filter_ip7 needs backward computation.
I0210 16:36:18.077265 16731 net.cpp:198] relu_feat0 needs backward computation.
I0210 16:36:18.077267 16731 net.cpp:198] scale_feat0 needs backward computation.
I0210 16:36:18.077270 16731 net.cpp:198] bn_feat0 needs backward computation.
I0210 16:36:18.077271 16731 net.cpp:198] feat0 needs backward computation.
I0210 16:36:18.077275 16731 net.cpp:198] filter_ip6 needs backward computation.
I0210 16:36:18.077277 16731 net.cpp:198] pool5 needs backward computation.
I0210 16:36:18.077280 16731 net.cpp:198] relu5 needs backward computation.
I0210 16:36:18.077283 16731 net.cpp:198] scale_conv5 needs backward computation.
I0210 16:36:18.077286 16731 net.cpp:198] bn_conv5 needs backward computation.
I0210 16:36:18.077289 16731 net.cpp:198] conv5 needs backward computation.
I0210 16:36:18.077292 16731 net.cpp:198] filter_ip5 needs backward computation.
I0210 16:36:18.077296 16731 net.cpp:198] relu4 needs backward computation.
I0210 16:36:18.077299 16731 net.cpp:198] scale_conv4 needs backward computation.
I0210 16:36:18.077302 16731 net.cpp:198] bn_conv4 needs backward computation.
I0210 16:36:18.077306 16731 net.cpp:198] conv4 needs backward computation.
I0210 16:36:18.077309 16731 net.cpp:198] filter_ip4 needs backward computation.
I0210 16:36:18.077313 16731 net.cpp:198] relu3 needs backward computation.
I0210 16:36:18.077316 16731 net.cpp:198] scale_conv3 needs backward computation.
I0210 16:36:18.077320 16731 net.cpp:198] bn_conv3 needs backward computation.
I0210 16:36:18.077323 16731 net.cpp:198] conv3 needs backward computation.
I0210 16:36:18.077327 16731 net.cpp:198] filter_ip3 needs backward computation.
I0210 16:36:18.077329 16731 net.cpp:198] pool2 needs backward computation.
I0210 16:36:18.077333 16731 net.cpp:198] relu2 needs backward computation.
I0210 16:36:18.077337 16731 net.cpp:198] scale_conv2 needs backward computation.
I0210 16:36:18.077339 16731 net.cpp:198] bn_conv2 needs backward computation.
I0210 16:36:18.077342 16731 net.cpp:198] conv2 needs backward computation.
I0210 16:36:18.077347 16731 net.cpp:198] filter_ip2 needs backward computation.
I0210 16:36:18.077349 16731 net.cpp:198] pool1 needs backward computation.
I0210 16:36:18.077353 16731 net.cpp:198] relu1 needs backward computation.
I0210 16:36:18.077355 16731 net.cpp:198] scale_conv1 needs backward computation.
I0210 16:36:18.077359 16731 net.cpp:198] bn_conv1 needs backward computation.
I0210 16:36:18.077363 16731 net.cpp:198] conv1 needs backward computation.
I0210 16:36:18.077365 16731 net.cpp:198] embedding_fc2_embedding_fc2_0_split needs backward computation.
I0210 16:36:18.077368 16731 net.cpp:198] embedding_fc2 needs backward computation.
I0210 16:36:18.077373 16731 net.cpp:198] relu_embedding_fc1 needs backward computation.
I0210 16:36:18.077375 16731 net.cpp:198] scale_embedding_fc1 needs backward computation.
I0210 16:36:18.077378 16731 net.cpp:198] bn_embedding_fc1 needs backward computation.
I0210 16:36:18.077383 16731 net.cpp:198] embedding_fc1 needs backward computation.
I0210 16:36:18.077386 16731 net.cpp:200] data does not need backward computation.
I0210 16:36:18.077389 16731 net.cpp:242] This network produces output eucli_loss
I0210 16:36:18.077409 16731 net.cpp:255] Network initialization done.
I0210 16:36:18.077507 16731 solver.cpp:172] Creating test net (#0) specified by test_net file: ./alexnet-test-ignet-embed.prototxt
I0210 16:36:18.077540 16731 net.cpp:51] Initializing net from parameters: 
name: "AlexNet_dynamic_test"
state {
  phase: TEST
}
layer {
  name: "accuracy"
  type: "Python"
  top: "accuracy"
  top: "mae"
  top: "rmse"
  python_param {
    module: "correlation"
    layer: "CorrelationLayer"
    param_str: "{\'network_file\': \'./alexnet-deploy-ignet-embed.prototxt\', \'snapshot_prefix\': \'./snapshot/1/alex-ignet-embed_iter_\',\'snapshot_iter\': 5000, \'mean_file\': \'../../data/1/256_train_mean.binaryproto\', \'roots\': \'../../data/faces/\', \'file\': \'../../data/1/test_1.txt\'}"
  }
}
I0210 16:36:18.077556 16731 layer_factory.hpp:77] Creating layer accuracy
I0210 16:36:18.571060 16731 net.cpp:84] Creating Layer accuracy
I0210 16:36:18.571086 16731 net.cpp:380] accuracy -> accuracy
I0210 16:36:18.571099 16731 net.cpp:380] accuracy -> mae
I0210 16:36:18.571105 16731 net.cpp:380] accuracy -> rmse
I0210 16:36:18.571395 16731 net.cpp:122] Setting up accuracy
I0210 16:36:18.571405 16731 net.cpp:129] Top shape: 1 (1)
I0210 16:36:18.571409 16731 net.cpp:129] Top shape: 1 (1)
I0210 16:36:18.571413 16731 net.cpp:129] Top shape: 1 (1)
I0210 16:36:18.571414 16731 net.cpp:137] Memory required for data: 12
I0210 16:36:18.571419 16731 net.cpp:200] accuracy does not need backward computation.
I0210 16:36:18.571420 16731 net.cpp:242] This network produces output accuracy
I0210 16:36:18.571424 16731 net.cpp:242] This network produces output mae
I0210 16:36:18.571427 16731 net.cpp:242] This network produces output rmse
I0210 16:36:18.571430 16731 net.cpp:255] Network initialization done.
I0210 16:36:18.571446 16731 solver.cpp:56] Solver scaffolding done.
I0210 16:36:18.573168 16731 caffe.cpp:248] Starting Optimization
I0210 16:36:18.573176 16731 solver.cpp:272] Solving AlexNet-train-ignet
I0210 16:36:18.573180 16731 solver.cpp:273] Learning Rate Policy: triangular
I0210 16:36:18.758766 16731 solver.cpp:218] Iteration 0 (0 iter/s, 0.185498s/100 iters), loss = 4.62188
I0210 16:36:18.758795 16731 solver.cpp:237]     Train net output #0: eucli_loss = 4.62188 (* 1 = 4.62188 loss)
I0210 16:36:18.758806 16731 sgd_solver.cpp:114] Iteration 0, lr = 0
I0210 16:36:32.984277 16731 solver.cpp:218] Iteration 100 (7.02991 iter/s, 14.2249s/100 iters), loss = 2.43213
I0210 16:36:32.984308 16731 solver.cpp:237]     Train net output #0: eucli_loss = 2.43213 (* 1 = 2.43213 loss)
I0210 16:36:32.984314 16731 sgd_solver.cpp:114] Iteration 100, lr = 0.0005
I0210 16:36:47.253685 16731 solver.cpp:218] Iteration 200 (7.00829 iter/s, 14.2688s/100 iters), loss = 0.267821
I0210 16:36:47.253736 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.267821 (* 1 = 0.267821 loss)
I0210 16:36:47.253744 16731 sgd_solver.cpp:114] Iteration 200, lr = 0.001
I0210 16:37:01.460052 16731 solver.cpp:218] Iteration 300 (7.0394 iter/s, 14.2058s/100 iters), loss = 0.341619
I0210 16:37:01.460180 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.341619 (* 1 = 0.341619 loss)
I0210 16:37:01.460188 16731 sgd_solver.cpp:114] Iteration 300, lr = 0.0015
I0210 16:37:15.643286 16731 solver.cpp:218] Iteration 400 (7.05092 iter/s, 14.1825s/100 iters), loss = 0.230821
I0210 16:37:15.643353 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.230821 (* 1 = 0.230821 loss)
I0210 16:37:15.643362 16731 sgd_solver.cpp:114] Iteration 400, lr = 0.002
I0210 16:37:29.874155 16731 solver.cpp:218] Iteration 500 (7.02729 iter/s, 14.2302s/100 iters), loss = 0.270565
I0210 16:37:29.874187 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.270565 (* 1 = 0.270565 loss)
I0210 16:37:29.874194 16731 sgd_solver.cpp:114] Iteration 500, lr = 0.0025
I0210 16:37:44.467267 16731 solver.cpp:218] Iteration 600 (6.85285 iter/s, 14.5925s/100 iters), loss = 0.154317
I0210 16:37:44.467337 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.154317 (* 1 = 0.154317 loss)
I0210 16:37:44.467345 16731 sgd_solver.cpp:114] Iteration 600, lr = 0.003
I0210 16:37:58.652463 16731 solver.cpp:218] Iteration 700 (7.04996 iter/s, 14.1845s/100 iters), loss = 0.176984
I0210 16:37:58.652511 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.176984 (* 1 = 0.176984 loss)
I0210 16:37:58.652519 16731 sgd_solver.cpp:114] Iteration 700, lr = 0.0035
I0210 16:38:12.831954 16731 solver.cpp:218] Iteration 800 (7.05274 iter/s, 14.1789s/100 iters), loss = 0.247527
I0210 16:38:12.832001 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.247527 (* 1 = 0.247527 loss)
I0210 16:38:12.832008 16731 sgd_solver.cpp:114] Iteration 800, lr = 0.004
I0210 16:38:27.034451 16731 solver.cpp:218] Iteration 900 (7.04132 iter/s, 14.2019s/100 iters), loss = 0.21812
I0210 16:38:27.034687 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.21812 (* 1 = 0.21812 loss)
I0210 16:38:27.034699 16731 sgd_solver.cpp:114] Iteration 900, lr = 0.0045
I0210 16:38:41.275110 16731 solver.cpp:218] Iteration 1000 (7.02254 iter/s, 14.2399s/100 iters), loss = 0.252407
I0210 16:38:41.275156 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.252407 (* 1 = 0.252407 loss)
I0210 16:38:41.275163 16731 sgd_solver.cpp:114] Iteration 1000, lr = 0.005
I0210 16:38:55.527884 16731 solver.cpp:218] Iteration 1100 (7.01648 iter/s, 14.2522s/100 iters), loss = 0.302548
I0210 16:38:55.527917 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.302548 (* 1 = 0.302548 loss)
I0210 16:38:55.527925 16731 sgd_solver.cpp:114] Iteration 1100, lr = 0.0055
I0210 16:39:09.758954 16731 solver.cpp:218] Iteration 1200 (7.02717 iter/s, 14.2305s/100 iters), loss = 0.193929
I0210 16:39:09.759040 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.193929 (* 1 = 0.193929 loss)
I0210 16:39:09.759049 16731 sgd_solver.cpp:114] Iteration 1200, lr = 0.006
I0210 16:39:24.002148 16731 solver.cpp:218] Iteration 1300 (7.02121 iter/s, 14.2426s/100 iters), loss = 0.26083
I0210 16:39:24.002179 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.26083 (* 1 = 0.26083 loss)
I0210 16:39:24.002187 16731 sgd_solver.cpp:114] Iteration 1300, lr = 0.0065
I0210 16:39:38.261464 16731 solver.cpp:218] Iteration 1400 (7.01324 iter/s, 14.2587s/100 iters), loss = 0.24372
I0210 16:39:38.261508 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.24372 (* 1 = 0.24372 loss)
I0210 16:39:38.261518 16731 sgd_solver.cpp:114] Iteration 1400, lr = 0.007
I0210 16:39:52.517617 16731 solver.cpp:218] Iteration 1500 (7.01481 iter/s, 14.2556s/100 iters), loss = 0.201882
I0210 16:39:52.517678 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.201882 (* 1 = 0.201882 loss)
I0210 16:39:52.517685 16731 sgd_solver.cpp:114] Iteration 1500, lr = 0.0075
I0210 16:40:06.786329 16731 solver.cpp:218] Iteration 1600 (7.00864 iter/s, 14.2681s/100 iters), loss = 0.248792
I0210 16:40:06.786360 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.248792 (* 1 = 0.248792 loss)
I0210 16:40:06.786365 16731 sgd_solver.cpp:114] Iteration 1600, lr = 0.008
I0210 16:40:21.051100 16731 solver.cpp:218] Iteration 1700 (7.01056 iter/s, 14.2642s/100 iters), loss = 0.270445
I0210 16:40:21.051127 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.270445 (* 1 = 0.270445 loss)
I0210 16:40:21.051134 16731 sgd_solver.cpp:114] Iteration 1700, lr = 0.0085
I0210 16:40:35.315012 16731 solver.cpp:218] Iteration 1800 (7.01098 iter/s, 14.2633s/100 iters), loss = 0.250075
I0210 16:40:35.315064 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.250075 (* 1 = 0.250075 loss)
I0210 16:40:35.315071 16731 sgd_solver.cpp:114] Iteration 1800, lr = 0.009
I0210 16:40:49.590548 16731 solver.cpp:218] Iteration 1900 (7.00528 iter/s, 14.2749s/100 iters), loss = 0.302887
I0210 16:40:49.590582 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.302887 (* 1 = 0.302887 loss)
I0210 16:40:49.590589 16731 sgd_solver.cpp:114] Iteration 1900, lr = 0.0095
I0210 16:41:03.848713 16731 solver.cpp:218] Iteration 2000 (7.01385 iter/s, 14.2575s/100 iters), loss = 0.135324
I0210 16:41:03.848743 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.135324 (* 1 = 0.135324 loss)
I0210 16:41:03.848750 16731 sgd_solver.cpp:114] Iteration 2000, lr = 0.01
I0210 16:41:18.099939 16731 solver.cpp:218] Iteration 2100 (7.01722 iter/s, 14.2507s/100 iters), loss = 0.0829378
I0210 16:41:18.100162 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0829378 (* 1 = 0.0829378 loss)
I0210 16:41:18.100173 16731 sgd_solver.cpp:114] Iteration 2100, lr = 0.00994444
I0210 16:41:32.385975 16731 solver.cpp:218] Iteration 2200 (7.00021 iter/s, 14.2853s/100 iters), loss = 0.148602
I0210 16:41:32.386008 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.148602 (* 1 = 0.148602 loss)
I0210 16:41:32.386014 16731 sgd_solver.cpp:114] Iteration 2200, lr = 0.00988889
I0210 16:41:46.677392 16731 solver.cpp:218] Iteration 2300 (6.99748 iter/s, 14.2909s/100 iters), loss = 0.090427
I0210 16:41:46.677426 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.090427 (* 1 = 0.090427 loss)
I0210 16:41:46.677433 16731 sgd_solver.cpp:114] Iteration 2300, lr = 0.00983333
I0210 16:42:00.945485 16731 solver.cpp:218] Iteration 2400 (7.00897 iter/s, 14.2674s/100 iters), loss = 0.113639
I0210 16:42:00.945570 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.113639 (* 1 = 0.113639 loss)
I0210 16:42:00.945580 16731 sgd_solver.cpp:114] Iteration 2400, lr = 0.00977778
I0210 16:42:15.209960 16731 solver.cpp:218] Iteration 2500 (7.01073 iter/s, 14.2639s/100 iters), loss = 0.147906
I0210 16:42:15.210012 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.147906 (* 1 = 0.147906 loss)
I0210 16:42:15.210047 16731 sgd_solver.cpp:114] Iteration 2500, lr = 0.00972222
I0210 16:42:29.454473 16731 solver.cpp:218] Iteration 2600 (7.02053 iter/s, 14.2439s/100 iters), loss = 0.0783955
I0210 16:42:29.454501 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0783955 (* 1 = 0.0783955 loss)
I0210 16:42:29.454509 16731 sgd_solver.cpp:114] Iteration 2600, lr = 0.00966667
I0210 16:42:43.728960 16731 solver.cpp:218] Iteration 2700 (7.00578 iter/s, 14.2739s/100 iters), loss = 0.161749
I0210 16:42:43.729033 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.161749 (* 1 = 0.161749 loss)
I0210 16:42:43.729041 16731 sgd_solver.cpp:114] Iteration 2700, lr = 0.00961111
I0210 16:42:58.003064 16731 solver.cpp:218] Iteration 2800 (7.00602 iter/s, 14.2734s/100 iters), loss = 0.0907657
I0210 16:42:58.003100 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0907658 (* 1 = 0.0907658 loss)
I0210 16:42:58.003108 16731 sgd_solver.cpp:114] Iteration 2800, lr = 0.00955555
I0210 16:43:12.271518 16731 solver.cpp:218] Iteration 2900 (7.00874 iter/s, 14.2679s/100 iters), loss = 0.110926
I0210 16:43:12.271550 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.110926 (* 1 = 0.110926 loss)
I0210 16:43:12.271556 16731 sgd_solver.cpp:114] Iteration 2900, lr = 0.0095
I0210 16:43:26.526931 16731 solver.cpp:218] Iteration 3000 (7.01515 iter/s, 14.2549s/100 iters), loss = 0.146454
I0210 16:43:26.527024 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.146454 (* 1 = 0.146454 loss)
I0210 16:43:26.527035 16731 sgd_solver.cpp:114] Iteration 3000, lr = 0.00944444
I0210 16:43:40.808292 16731 solver.cpp:218] Iteration 3100 (7.00243 iter/s, 14.2808s/100 iters), loss = 0.0635404
I0210 16:43:40.808320 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0635404 (* 1 = 0.0635404 loss)
I0210 16:43:40.808326 16731 sgd_solver.cpp:114] Iteration 3100, lr = 0.00938889
I0210 16:43:55.130733 16731 solver.cpp:218] Iteration 3200 (6.98231 iter/s, 14.3219s/100 iters), loss = 0.11112
I0210 16:43:55.130775 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.11112 (* 1 = 0.11112 loss)
I0210 16:43:55.130782 16731 sgd_solver.cpp:114] Iteration 3200, lr = 0.00933333
I0210 16:44:09.461556 16731 solver.cpp:218] Iteration 3300 (6.97829 iter/s, 14.3302s/100 iters), loss = 0.0595742
I0210 16:44:09.461635 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0595743 (* 1 = 0.0595743 loss)
I0210 16:44:09.461643 16731 sgd_solver.cpp:114] Iteration 3300, lr = 0.00927778
I0210 16:44:23.789918 16731 solver.cpp:218] Iteration 3400 (6.97945 iter/s, 14.3278s/100 iters), loss = 0.086113
I0210 16:44:23.789953 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0861131 (* 1 = 0.0861131 loss)
I0210 16:44:23.789961 16731 sgd_solver.cpp:114] Iteration 3400, lr = 0.00922222
I0210 16:44:38.148278 16731 solver.cpp:218] Iteration 3500 (6.96485 iter/s, 14.3578s/100 iters), loss = 0.037446
I0210 16:44:38.148355 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.037446 (* 1 = 0.037446 loss)
I0210 16:44:38.148362 16731 sgd_solver.cpp:114] Iteration 3500, lr = 0.00916667
I0210 16:44:52.485232 16731 solver.cpp:218] Iteration 3600 (6.97527 iter/s, 14.3364s/100 iters), loss = 0.100831
I0210 16:44:52.485406 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.100831 (* 1 = 0.100831 loss)
I0210 16:44:52.485417 16731 sgd_solver.cpp:114] Iteration 3600, lr = 0.00911111
I0210 16:45:06.856946 16731 solver.cpp:218] Iteration 3700 (6.95844 iter/s, 14.371s/100 iters), loss = 0.0851871
I0210 16:45:06.856998 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0851871 (* 1 = 0.0851871 loss)
I0210 16:45:06.857007 16731 sgd_solver.cpp:114] Iteration 3700, lr = 0.00905555
I0210 16:45:21.224265 16731 solver.cpp:218] Iteration 3800 (6.96051 iter/s, 14.3668s/100 iters), loss = 0.0662749
I0210 16:45:21.224293 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.066275 (* 1 = 0.066275 loss)
I0210 16:45:21.224300 16731 sgd_solver.cpp:114] Iteration 3800, lr = 0.009
I0210 16:45:35.596266 16731 solver.cpp:218] Iteration 3900 (6.95823 iter/s, 14.3715s/100 iters), loss = 0.071325
I0210 16:45:35.596354 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.071325 (* 1 = 0.071325 loss)
I0210 16:45:35.596364 16731 sgd_solver.cpp:114] Iteration 3900, lr = 0.00894444
I0210 16:45:49.949362 16731 solver.cpp:218] Iteration 4000 (6.96742 iter/s, 14.3525s/100 iters), loss = 0.0547434
I0210 16:45:49.949391 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0547434 (* 1 = 0.0547434 loss)
I0210 16:45:49.949398 16731 sgd_solver.cpp:114] Iteration 4000, lr = 0.00888889
I0210 16:46:04.317072 16731 solver.cpp:218] Iteration 4100 (6.96031 iter/s, 14.3672s/100 iters), loss = 0.0337595
I0210 16:46:04.317121 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0337596 (* 1 = 0.0337596 loss)
I0210 16:46:04.317128 16731 sgd_solver.cpp:114] Iteration 4100, lr = 0.00883333
I0210 16:46:18.660148 16731 solver.cpp:218] Iteration 4200 (6.97227 iter/s, 14.3425s/100 iters), loss = 0.0771689
I0210 16:46:18.660235 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.077169 (* 1 = 0.077169 loss)
I0210 16:46:18.660244 16731 sgd_solver.cpp:114] Iteration 4200, lr = 0.00877778
I0210 16:46:32.994614 16731 solver.cpp:218] Iteration 4300 (6.97648 iter/s, 14.3339s/100 iters), loss = 0.066534
I0210 16:46:32.994644 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.066534 (* 1 = 0.066534 loss)
I0210 16:46:32.994650 16731 sgd_solver.cpp:114] Iteration 4300, lr = 0.00872222
I0210 16:46:47.336403 16731 solver.cpp:218] Iteration 4400 (6.97289 iter/s, 14.3413s/100 iters), loss = 0.0628371
I0210 16:46:47.336434 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0628372 (* 1 = 0.0628372 loss)
I0210 16:46:47.336441 16731 sgd_solver.cpp:114] Iteration 4400, lr = 0.00866667
I0210 16:47:01.712200 16731 solver.cpp:218] Iteration 4500 (6.95645 iter/s, 14.3752s/100 iters), loss = 0.0316527
I0210 16:47:01.712301 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0316527 (* 1 = 0.0316527 loss)
I0210 16:47:01.712311 16731 sgd_solver.cpp:114] Iteration 4500, lr = 0.00861111
I0210 16:47:16.068192 16731 solver.cpp:218] Iteration 4600 (6.96601 iter/s, 14.3554s/100 iters), loss = 0.0621479
I0210 16:47:16.068236 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.062148 (* 1 = 0.062148 loss)
I0210 16:47:16.068243 16731 sgd_solver.cpp:114] Iteration 4600, lr = 0.00855555
I0210 16:47:30.445492 16731 solver.cpp:218] Iteration 4700 (6.95568 iter/s, 14.3767s/100 iters), loss = 0.0461084
I0210 16:47:30.445564 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0461085 (* 1 = 0.0461085 loss)
I0210 16:47:30.445571 16731 sgd_solver.cpp:114] Iteration 4700, lr = 0.0085
I0210 16:47:44.781664 16731 solver.cpp:218] Iteration 4800 (6.97564 iter/s, 14.3356s/100 iters), loss = 0.0350545
I0210 16:47:44.781826 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0350545 (* 1 = 0.0350545 loss)
I0210 16:47:44.781836 16731 sgd_solver.cpp:114] Iteration 4800, lr = 0.00844444
I0210 16:47:59.144234 16731 solver.cpp:218] Iteration 4900 (6.96286 iter/s, 14.3619s/100 iters), loss = 0.056671
I0210 16:47:59.144263 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0566711 (* 1 = 0.0566711 loss)
I0210 16:47:59.144268 16731 sgd_solver.cpp:114] Iteration 4900, lr = 0.00838889
I0210 16:48:13.366688 16731 solver.cpp:447] Snapshotting to binary proto file ./snapshot/1/alex-ignet-embed_iter_5000.caffemodel
I0210 16:48:13.616477 16731 sgd_solver.cpp:282] Snapshotting solver state to binary proto file ./snapshot/1/alex-ignet-embed_iter_5000.solverstate
I0210 16:48:13.973984 16731 solver.cpp:330] Iteration 5000, Testing net (#0)
I0210 16:48:13.974030 16731 net.cpp:676] Ignoring source layer data
I0210 16:48:13.974040 16731 net.cpp:676] Ignoring source layer embedding_fc1
I0210 16:48:13.974046 16731 net.cpp:676] Ignoring source layer bn_embedding_fc1
I0210 16:48:13.974051 16731 net.cpp:676] Ignoring source layer scale_embedding_fc1
I0210 16:48:13.974059 16731 net.cpp:676] Ignoring source layer relu_embedding_fc1
I0210 16:48:13.974069 16731 net.cpp:676] Ignoring source layer embedding_fc2
I0210 16:48:13.974076 16731 net.cpp:676] Ignoring source layer embedding_fc2_embedding_fc2_0_split
I0210 16:48:13.974082 16731 net.cpp:676] Ignoring source layer conv1
I0210 16:48:13.974092 16731 net.cpp:676] Ignoring source layer bn_conv1
I0210 16:48:13.974099 16731 net.cpp:676] Ignoring source layer scale_conv1
I0210 16:48:13.974104 16731 net.cpp:676] Ignoring source layer relu1
I0210 16:48:13.974112 16731 net.cpp:676] Ignoring source layer pool1
I0210 16:48:13.974118 16731 net.cpp:676] Ignoring source layer filter_ip2
I0210 16:48:13.974125 16731 net.cpp:676] Ignoring source layer conv2
I0210 16:48:13.974131 16731 net.cpp:676] Ignoring source layer bn_conv2
I0210 16:48:13.974138 16731 net.cpp:676] Ignoring source layer scale_conv2
I0210 16:48:13.974144 16731 net.cpp:676] Ignoring source layer relu2
I0210 16:48:13.974153 16731 net.cpp:676] Ignoring source layer pool2
I0210 16:48:13.974159 16731 net.cpp:676] Ignoring source layer filter_ip3
I0210 16:48:13.974166 16731 net.cpp:676] Ignoring source layer conv3
I0210 16:48:13.974172 16731 net.cpp:676] Ignoring source layer bn_conv3
I0210 16:48:13.974180 16731 net.cpp:676] Ignoring source layer scale_conv3
I0210 16:48:13.974187 16731 net.cpp:676] Ignoring source layer relu3
I0210 16:48:13.974193 16731 net.cpp:676] Ignoring source layer filter_ip4
I0210 16:48:13.974200 16731 net.cpp:676] Ignoring source layer conv4
I0210 16:48:13.974208 16731 net.cpp:676] Ignoring source layer bn_conv4
I0210 16:48:13.974216 16731 net.cpp:676] Ignoring source layer scale_conv4
I0210 16:48:13.974221 16731 net.cpp:676] Ignoring source layer relu4
I0210 16:48:13.974228 16731 net.cpp:676] Ignoring source layer filter_ip5
I0210 16:48:13.974236 16731 net.cpp:676] Ignoring source layer conv5
I0210 16:48:13.974243 16731 net.cpp:676] Ignoring source layer bn_conv5
I0210 16:48:13.974249 16731 net.cpp:676] Ignoring source layer scale_conv5
I0210 16:48:13.974256 16731 net.cpp:676] Ignoring source layer relu5
I0210 16:48:13.974264 16731 net.cpp:676] Ignoring source layer pool5
I0210 16:48:13.974272 16731 net.cpp:676] Ignoring source layer filter_ip6
I0210 16:48:13.974277 16731 net.cpp:676] Ignoring source layer feat0
I0210 16:48:13.974283 16731 net.cpp:676] Ignoring source layer bn_feat0
I0210 16:48:13.974292 16731 net.cpp:676] Ignoring source layer scale_feat0
I0210 16:48:13.974298 16731 net.cpp:676] Ignoring source layer relu_feat0
I0210 16:48:13.974305 16731 net.cpp:676] Ignoring source layer filter_ip7
I0210 16:48:13.974313 16731 net.cpp:676] Ignoring source layer feat1
I0210 16:48:13.974320 16731 net.cpp:676] Ignoring source layer eucli_loss
W0210 16:48:14.222379 16731 _caffe.cpp:139] DEPRECATION WARNING - deprecated use of Python interface
W0210 16:48:14.222453 16731 _caffe.cpp:140] Use this instead (with the named "weights" parameter):
W0210 16:48:14.222467 16731 _caffe.cpp:142] Net('./alexnet-deploy-ignet-embed.prototxt', 1, weights='./snapshot/1/alex-ignet-embed_iter_5000.caffemodel')
I0210 16:48:14.222672 16731 upgrade_proto.cpp:67] Attempting to upgrade input file specified using deprecated input fields: ./alexnet-deploy-ignet-embed.prototxt
I0210 16:48:14.222683 16731 upgrade_proto.cpp:70] Successfully upgraded file specified using deprecated input fields.
W0210 16:48:14.222687 16731 upgrade_proto.cpp:72] Note that future Caffe releases will only support input layers and not input fields.
I0210 16:48:14.222873 16731 net.cpp:51] Initializing net from parameters: 
name: "AlexNet-ignet"
state {
  phase: TEST
  level: 0
}
layer {
  name: "input"
  type: "Input"
  top: "data"
  top: "extra"
  input_param {
    shape {
      dim: 1
      dim: 3
      dim: 224
      dim: 224
    }
    shape {
      dim: 1
      dim: 2
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding_fc1"
  type: "InnerProduct"
  bottom: "extra"
  top: "embedding_fc1"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 256
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "bn_embedding_fc1"
  type: "BatchNorm"
  bottom: "embedding_fc1"
  top: "embedding_fc1"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_embedding_fc1"
  type: "Scale"
  bottom: "embedding_fc1"
  top: "embedding_fc1"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu_embedding_fc1"
  type: "ReLU"
  bottom: "embedding_fc1"
  top: "embedding_fc1"
}
layer {
  name: "embedding_fc2"
  type: "InnerProduct"
  bottom: "embedding_fc1"
  top: "embedding_fc2"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 1
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  param {
    name: "conv1_w"
    lr_mult: 1
    decay_mult: 1
  }
  param {
    name: "conv1_b"
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
  }
}
layer {
  name: "bn_conv1"
  type: "BatchNorm"
  bottom: "conv1"
  top: "conv1"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_conv1"
  type: "Scale"
  bottom: "conv1"
  top: "conv1"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "filter_ip2"
  type: "InnerProduct"
  bottom: "embedding_fc2"
  top: "filter_ip2"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 307200
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "pool1"
  bottom: "filter_ip2"
  top: "conv2"
  param {
    name: "conv2_w"
    lr_mult: 1
    decay_mult: 1
  }
  param {
    name: "conv2_b"
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
    weight_operation: COPY
  }
}
layer {
  name: "bn_conv2"
  type: "BatchNorm"
  bottom: "conv2"
  top: "conv2"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_conv2"
  type: "Scale"
  bottom: "conv2"
  top: "conv2"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "filter_ip3"
  type: "InnerProduct"
  bottom: "embedding_fc2"
  top: "filter_ip3"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 884736
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "pool2"
  bottom: "filter_ip3"
  top: "conv3"
  param {
    name: "conv3_w"
    lr_mult: 1
    decay_mult: 1
  }
  param {
    name: "conv3_b"
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
    weight_operation: COPY
  }
}
layer {
  name: "bn_conv3"
  type: "BatchNorm"
  bottom: "conv3"
  top: "conv3"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_conv3"
  type: "Scale"
  bottom: "conv3"
  top: "conv3"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "filter_ip4"
  type: "InnerProduct"
  bottom: "embedding_fc2"
  top: "filter_ip4"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 663552
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  bottom: "filter_ip4"
  top: "conv4"
  param {
    name: "conv4_w"
    lr_mult: 1
    decay_mult: 1
  }
  param {
    name: "conv4_b"
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
    weight_operation: COPY
  }
}
layer {
  name: "bn_conv4"
  type: "BatchNorm"
  bottom: "conv4"
  top: "conv4"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_conv4"
  type: "Scale"
  bottom: "conv4"
  top: "conv4"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "filter_ip5"
  type: "InnerProduct"
  bottom: "embedding_fc2"
  top: "filter_ip5"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 442368
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  bottom: "filter_ip5"
  top: "conv5"
  param {
    name: "conv5_w"
    lr_mult: 1
    decay_mult: 1
  }
  param {
    name: "conv5_b"
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
    weight_operation: COPY
  }
}
layer {
  name: "bn_conv5"
  type: "BatchNorm"
  bottom: "conv5"
  top: "conv5"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_conv5"
  type: "Scale"
  bottom: "conv5"
  top: "conv5"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "filter_ip6"
  type: "InnerProduct"
  bottom: "embedding_fc2"
  top: "filter_ip6"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 4718592
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "feat0"
  type: "Convolution"
  bottom: "pool5"
  bottom: "filter_ip6"
  top: "feat0"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 512
    kernel_size: 6
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
    weight_operation: COPY
  }
}
layer {
  name: "bn_feat0"
  type: "BatchNorm"
  bottom: "feat0"
  top: "feat0"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_feat0"
  type: "Scale"
  bottom: "feat0"
  top: "feat0"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu_feat0"
  type: "ReLU"
  bottom: "feat0"
  top: "feat0"
}
layer {
  name: "filter_ip7"
  type: "InnerProduct"
  bottom: "embedding_fc2"
  top: "filter_ip7"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 512
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "feat1"
  type: "Convolution"
  bottom: "feat0"
  bottom: "filter_ip7"
  top: "feat1"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 1
    kernel_size: 1
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
    weight_operation: COPY
  }
}
I0210 16:48:14.222962 16731 layer_factory.hpp:77] Creating layer input
I0210 16:48:14.222970 16731 net.cpp:84] Creating Layer input
I0210 16:48:14.222972 16731 net.cpp:380] input -> data
I0210 16:48:14.222980 16731 net.cpp:380] input -> extra
I0210 16:48:14.223073 16731 net.cpp:122] Setting up input
I0210 16:48:14.223078 16731 net.cpp:129] Top shape: 1 3 224 224 (150528)
I0210 16:48:14.223080 16731 net.cpp:129] Top shape: 1 2 1 1 (2)
I0210 16:48:14.223083 16731 net.cpp:137] Memory required for data: 602120
I0210 16:48:14.223084 16731 layer_factory.hpp:77] Creating layer embedding_fc1
I0210 16:48:14.223088 16731 net.cpp:84] Creating Layer embedding_fc1
I0210 16:48:14.223090 16731 net.cpp:406] embedding_fc1 <- extra
I0210 16:48:14.223094 16731 net.cpp:380] embedding_fc1 -> embedding_fc1
I0210 16:48:14.223198 16731 net.cpp:122] Setting up embedding_fc1
I0210 16:48:14.223203 16731 net.cpp:129] Top shape: 1 256 (256)
I0210 16:48:14.223204 16731 net.cpp:137] Memory required for data: 603144
I0210 16:48:14.223210 16731 layer_factory.hpp:77] Creating layer bn_embedding_fc1
I0210 16:48:14.223214 16731 net.cpp:84] Creating Layer bn_embedding_fc1
I0210 16:48:14.223217 16731 net.cpp:406] bn_embedding_fc1 <- embedding_fc1
I0210 16:48:14.223219 16731 net.cpp:367] bn_embedding_fc1 -> embedding_fc1 (in-place)
I0210 16:48:14.223382 16731 net.cpp:122] Setting up bn_embedding_fc1
I0210 16:48:14.223387 16731 net.cpp:129] Top shape: 1 256 (256)
I0210 16:48:14.223388 16731 net.cpp:137] Memory required for data: 604168
I0210 16:48:14.223394 16731 layer_factory.hpp:77] Creating layer scale_embedding_fc1
I0210 16:48:14.223397 16731 net.cpp:84] Creating Layer scale_embedding_fc1
I0210 16:48:14.223399 16731 net.cpp:406] scale_embedding_fc1 <- embedding_fc1
I0210 16:48:14.223402 16731 net.cpp:367] scale_embedding_fc1 -> embedding_fc1 (in-place)
I0210 16:48:14.223433 16731 layer_factory.hpp:77] Creating layer scale_embedding_fc1
I0210 16:48:14.223525 16731 net.cpp:122] Setting up scale_embedding_fc1
I0210 16:48:14.223527 16731 net.cpp:129] Top shape: 1 256 (256)
I0210 16:48:14.223529 16731 net.cpp:137] Memory required for data: 605192
I0210 16:48:14.223532 16731 layer_factory.hpp:77] Creating layer relu_embedding_fc1
I0210 16:48:14.223536 16731 net.cpp:84] Creating Layer relu_embedding_fc1
I0210 16:48:14.223538 16731 net.cpp:406] relu_embedding_fc1 <- embedding_fc1
I0210 16:48:14.223549 16731 net.cpp:367] relu_embedding_fc1 -> embedding_fc1 (in-place)
I0210 16:48:14.223940 16731 net.cpp:122] Setting up relu_embedding_fc1
I0210 16:48:14.223945 16731 net.cpp:129] Top shape: 1 256 (256)
I0210 16:48:14.223948 16731 net.cpp:137] Memory required for data: 606216
I0210 16:48:14.223950 16731 layer_factory.hpp:77] Creating layer embedding_fc2
I0210 16:48:14.223953 16731 net.cpp:84] Creating Layer embedding_fc2
I0210 16:48:14.223955 16731 net.cpp:406] embedding_fc2 <- embedding_fc1
I0210 16:48:14.223958 16731 net.cpp:380] embedding_fc2 -> embedding_fc2
I0210 16:48:14.224052 16731 net.cpp:122] Setting up embedding_fc2
I0210 16:48:14.224056 16731 net.cpp:129] Top shape: 1 1 (1)
I0210 16:48:14.224057 16731 net.cpp:137] Memory required for data: 606220
I0210 16:48:14.224062 16731 layer_factory.hpp:77] Creating layer embedding_fc2_embedding_fc2_0_split
I0210 16:48:14.224066 16731 net.cpp:84] Creating Layer embedding_fc2_embedding_fc2_0_split
I0210 16:48:14.224068 16731 net.cpp:406] embedding_fc2_embedding_fc2_0_split <- embedding_fc2
I0210 16:48:14.224071 16731 net.cpp:380] embedding_fc2_embedding_fc2_0_split -> embedding_fc2_embedding_fc2_0_split_0
I0210 16:48:14.224076 16731 net.cpp:380] embedding_fc2_embedding_fc2_0_split -> embedding_fc2_embedding_fc2_0_split_1
I0210 16:48:14.224079 16731 net.cpp:380] embedding_fc2_embedding_fc2_0_split -> embedding_fc2_embedding_fc2_0_split_2
I0210 16:48:14.224083 16731 net.cpp:380] embedding_fc2_embedding_fc2_0_split -> embedding_fc2_embedding_fc2_0_split_3
I0210 16:48:14.224086 16731 net.cpp:380] embedding_fc2_embedding_fc2_0_split -> embedding_fc2_embedding_fc2_0_split_4
I0210 16:48:14.224090 16731 net.cpp:380] embedding_fc2_embedding_fc2_0_split -> embedding_fc2_embedding_fc2_0_split_5
I0210 16:48:14.224164 16731 net.cpp:122] Setting up embedding_fc2_embedding_fc2_0_split
I0210 16:48:14.224166 16731 net.cpp:129] Top shape: 1 1 (1)
I0210 16:48:14.224169 16731 net.cpp:129] Top shape: 1 1 (1)
I0210 16:48:14.224170 16731 net.cpp:129] Top shape: 1 1 (1)
I0210 16:48:14.224174 16731 net.cpp:129] Top shape: 1 1 (1)
I0210 16:48:14.224175 16731 net.cpp:129] Top shape: 1 1 (1)
I0210 16:48:14.224177 16731 net.cpp:129] Top shape: 1 1 (1)
I0210 16:48:14.224179 16731 net.cpp:137] Memory required for data: 606244
I0210 16:48:14.224180 16731 layer_factory.hpp:77] Creating layer conv1
I0210 16:48:14.224186 16731 net.cpp:84] Creating Layer conv1
I0210 16:48:14.224189 16731 net.cpp:406] conv1 <- data
I0210 16:48:14.224191 16731 net.cpp:380] conv1 -> conv1
I0210 16:48:14.224642 16731 net.cpp:122] Setting up conv1
I0210 16:48:14.224647 16731 net.cpp:129] Top shape: 1 96 54 54 (279936)
I0210 16:48:14.224649 16731 net.cpp:137] Memory required for data: 1725988
I0210 16:48:14.224653 16731 layer_factory.hpp:77] Creating layer bn_conv1
I0210 16:48:14.224656 16731 net.cpp:84] Creating Layer bn_conv1
I0210 16:48:14.224658 16731 net.cpp:406] bn_conv1 <- conv1
I0210 16:48:14.224661 16731 net.cpp:367] bn_conv1 -> conv1 (in-place)
I0210 16:48:14.224834 16731 net.cpp:122] Setting up bn_conv1
I0210 16:48:14.224838 16731 net.cpp:129] Top shape: 1 96 54 54 (279936)
I0210 16:48:14.224840 16731 net.cpp:137] Memory required for data: 2845732
I0210 16:48:14.224844 16731 layer_factory.hpp:77] Creating layer scale_conv1
I0210 16:48:14.224848 16731 net.cpp:84] Creating Layer scale_conv1
I0210 16:48:14.224849 16731 net.cpp:406] scale_conv1 <- conv1
I0210 16:48:14.224853 16731 net.cpp:367] scale_conv1 -> conv1 (in-place)
I0210 16:48:14.224884 16731 layer_factory.hpp:77] Creating layer scale_conv1
I0210 16:48:14.224984 16731 net.cpp:122] Setting up scale_conv1
I0210 16:48:14.224988 16731 net.cpp:129] Top shape: 1 96 54 54 (279936)
I0210 16:48:14.224990 16731 net.cpp:137] Memory required for data: 3965476
I0210 16:48:14.224993 16731 layer_factory.hpp:77] Creating layer relu1
I0210 16:48:14.224997 16731 net.cpp:84] Creating Layer relu1
I0210 16:48:14.224999 16731 net.cpp:406] relu1 <- conv1
I0210 16:48:14.225001 16731 net.cpp:367] relu1 -> conv1 (in-place)
I0210 16:48:14.225319 16731 net.cpp:122] Setting up relu1
I0210 16:48:14.225324 16731 net.cpp:129] Top shape: 1 96 54 54 (279936)
I0210 16:48:14.225327 16731 net.cpp:137] Memory required for data: 5085220
I0210 16:48:14.225328 16731 layer_factory.hpp:77] Creating layer pool1
I0210 16:48:14.225332 16731 net.cpp:84] Creating Layer pool1
I0210 16:48:14.225334 16731 net.cpp:406] pool1 <- conv1
I0210 16:48:14.225337 16731 net.cpp:380] pool1 -> pool1
I0210 16:48:14.225373 16731 net.cpp:122] Setting up pool1
I0210 16:48:14.225378 16731 net.cpp:129] Top shape: 1 96 27 27 (69984)
I0210 16:48:14.225379 16731 net.cpp:137] Memory required for data: 5365156
I0210 16:48:14.225381 16731 layer_factory.hpp:77] Creating layer filter_ip2
I0210 16:48:14.225384 16731 net.cpp:84] Creating Layer filter_ip2
I0210 16:48:14.225386 16731 net.cpp:406] filter_ip2 <- embedding_fc2_embedding_fc2_0_split_0
I0210 16:48:14.225389 16731 net.cpp:380] filter_ip2 -> filter_ip2
I0210 16:48:14.228530 16731 net.cpp:122] Setting up filter_ip2
I0210 16:48:14.228540 16731 net.cpp:129] Top shape: 1 307200 (307200)
I0210 16:48:14.228543 16731 net.cpp:137] Memory required for data: 6593956
I0210 16:48:14.228550 16731 layer_factory.hpp:77] Creating layer conv2
I0210 16:48:14.228557 16731 net.cpp:84] Creating Layer conv2
I0210 16:48:14.228560 16731 net.cpp:406] conv2 <- pool1
I0210 16:48:14.228564 16731 net.cpp:406] conv2 <- filter_ip2
I0210 16:48:14.228566 16731 net.cpp:380] conv2 -> conv2
I0210 16:48:14.231150 16731 net.cpp:122] Setting up conv2
I0210 16:48:14.231158 16731 net.cpp:129] Top shape: 1 256 27 27 (186624)
I0210 16:48:14.231160 16731 net.cpp:137] Memory required for data: 7340452
I0210 16:48:14.231164 16731 layer_factory.hpp:77] Creating layer bn_conv2
I0210 16:48:14.231170 16731 net.cpp:84] Creating Layer bn_conv2
I0210 16:48:14.231173 16731 net.cpp:406] bn_conv2 <- conv2
I0210 16:48:14.231175 16731 net.cpp:367] bn_conv2 -> conv2 (in-place)
I0210 16:48:14.231350 16731 net.cpp:122] Setting up bn_conv2
I0210 16:48:14.231354 16731 net.cpp:129] Top shape: 1 256 27 27 (186624)
I0210 16:48:14.231356 16731 net.cpp:137] Memory required for data: 8086948
I0210 16:48:14.231360 16731 layer_factory.hpp:77] Creating layer scale_conv2
I0210 16:48:14.231365 16731 net.cpp:84] Creating Layer scale_conv2
I0210 16:48:14.231367 16731 net.cpp:406] scale_conv2 <- conv2
I0210 16:48:14.231369 16731 net.cpp:367] scale_conv2 -> conv2 (in-place)
I0210 16:48:14.231403 16731 layer_factory.hpp:77] Creating layer scale_conv2
I0210 16:48:14.231503 16731 net.cpp:122] Setting up scale_conv2
I0210 16:48:14.231506 16731 net.cpp:129] Top shape: 1 256 27 27 (186624)
I0210 16:48:14.231508 16731 net.cpp:137] Memory required for data: 8833444
I0210 16:48:14.231511 16731 layer_factory.hpp:77] Creating layer relu2
I0210 16:48:14.231516 16731 net.cpp:84] Creating Layer relu2
I0210 16:48:14.231518 16731 net.cpp:406] relu2 <- conv2
I0210 16:48:14.231521 16731 net.cpp:367] relu2 -> conv2 (in-place)
I0210 16:48:14.232054 16731 net.cpp:122] Setting up relu2
I0210 16:48:14.232060 16731 net.cpp:129] Top shape: 1 256 27 27 (186624)
I0210 16:48:14.232064 16731 net.cpp:137] Memory required for data: 9579940
I0210 16:48:14.232065 16731 layer_factory.hpp:77] Creating layer pool2
I0210 16:48:14.232069 16731 net.cpp:84] Creating Layer pool2
I0210 16:48:14.232071 16731 net.cpp:406] pool2 <- conv2
I0210 16:48:14.232075 16731 net.cpp:380] pool2 -> pool2
I0210 16:48:14.232113 16731 net.cpp:122] Setting up pool2
I0210 16:48:14.232116 16731 net.cpp:129] Top shape: 1 256 13 13 (43264)
I0210 16:48:14.232118 16731 net.cpp:137] Memory required for data: 9752996
I0210 16:48:14.232120 16731 layer_factory.hpp:77] Creating layer filter_ip3
I0210 16:48:14.232125 16731 net.cpp:84] Creating Layer filter_ip3
I0210 16:48:14.232126 16731 net.cpp:406] filter_ip3 <- embedding_fc2_embedding_fc2_0_split_1
I0210 16:48:14.232129 16731 net.cpp:380] filter_ip3 -> filter_ip3
I0210 16:48:14.239461 16731 net.cpp:122] Setting up filter_ip3
I0210 16:48:14.239475 16731 net.cpp:129] Top shape: 1 884736 (884736)
I0210 16:48:14.239476 16731 net.cpp:137] Memory required for data: 13291940
I0210 16:48:14.239502 16731 layer_factory.hpp:77] Creating layer conv3
I0210 16:48:14.239512 16731 net.cpp:84] Creating Layer conv3
I0210 16:48:14.239516 16731 net.cpp:406] conv3 <- pool2
I0210 16:48:14.239518 16731 net.cpp:406] conv3 <- filter_ip3
I0210 16:48:14.239522 16731 net.cpp:380] conv3 -> conv3
I0210 16:48:14.245904 16731 net.cpp:122] Setting up conv3
I0210 16:48:14.245916 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 16:48:14.245918 16731 net.cpp:137] Memory required for data: 13551524
I0210 16:48:14.245923 16731 layer_factory.hpp:77] Creating layer bn_conv3
I0210 16:48:14.245929 16731 net.cpp:84] Creating Layer bn_conv3
I0210 16:48:14.245932 16731 net.cpp:406] bn_conv3 <- conv3
I0210 16:48:14.245935 16731 net.cpp:367] bn_conv3 -> conv3 (in-place)
I0210 16:48:14.246148 16731 net.cpp:122] Setting up bn_conv3
I0210 16:48:14.246153 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 16:48:14.246155 16731 net.cpp:137] Memory required for data: 13811108
I0210 16:48:14.246160 16731 layer_factory.hpp:77] Creating layer scale_conv3
I0210 16:48:14.246163 16731 net.cpp:84] Creating Layer scale_conv3
I0210 16:48:14.246166 16731 net.cpp:406] scale_conv3 <- conv3
I0210 16:48:14.246168 16731 net.cpp:367] scale_conv3 -> conv3 (in-place)
I0210 16:48:14.246199 16731 layer_factory.hpp:77] Creating layer scale_conv3
I0210 16:48:14.246300 16731 net.cpp:122] Setting up scale_conv3
I0210 16:48:14.246304 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 16:48:14.246306 16731 net.cpp:137] Memory required for data: 14070692
I0210 16:48:14.246312 16731 layer_factory.hpp:77] Creating layer relu3
I0210 16:48:14.246316 16731 net.cpp:84] Creating Layer relu3
I0210 16:48:14.246318 16731 net.cpp:406] relu3 <- conv3
I0210 16:48:14.246321 16731 net.cpp:367] relu3 -> conv3 (in-place)
I0210 16:48:14.246644 16731 net.cpp:122] Setting up relu3
I0210 16:48:14.246649 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 16:48:14.246651 16731 net.cpp:137] Memory required for data: 14330276
I0210 16:48:14.246654 16731 layer_factory.hpp:77] Creating layer filter_ip4
I0210 16:48:14.246657 16731 net.cpp:84] Creating Layer filter_ip4
I0210 16:48:14.246660 16731 net.cpp:406] filter_ip4 <- embedding_fc2_embedding_fc2_0_split_2
I0210 16:48:14.246665 16731 net.cpp:380] filter_ip4 -> filter_ip4
I0210 16:48:14.252261 16731 net.cpp:122] Setting up filter_ip4
I0210 16:48:14.252271 16731 net.cpp:129] Top shape: 1 663552 (663552)
I0210 16:48:14.252274 16731 net.cpp:137] Memory required for data: 16984484
I0210 16:48:14.252279 16731 layer_factory.hpp:77] Creating layer conv4
I0210 16:48:14.252286 16731 net.cpp:84] Creating Layer conv4
I0210 16:48:14.252290 16731 net.cpp:406] conv4 <- conv3
I0210 16:48:14.252292 16731 net.cpp:406] conv4 <- filter_ip4
I0210 16:48:14.252296 16731 net.cpp:380] conv4 -> conv4
I0210 16:48:14.257091 16731 net.cpp:122] Setting up conv4
I0210 16:48:14.257099 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 16:48:14.257102 16731 net.cpp:137] Memory required for data: 17244068
I0210 16:48:14.257107 16731 layer_factory.hpp:77] Creating layer bn_conv4
I0210 16:48:14.257112 16731 net.cpp:84] Creating Layer bn_conv4
I0210 16:48:14.257113 16731 net.cpp:406] bn_conv4 <- conv4
I0210 16:48:14.257117 16731 net.cpp:367] bn_conv4 -> conv4 (in-place)
I0210 16:48:14.257295 16731 net.cpp:122] Setting up bn_conv4
I0210 16:48:14.257299 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 16:48:14.257300 16731 net.cpp:137] Memory required for data: 17503652
I0210 16:48:14.257305 16731 layer_factory.hpp:77] Creating layer scale_conv4
I0210 16:48:14.257309 16731 net.cpp:84] Creating Layer scale_conv4
I0210 16:48:14.257311 16731 net.cpp:406] scale_conv4 <- conv4
I0210 16:48:14.257314 16731 net.cpp:367] scale_conv4 -> conv4 (in-place)
I0210 16:48:14.257344 16731 layer_factory.hpp:77] Creating layer scale_conv4
I0210 16:48:14.257444 16731 net.cpp:122] Setting up scale_conv4
I0210 16:48:14.257448 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 16:48:14.257450 16731 net.cpp:137] Memory required for data: 17763236
I0210 16:48:14.257473 16731 layer_factory.hpp:77] Creating layer relu4
I0210 16:48:14.257477 16731 net.cpp:84] Creating Layer relu4
I0210 16:48:14.257479 16731 net.cpp:406] relu4 <- conv4
I0210 16:48:14.257483 16731 net.cpp:367] relu4 -> conv4 (in-place)
I0210 16:48:14.257810 16731 net.cpp:122] Setting up relu4
I0210 16:48:14.257815 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 16:48:14.257817 16731 net.cpp:137] Memory required for data: 18022820
I0210 16:48:14.257819 16731 layer_factory.hpp:77] Creating layer filter_ip5
I0210 16:48:14.257823 16731 net.cpp:84] Creating Layer filter_ip5
I0210 16:48:14.257827 16731 net.cpp:406] filter_ip5 <- embedding_fc2_embedding_fc2_0_split_3
I0210 16:48:14.257830 16731 net.cpp:380] filter_ip5 -> filter_ip5
I0210 16:48:14.261744 16731 net.cpp:122] Setting up filter_ip5
I0210 16:48:14.261754 16731 net.cpp:129] Top shape: 1 442368 (442368)
I0210 16:48:14.261755 16731 net.cpp:137] Memory required for data: 19792292
I0210 16:48:14.261760 16731 layer_factory.hpp:77] Creating layer conv5
I0210 16:48:14.261767 16731 net.cpp:84] Creating Layer conv5
I0210 16:48:14.261770 16731 net.cpp:406] conv5 <- conv4
I0210 16:48:14.261773 16731 net.cpp:406] conv5 <- filter_ip5
I0210 16:48:14.261776 16731 net.cpp:380] conv5 -> conv5
I0210 16:48:14.265142 16731 net.cpp:122] Setting up conv5
I0210 16:48:14.265149 16731 net.cpp:129] Top shape: 1 256 13 13 (43264)
I0210 16:48:14.265152 16731 net.cpp:137] Memory required for data: 19965348
I0210 16:48:14.265156 16731 layer_factory.hpp:77] Creating layer bn_conv5
I0210 16:48:14.265161 16731 net.cpp:84] Creating Layer bn_conv5
I0210 16:48:14.265162 16731 net.cpp:406] bn_conv5 <- conv5
I0210 16:48:14.265166 16731 net.cpp:367] bn_conv5 -> conv5 (in-place)
I0210 16:48:14.265343 16731 net.cpp:122] Setting up bn_conv5
I0210 16:48:14.265347 16731 net.cpp:129] Top shape: 1 256 13 13 (43264)
I0210 16:48:14.265348 16731 net.cpp:137] Memory required for data: 20138404
I0210 16:48:14.265353 16731 layer_factory.hpp:77] Creating layer scale_conv5
I0210 16:48:14.265357 16731 net.cpp:84] Creating Layer scale_conv5
I0210 16:48:14.265359 16731 net.cpp:406] scale_conv5 <- conv5
I0210 16:48:14.265362 16731 net.cpp:367] scale_conv5 -> conv5 (in-place)
I0210 16:48:14.265394 16731 layer_factory.hpp:77] Creating layer scale_conv5
I0210 16:48:14.265492 16731 net.cpp:122] Setting up scale_conv5
I0210 16:48:14.265496 16731 net.cpp:129] Top shape: 1 256 13 13 (43264)
I0210 16:48:14.265497 16731 net.cpp:137] Memory required for data: 20311460
I0210 16:48:14.265501 16731 layer_factory.hpp:77] Creating layer relu5
I0210 16:48:14.265506 16731 net.cpp:84] Creating Layer relu5
I0210 16:48:14.265508 16731 net.cpp:406] relu5 <- conv5
I0210 16:48:14.265511 16731 net.cpp:367] relu5 -> conv5 (in-place)
I0210 16:48:14.265980 16731 net.cpp:122] Setting up relu5
I0210 16:48:14.265986 16731 net.cpp:129] Top shape: 1 256 13 13 (43264)
I0210 16:48:14.265988 16731 net.cpp:137] Memory required for data: 20484516
I0210 16:48:14.265990 16731 layer_factory.hpp:77] Creating layer pool5
I0210 16:48:14.265995 16731 net.cpp:84] Creating Layer pool5
I0210 16:48:14.265997 16731 net.cpp:406] pool5 <- conv5
I0210 16:48:14.266006 16731 net.cpp:380] pool5 -> pool5
I0210 16:48:14.266046 16731 net.cpp:122] Setting up pool5
I0210 16:48:14.266049 16731 net.cpp:129] Top shape: 1 256 6 6 (9216)
I0210 16:48:14.266052 16731 net.cpp:137] Memory required for data: 20521380
I0210 16:48:14.266053 16731 layer_factory.hpp:77] Creating layer filter_ip6
I0210 16:48:14.266057 16731 net.cpp:84] Creating Layer filter_ip6
I0210 16:48:14.266060 16731 net.cpp:406] filter_ip6 <- embedding_fc2_embedding_fc2_0_split_4
I0210 16:48:14.266063 16731 net.cpp:380] filter_ip6 -> filter_ip6
I0210 16:48:14.303297 16731 net.cpp:122] Setting up filter_ip6
I0210 16:48:14.303316 16731 net.cpp:129] Top shape: 1 4718592 (4718592)
I0210 16:48:14.303319 16731 net.cpp:137] Memory required for data: 39395748
I0210 16:48:14.303325 16731 layer_factory.hpp:77] Creating layer feat0
I0210 16:48:14.303335 16731 net.cpp:84] Creating Layer feat0
I0210 16:48:14.303362 16731 net.cpp:406] feat0 <- pool5
I0210 16:48:14.303367 16731 net.cpp:406] feat0 <- filter_ip6
I0210 16:48:14.303371 16731 net.cpp:380] feat0 -> feat0
I0210 16:48:14.335315 16731 net.cpp:122] Setting up feat0
I0210 16:48:14.335330 16731 net.cpp:129] Top shape: 1 512 1 1 (512)
I0210 16:48:14.335331 16731 net.cpp:137] Memory required for data: 39397796
I0210 16:48:14.335337 16731 layer_factory.hpp:77] Creating layer bn_feat0
I0210 16:48:14.335345 16731 net.cpp:84] Creating Layer bn_feat0
I0210 16:48:14.335347 16731 net.cpp:406] bn_feat0 <- feat0
I0210 16:48:14.335351 16731 net.cpp:367] bn_feat0 -> feat0 (in-place)
I0210 16:48:14.335537 16731 net.cpp:122] Setting up bn_feat0
I0210 16:48:14.335541 16731 net.cpp:129] Top shape: 1 512 1 1 (512)
I0210 16:48:14.335542 16731 net.cpp:137] Memory required for data: 39399844
I0210 16:48:14.335547 16731 layer_factory.hpp:77] Creating layer scale_feat0
I0210 16:48:14.335551 16731 net.cpp:84] Creating Layer scale_feat0
I0210 16:48:14.335553 16731 net.cpp:406] scale_feat0 <- feat0
I0210 16:48:14.335556 16731 net.cpp:367] scale_feat0 -> feat0 (in-place)
I0210 16:48:14.335588 16731 layer_factory.hpp:77] Creating layer scale_feat0
I0210 16:48:14.335690 16731 net.cpp:122] Setting up scale_feat0
I0210 16:48:14.335695 16731 net.cpp:129] Top shape: 1 512 1 1 (512)
I0210 16:48:14.335695 16731 net.cpp:137] Memory required for data: 39401892
I0210 16:48:14.335700 16731 layer_factory.hpp:77] Creating layer relu_feat0
I0210 16:48:14.335703 16731 net.cpp:84] Creating Layer relu_feat0
I0210 16:48:14.335705 16731 net.cpp:406] relu_feat0 <- feat0
I0210 16:48:14.335707 16731 net.cpp:367] relu_feat0 -> feat0 (in-place)
I0210 16:48:14.336066 16731 net.cpp:122] Setting up relu_feat0
I0210 16:48:14.336071 16731 net.cpp:129] Top shape: 1 512 1 1 (512)
I0210 16:48:14.336072 16731 net.cpp:137] Memory required for data: 39403940
I0210 16:48:14.336074 16731 layer_factory.hpp:77] Creating layer filter_ip7
I0210 16:48:14.336079 16731 net.cpp:84] Creating Layer filter_ip7
I0210 16:48:14.336081 16731 net.cpp:406] filter_ip7 <- embedding_fc2_embedding_fc2_0_split_5
I0210 16:48:14.336086 16731 net.cpp:380] filter_ip7 -> filter_ip7
I0210 16:48:14.336190 16731 net.cpp:122] Setting up filter_ip7
I0210 16:48:14.336194 16731 net.cpp:129] Top shape: 1 512 (512)
I0210 16:48:14.336196 16731 net.cpp:137] Memory required for data: 39405988
I0210 16:48:14.336199 16731 layer_factory.hpp:77] Creating layer feat1
I0210 16:48:14.336205 16731 net.cpp:84] Creating Layer feat1
I0210 16:48:14.336207 16731 net.cpp:406] feat1 <- feat0
I0210 16:48:14.336210 16731 net.cpp:406] feat1 <- filter_ip7
I0210 16:48:14.336213 16731 net.cpp:380] feat1 -> feat1
I0210 16:48:14.336450 16731 net.cpp:122] Setting up feat1
I0210 16:48:14.336454 16731 net.cpp:129] Top shape: 1 1 1 1 (1)
I0210 16:48:14.336455 16731 net.cpp:137] Memory required for data: 39405992
I0210 16:48:14.336463 16731 net.cpp:200] feat1 does not need backward computation.
I0210 16:48:14.336467 16731 net.cpp:200] filter_ip7 does not need backward computation.
I0210 16:48:14.336468 16731 net.cpp:200] relu_feat0 does not need backward computation.
I0210 16:48:14.336470 16731 net.cpp:200] scale_feat0 does not need backward computation.
I0210 16:48:14.336472 16731 net.cpp:200] bn_feat0 does not need backward computation.
I0210 16:48:14.336473 16731 net.cpp:200] feat0 does not need backward computation.
I0210 16:48:14.336477 16731 net.cpp:200] filter_ip6 does not need backward computation.
I0210 16:48:14.336478 16731 net.cpp:200] pool5 does not need backward computation.
I0210 16:48:14.336480 16731 net.cpp:200] relu5 does not need backward computation.
I0210 16:48:14.336483 16731 net.cpp:200] scale_conv5 does not need backward computation.
I0210 16:48:14.336484 16731 net.cpp:200] bn_conv5 does not need backward computation.
I0210 16:48:14.336486 16731 net.cpp:200] conv5 does not need backward computation.
I0210 16:48:14.336488 16731 net.cpp:200] filter_ip5 does not need backward computation.
I0210 16:48:14.336490 16731 net.cpp:200] relu4 does not need backward computation.
I0210 16:48:14.336508 16731 net.cpp:200] scale_conv4 does not need backward computation.
I0210 16:48:14.336509 16731 net.cpp:200] bn_conv4 does not need backward computation.
I0210 16:48:14.336511 16731 net.cpp:200] conv4 does not need backward computation.
I0210 16:48:14.336513 16731 net.cpp:200] filter_ip4 does not need backward computation.
I0210 16:48:14.336516 16731 net.cpp:200] relu3 does not need backward computation.
I0210 16:48:14.336519 16731 net.cpp:200] scale_conv3 does not need backward computation.
I0210 16:48:14.336520 16731 net.cpp:200] bn_conv3 does not need backward computation.
I0210 16:48:14.336521 16731 net.cpp:200] conv3 does not need backward computation.
I0210 16:48:14.336524 16731 net.cpp:200] filter_ip3 does not need backward computation.
I0210 16:48:14.336526 16731 net.cpp:200] pool2 does not need backward computation.
I0210 16:48:14.336529 16731 net.cpp:200] relu2 does not need backward computation.
I0210 16:48:14.336530 16731 net.cpp:200] scale_conv2 does not need backward computation.
I0210 16:48:14.336532 16731 net.cpp:200] bn_conv2 does not need backward computation.
I0210 16:48:14.336534 16731 net.cpp:200] conv2 does not need backward computation.
I0210 16:48:14.336536 16731 net.cpp:200] filter_ip2 does not need backward computation.
I0210 16:48:14.336539 16731 net.cpp:200] pool1 does not need backward computation.
I0210 16:48:14.336540 16731 net.cpp:200] relu1 does not need backward computation.
I0210 16:48:14.336542 16731 net.cpp:200] scale_conv1 does not need backward computation.
I0210 16:48:14.336544 16731 net.cpp:200] bn_conv1 does not need backward computation.
I0210 16:48:14.336545 16731 net.cpp:200] conv1 does not need backward computation.
I0210 16:48:14.336549 16731 net.cpp:200] embedding_fc2_embedding_fc2_0_split does not need backward computation.
I0210 16:48:14.336550 16731 net.cpp:200] embedding_fc2 does not need backward computation.
I0210 16:48:14.336552 16731 net.cpp:200] relu_embedding_fc1 does not need backward computation.
I0210 16:48:14.336555 16731 net.cpp:200] scale_embedding_fc1 does not need backward computation.
I0210 16:48:14.336556 16731 net.cpp:200] bn_embedding_fc1 does not need backward computation.
I0210 16:48:14.336558 16731 net.cpp:200] embedding_fc1 does not need backward computation.
I0210 16:48:14.336560 16731 net.cpp:200] input does not need backward computation.
I0210 16:48:14.336562 16731 net.cpp:242] This network produces output feat1
I0210 16:48:14.336576 16731 net.cpp:255] Network initialization done.
I0210 16:48:14.373963 16731 upgrade_proto.cpp:77] Attempting to upgrade batch norm layers using deprecated params: ./snapshot/1/alex-ignet-embed_iter_5000.caffemodel
I0210 16:48:14.373980 16731 upgrade_proto.cpp:80] Successfully upgraded batch norm layers using deprecated params.
I0210 16:48:14.373983 16731 net.cpp:744] Ignoring source layer data
I0210 16:48:14.436502 16731 net.cpp:744] Ignoring source layer eucli_loss
I0210 16:48:30.571585 16731 solver.cpp:397]     Test net output #0: accuracy = 0.847637
I0210 16:48:30.571699 16731 solver.cpp:397]     Test net output #1: mae = 0.320842
I0210 16:48:30.571707 16731 solver.cpp:397]     Test net output #2: rmse = 0.420831
I0210 16:48:30.712931 16731 solver.cpp:218] Iteration 5000 (3.16781 iter/s, 31.5676s/100 iters), loss = 0.0583695
I0210 16:48:30.712966 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0583695 (* 1 = 0.0583695 loss)
I0210 16:48:30.712972 16731 sgd_solver.cpp:114] Iteration 5000, lr = 0.00833333
I0210 16:48:44.874455 16731 solver.cpp:218] Iteration 5100 (7.06165 iter/s, 14.161s/100 iters), loss = 0.0706825
I0210 16:48:44.874485 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0706826 (* 1 = 0.0706826 loss)
I0210 16:48:44.874491 16731 sgd_solver.cpp:114] Iteration 5100, lr = 0.00827778
I0210 16:48:59.026566 16731 solver.cpp:218] Iteration 5200 (7.0664 iter/s, 14.1515s/100 iters), loss = 0.0326857
I0210 16:48:59.026610 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0326858 (* 1 = 0.0326858 loss)
I0210 16:48:59.026618 16731 sgd_solver.cpp:114] Iteration 5200, lr = 0.00822222
I0210 16:49:13.199548 16731 solver.cpp:218] Iteration 5300 (7.05595 iter/s, 14.1724s/100 iters), loss = 0.0470457
I0210 16:49:13.199705 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0470457 (* 1 = 0.0470457 loss)
I0210 16:49:13.199714 16731 sgd_solver.cpp:114] Iteration 5300, lr = 0.00816667
I0210 16:49:27.433565 16731 solver.cpp:218] Iteration 5400 (7.02575 iter/s, 14.2334s/100 iters), loss = 0.0305092
I0210 16:49:27.433655 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0305092 (* 1 = 0.0305092 loss)
I0210 16:49:27.433663 16731 sgd_solver.cpp:114] Iteration 5400, lr = 0.00811111
I0210 16:49:41.709887 16731 solver.cpp:218] Iteration 5500 (7.00489 iter/s, 14.2757s/100 iters), loss = 0.0452528
I0210 16:49:41.709916 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0452528 (* 1 = 0.0452528 loss)
I0210 16:49:41.709923 16731 sgd_solver.cpp:114] Iteration 5500, lr = 0.00805556
I0210 16:49:56.016340 16731 solver.cpp:218] Iteration 5600 (6.99017 iter/s, 14.3058s/100 iters), loss = 0.0711385
I0210 16:49:56.016557 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0711385 (* 1 = 0.0711385 loss)
I0210 16:49:56.016567 16731 sgd_solver.cpp:114] Iteration 5600, lr = 0.008
I0210 16:50:10.293367 16731 solver.cpp:218] Iteration 5700 (7.0046 iter/s, 14.2763s/100 iters), loss = 0.0355781
I0210 16:50:10.293406 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0355782 (* 1 = 0.0355782 loss)
I0210 16:50:10.293413 16731 sgd_solver.cpp:114] Iteration 5700, lr = 0.00794444
I0210 16:50:24.564924 16731 solver.cpp:218] Iteration 5800 (7.00727 iter/s, 14.2709s/100 iters), loss = 0.0728189
I0210 16:50:24.564973 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0728189 (* 1 = 0.0728189 loss)
I0210 16:50:24.564981 16731 sgd_solver.cpp:114] Iteration 5800, lr = 0.00788889
I0210 16:50:38.859879 16731 solver.cpp:218] Iteration 5900 (6.99574 iter/s, 14.2944s/100 iters), loss = 0.0483513
I0210 16:50:38.859999 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0483514 (* 1 = 0.0483514 loss)
I0210 16:50:38.860008 16731 sgd_solver.cpp:114] Iteration 5900, lr = 0.00783333
I0210 16:50:53.160697 16731 solver.cpp:218] Iteration 6000 (6.99291 iter/s, 14.3002s/100 iters), loss = 0.038478
I0210 16:50:53.160740 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0384781 (* 1 = 0.0384781 loss)
I0210 16:50:53.160748 16731 sgd_solver.cpp:114] Iteration 6000, lr = 0.00777778
I0210 16:51:07.414216 16731 solver.cpp:218] Iteration 6100 (7.01608 iter/s, 14.253s/100 iters), loss = 0.0645307
I0210 16:51:07.414263 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0645308 (* 1 = 0.0645308 loss)
I0210 16:51:07.414271 16731 sgd_solver.cpp:114] Iteration 6100, lr = 0.00772222
I0210 16:51:21.687767 16731 solver.cpp:218] Iteration 6200 (7.00623 iter/s, 14.273s/100 iters), loss = 0.0267287
I0210 16:51:21.687873 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0267288 (* 1 = 0.0267288 loss)
I0210 16:51:21.687881 16731 sgd_solver.cpp:114] Iteration 6200, lr = 0.00766667
I0210 16:51:36.007045 16731 solver.cpp:218] Iteration 6300 (6.98388 iter/s, 14.3187s/100 iters), loss = 0.0221006
I0210 16:51:36.007073 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0221007 (* 1 = 0.0221007 loss)
I0210 16:51:36.007081 16731 sgd_solver.cpp:114] Iteration 6300, lr = 0.00761111
I0210 16:51:50.343550 16731 solver.cpp:218] Iteration 6400 (6.97546 iter/s, 14.336s/100 iters), loss = 0.0488548
I0210 16:51:50.343596 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0488549 (* 1 = 0.0488549 loss)
I0210 16:51:50.343603 16731 sgd_solver.cpp:114] Iteration 6400, lr = 0.00755556
I0210 16:52:04.642894 16731 solver.cpp:218] Iteration 6500 (6.99359 iter/s, 14.2988s/100 iters), loss = 0.0567908
I0210 16:52:04.643021 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0567909 (* 1 = 0.0567909 loss)
I0210 16:52:04.643030 16731 sgd_solver.cpp:114] Iteration 6500, lr = 0.0075
I0210 16:52:18.902101 16731 solver.cpp:218] Iteration 6600 (7.01332 iter/s, 14.2586s/100 iters), loss = 0.0678121
I0210 16:52:18.902132 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0678121 (* 1 = 0.0678121 loss)
I0210 16:52:18.902138 16731 sgd_solver.cpp:114] Iteration 6600, lr = 0.00744444
I0210 16:52:33.186758 16731 solver.cpp:218] Iteration 6700 (7.00078 iter/s, 14.2841s/100 iters), loss = 0.0272759
I0210 16:52:33.186798 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.027276 (* 1 = 0.027276 loss)
I0210 16:52:33.186806 16731 sgd_solver.cpp:114] Iteration 6700, lr = 0.00738889
I0210 16:52:47.488950 16731 solver.cpp:218] Iteration 6800 (6.9922 iter/s, 14.3017s/100 iters), loss = 0.0389639
I0210 16:52:47.489089 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.038964 (* 1 = 0.038964 loss)
I0210 16:52:47.489099 16731 sgd_solver.cpp:114] Iteration 6800, lr = 0.00733333
I0210 16:53:01.787214 16731 solver.cpp:218] Iteration 6900 (6.99417 iter/s, 14.2976s/100 iters), loss = 0.0363986
I0210 16:53:01.787252 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0363986 (* 1 = 0.0363986 loss)
I0210 16:53:01.787259 16731 sgd_solver.cpp:114] Iteration 6900, lr = 0.00727778
I0210 16:53:16.108793 16731 solver.cpp:218] Iteration 7000 (6.98273 iter/s, 14.321s/100 iters), loss = 0.035026
I0210 16:53:16.108820 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0350261 (* 1 = 0.0350261 loss)
I0210 16:53:16.108826 16731 sgd_solver.cpp:114] Iteration 7000, lr = 0.00722222
I0210 16:53:30.379993 16731 solver.cpp:218] Iteration 7100 (7.00737 iter/s, 14.2707s/100 iters), loss = 0.08283
I0210 16:53:30.380087 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0828301 (* 1 = 0.0828301 loss)
I0210 16:53:30.380095 16731 sgd_solver.cpp:114] Iteration 7100, lr = 0.00716667
I0210 16:53:44.579658 16731 solver.cpp:218] Iteration 7200 (7.04271 iter/s, 14.1991s/100 iters), loss = 0.0532856
I0210 16:53:44.579712 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0532856 (* 1 = 0.0532856 loss)
I0210 16:53:44.579747 16731 sgd_solver.cpp:114] Iteration 7200, lr = 0.00711111
I0210 16:53:58.793996 16731 solver.cpp:218] Iteration 7300 (7.03542 iter/s, 14.2138s/100 iters), loss = 0.0307307
I0210 16:53:58.794026 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0307307 (* 1 = 0.0307307 loss)
I0210 16:53:58.794034 16731 sgd_solver.cpp:114] Iteration 7300, lr = 0.00705556
I0210 16:54:13.022604 16731 solver.cpp:218] Iteration 7400 (7.02835 iter/s, 14.2281s/100 iters), loss = 0.0485149
I0210 16:54:13.022712 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.048515 (* 1 = 0.048515 loss)
I0210 16:54:13.022732 16731 sgd_solver.cpp:114] Iteration 7400, lr = 0.007
I0210 16:54:27.264654 16731 solver.cpp:218] Iteration 7500 (7.02175 iter/s, 14.2415s/100 iters), loss = 0.0661068
I0210 16:54:27.264681 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0661069 (* 1 = 0.0661069 loss)
I0210 16:54:27.264688 16731 sgd_solver.cpp:114] Iteration 7500, lr = 0.00694444
I0210 16:54:41.539973 16731 solver.cpp:218] Iteration 7600 (7.00535 iter/s, 14.2748s/100 iters), loss = 0.0422459
I0210 16:54:41.540019 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0422459 (* 1 = 0.0422459 loss)
I0210 16:54:41.540027 16731 sgd_solver.cpp:114] Iteration 7600, lr = 0.00688889
I0210 16:54:55.781091 16731 solver.cpp:218] Iteration 7700 (7.02219 iter/s, 14.2406s/100 iters), loss = 0.0263888
I0210 16:54:55.781304 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0263888 (* 1 = 0.0263888 loss)
I0210 16:54:55.781316 16731 sgd_solver.cpp:114] Iteration 7700, lr = 0.00683333
I0210 16:55:10.029490 16731 solver.cpp:218] Iteration 7800 (7.01867 iter/s, 14.2477s/100 iters), loss = 0.0556985
I0210 16:55:10.029520 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0556985 (* 1 = 0.0556985 loss)
I0210 16:55:10.029528 16731 sgd_solver.cpp:114] Iteration 7800, lr = 0.00677778
I0210 16:55:24.261788 16731 solver.cpp:218] Iteration 7900 (7.02653 iter/s, 14.2318s/100 iters), loss = 0.0292171
I0210 16:55:24.261817 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0292171 (* 1 = 0.0292171 loss)
I0210 16:55:24.261823 16731 sgd_solver.cpp:114] Iteration 7900, lr = 0.00672222
I0210 16:55:38.544456 16731 solver.cpp:218] Iteration 8000 (7.00175 iter/s, 14.2821s/100 iters), loss = 0.0376539
I0210 16:55:38.544629 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.037654 (* 1 = 0.037654 loss)
I0210 16:55:38.544641 16731 sgd_solver.cpp:114] Iteration 8000, lr = 0.00666667
I0210 16:55:52.796824 16731 solver.cpp:218] Iteration 8100 (7.0167 iter/s, 14.2517s/100 iters), loss = 0.0196239
I0210 16:55:52.796857 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0196239 (* 1 = 0.0196239 loss)
I0210 16:55:52.796864 16731 sgd_solver.cpp:114] Iteration 8100, lr = 0.00661111
I0210 16:56:07.011129 16731 solver.cpp:218] Iteration 8200 (7.03542 iter/s, 14.2138s/100 iters), loss = 0.0556216
I0210 16:56:07.011159 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0556216 (* 1 = 0.0556216 loss)
I0210 16:56:07.011166 16731 sgd_solver.cpp:114] Iteration 8200, lr = 0.00655556
I0210 16:56:21.259155 16731 solver.cpp:218] Iteration 8300 (7.01877 iter/s, 14.2475s/100 iters), loss = 0.0468207
I0210 16:56:21.259302 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0468207 (* 1 = 0.0468207 loss)
I0210 16:56:21.259326 16731 sgd_solver.cpp:114] Iteration 8300, lr = 0.0065
I0210 16:56:35.516696 16731 solver.cpp:218] Iteration 8400 (7.01415 iter/s, 14.2569s/100 iters), loss = 0.0371367
I0210 16:56:35.516729 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0371367 (* 1 = 0.0371367 loss)
I0210 16:56:35.516736 16731 sgd_solver.cpp:114] Iteration 8400, lr = 0.00644444
I0210 16:56:49.723057 16731 solver.cpp:218] Iteration 8500 (7.03936 iter/s, 14.2058s/100 iters), loss = 0.0340138
I0210 16:56:49.723103 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0340138 (* 1 = 0.0340138 loss)
I0210 16:56:49.723110 16731 sgd_solver.cpp:114] Iteration 8500, lr = 0.00638889
I0210 16:57:04.006182 16731 solver.cpp:218] Iteration 8600 (7.00153 iter/s, 14.2826s/100 iters), loss = 0.0299182
I0210 16:57:04.006355 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0299183 (* 1 = 0.0299183 loss)
I0210 16:57:04.006361 16731 sgd_solver.cpp:114] Iteration 8600, lr = 0.00633333
I0210 16:57:18.254029 16731 solver.cpp:218] Iteration 8700 (7.01893 iter/s, 14.2472s/100 iters), loss = 0.0678392
I0210 16:57:18.254058 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0678393 (* 1 = 0.0678393 loss)
I0210 16:57:18.254065 16731 sgd_solver.cpp:114] Iteration 8700, lr = 0.00627778
I0210 16:57:32.476644 16731 solver.cpp:218] Iteration 8800 (7.03131 iter/s, 14.2221s/100 iters), loss = 0.0622539
I0210 16:57:32.476689 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.062254 (* 1 = 0.062254 loss)
I0210 16:57:32.476697 16731 sgd_solver.cpp:114] Iteration 8800, lr = 0.00622222
I0210 16:57:46.804064 16731 solver.cpp:218] Iteration 8900 (6.97989 iter/s, 14.3269s/100 iters), loss = 0.0305056
I0210 16:57:46.804265 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0305057 (* 1 = 0.0305057 loss)
I0210 16:57:46.804275 16731 sgd_solver.cpp:114] Iteration 8900, lr = 0.00616667
I0210 16:58:01.097187 16731 solver.cpp:218] Iteration 9000 (6.99673 iter/s, 14.2924s/100 iters), loss = 0.0285389
I0210 16:58:01.097220 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.028539 (* 1 = 0.028539 loss)
I0210 16:58:01.097227 16731 sgd_solver.cpp:114] Iteration 9000, lr = 0.00611111
I0210 16:58:15.447057 16731 solver.cpp:218] Iteration 9100 (6.96905 iter/s, 14.3492s/100 iters), loss = 0.0308133
I0210 16:58:15.447105 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0308133 (* 1 = 0.0308133 loss)
I0210 16:58:15.447113 16731 sgd_solver.cpp:114] Iteration 9100, lr = 0.00605556
I0210 16:58:29.741062 16731 solver.cpp:218] Iteration 9200 (6.99629 iter/s, 14.2933s/100 iters), loss = 0.0228782
I0210 16:58:29.741202 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0228783 (* 1 = 0.0228783 loss)
I0210 16:58:29.741225 16731 sgd_solver.cpp:114] Iteration 9200, lr = 0.006
I0210 16:58:44.066232 16731 solver.cpp:218] Iteration 9300 (6.9811 iter/s, 14.3244s/100 iters), loss = 0.047165
I0210 16:58:44.066262 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0471651 (* 1 = 0.0471651 loss)
I0210 16:58:44.066269 16731 sgd_solver.cpp:114] Iteration 9300, lr = 0.00594444
I0210 16:58:58.325562 16731 solver.cpp:218] Iteration 9400 (7.01329 iter/s, 14.2586s/100 iters), loss = 0.0209267
I0210 16:58:58.325608 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0209268 (* 1 = 0.0209268 loss)
I0210 16:58:58.325614 16731 sgd_solver.cpp:114] Iteration 9400, lr = 0.00588889
I0210 16:59:12.624805 16731 solver.cpp:218] Iteration 9500 (6.99372 iter/s, 14.2985s/100 iters), loss = 0.0535014
I0210 16:59:12.625643 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0535015 (* 1 = 0.0535015 loss)
I0210 16:59:12.625658 16731 sgd_solver.cpp:114] Iteration 9500, lr = 0.00583333
I0210 16:59:26.931238 16731 solver.cpp:218] Iteration 9600 (6.99058 iter/s, 14.305s/100 iters), loss = 0.0418551
I0210 16:59:26.931284 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0418551 (* 1 = 0.0418551 loss)
I0210 16:59:26.931293 16731 sgd_solver.cpp:114] Iteration 9600, lr = 0.00577778
I0210 16:59:41.287606 16731 solver.cpp:218] Iteration 9700 (6.96589 iter/s, 14.3557s/100 iters), loss = 0.0483802
I0210 16:59:41.287642 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0483803 (* 1 = 0.0483803 loss)
I0210 16:59:41.287647 16731 sgd_solver.cpp:114] Iteration 9700, lr = 0.00572222
I0210 16:59:55.579330 16731 solver.cpp:218] Iteration 9800 (6.99739 iter/s, 14.291s/100 iters), loss = 0.014749
I0210 16:59:55.579459 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0147491 (* 1 = 0.0147491 loss)
I0210 16:59:55.579468 16731 sgd_solver.cpp:114] Iteration 9800, lr = 0.00566667
I0210 17:00:09.944478 16731 solver.cpp:218] Iteration 9900 (6.96167 iter/s, 14.3644s/100 iters), loss = 0.0374938
I0210 17:00:09.944522 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0374939 (* 1 = 0.0374939 loss)
I0210 17:00:09.944530 16731 sgd_solver.cpp:114] Iteration 9900, lr = 0.00561111
I0210 17:00:24.127363 16731 solver.cpp:447] Snapshotting to binary proto file ./snapshot/1/alex-ignet-embed_iter_10000.caffemodel
I0210 17:00:24.641641 16731 sgd_solver.cpp:282] Snapshotting solver state to binary proto file ./snapshot/1/alex-ignet-embed_iter_10000.solverstate
I0210 17:00:24.743607 16731 solver.cpp:330] Iteration 10000, Testing net (#0)
I0210 17:00:24.743628 16731 net.cpp:676] Ignoring source layer data
I0210 17:00:24.743630 16731 net.cpp:676] Ignoring source layer embedding_fc1
I0210 17:00:24.743633 16731 net.cpp:676] Ignoring source layer bn_embedding_fc1
I0210 17:00:24.743634 16731 net.cpp:676] Ignoring source layer scale_embedding_fc1
I0210 17:00:24.743636 16731 net.cpp:676] Ignoring source layer relu_embedding_fc1
I0210 17:00:24.743638 16731 net.cpp:676] Ignoring source layer embedding_fc2
I0210 17:00:24.743640 16731 net.cpp:676] Ignoring source layer embedding_fc2_embedding_fc2_0_split
I0210 17:00:24.743643 16731 net.cpp:676] Ignoring source layer conv1
I0210 17:00:24.743645 16731 net.cpp:676] Ignoring source layer bn_conv1
I0210 17:00:24.743647 16731 net.cpp:676] Ignoring source layer scale_conv1
I0210 17:00:24.743649 16731 net.cpp:676] Ignoring source layer relu1
I0210 17:00:24.743651 16731 net.cpp:676] Ignoring source layer pool1
I0210 17:00:24.743655 16731 net.cpp:676] Ignoring source layer filter_ip2
I0210 17:00:24.743659 16731 net.cpp:676] Ignoring source layer conv2
I0210 17:00:24.743661 16731 net.cpp:676] Ignoring source layer bn_conv2
I0210 17:00:24.743664 16731 net.cpp:676] Ignoring source layer scale_conv2
I0210 17:00:24.743666 16731 net.cpp:676] Ignoring source layer relu2
I0210 17:00:24.743669 16731 net.cpp:676] Ignoring source layer pool2
I0210 17:00:24.743671 16731 net.cpp:676] Ignoring source layer filter_ip3
I0210 17:00:24.743674 16731 net.cpp:676] Ignoring source layer conv3
I0210 17:00:24.743677 16731 net.cpp:676] Ignoring source layer bn_conv3
I0210 17:00:24.743680 16731 net.cpp:676] Ignoring source layer scale_conv3
I0210 17:00:24.743682 16731 net.cpp:676] Ignoring source layer relu3
I0210 17:00:24.743685 16731 net.cpp:676] Ignoring source layer filter_ip4
I0210 17:00:24.743687 16731 net.cpp:676] Ignoring source layer conv4
I0210 17:00:24.743690 16731 net.cpp:676] Ignoring source layer bn_conv4
I0210 17:00:24.743692 16731 net.cpp:676] Ignoring source layer scale_conv4
I0210 17:00:24.743695 16731 net.cpp:676] Ignoring source layer relu4
I0210 17:00:24.743698 16731 net.cpp:676] Ignoring source layer filter_ip5
I0210 17:00:24.743701 16731 net.cpp:676] Ignoring source layer conv5
I0210 17:00:24.743703 16731 net.cpp:676] Ignoring source layer bn_conv5
I0210 17:00:24.743705 16731 net.cpp:676] Ignoring source layer scale_conv5
I0210 17:00:24.743710 16731 net.cpp:676] Ignoring source layer relu5
I0210 17:00:24.743711 16731 net.cpp:676] Ignoring source layer pool5
I0210 17:00:24.743715 16731 net.cpp:676] Ignoring source layer filter_ip6
I0210 17:00:24.743716 16731 net.cpp:676] Ignoring source layer feat0
I0210 17:00:24.743721 16731 net.cpp:676] Ignoring source layer bn_feat0
I0210 17:00:24.743723 16731 net.cpp:676] Ignoring source layer scale_feat0
I0210 17:00:24.743726 16731 net.cpp:676] Ignoring source layer relu_feat0
I0210 17:00:24.743728 16731 net.cpp:676] Ignoring source layer filter_ip7
I0210 17:00:24.743731 16731 net.cpp:676] Ignoring source layer feat1
I0210 17:00:24.743732 16731 net.cpp:676] Ignoring source layer eucli_loss
W0210 17:00:24.978454 16731 _caffe.cpp:139] DEPRECATION WARNING - deprecated use of Python interface
W0210 17:00:24.978482 16731 _caffe.cpp:140] Use this instead (with the named "weights" parameter):
W0210 17:00:24.978498 16731 _caffe.cpp:142] Net('./alexnet-deploy-ignet-embed.prototxt', 1, weights='./snapshot/1/alex-ignet-embed_iter_10000.caffemodel')
I0210 17:00:24.978708 16731 upgrade_proto.cpp:67] Attempting to upgrade input file specified using deprecated input fields: ./alexnet-deploy-ignet-embed.prototxt
I0210 17:00:24.978716 16731 upgrade_proto.cpp:70] Successfully upgraded file specified using deprecated input fields.
W0210 17:00:24.978719 16731 upgrade_proto.cpp:72] Note that future Caffe releases will only support input layers and not input fields.
I0210 17:00:24.978937 16731 net.cpp:51] Initializing net from parameters: 
name: "AlexNet-ignet"
state {
  phase: TEST
  level: 0
}
layer {
  name: "input"
  type: "Input"
  top: "data"
  top: "extra"
  input_param {
    shape {
      dim: 1
      dim: 3
      dim: 224
      dim: 224
    }
    shape {
      dim: 1
      dim: 2
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding_fc1"
  type: "InnerProduct"
  bottom: "extra"
  top: "embedding_fc1"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 256
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "bn_embedding_fc1"
  type: "BatchNorm"
  bottom: "embedding_fc1"
  top: "embedding_fc1"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_embedding_fc1"
  type: "Scale"
  bottom: "embedding_fc1"
  top: "embedding_fc1"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu_embedding_fc1"
  type: "ReLU"
  bottom: "embedding_fc1"
  top: "embedding_fc1"
}
layer {
  name: "embedding_fc2"
  type: "InnerProduct"
  bottom: "embedding_fc1"
  top: "embedding_fc2"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 1
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  param {
    name: "conv1_w"
    lr_mult: 1
    decay_mult: 1
  }
  param {
    name: "conv1_b"
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
  }
}
layer {
  name: "bn_conv1"
  type: "BatchNorm"
  bottom: "conv1"
  top: "conv1"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_conv1"
  type: "Scale"
  bottom: "conv1"
  top: "conv1"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "filter_ip2"
  type: "InnerProduct"
  bottom: "embedding_fc2"
  top: "filter_ip2"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 307200
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "pool1"
  bottom: "filter_ip2"
  top: "conv2"
  param {
    name: "conv2_w"
    lr_mult: 1
    decay_mult: 1
  }
  param {
    name: "conv2_b"
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
    weight_operation: COPY
  }
}
layer {
  name: "bn_conv2"
  type: "BatchNorm"
  bottom: "conv2"
  top: "conv2"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_conv2"
  type: "Scale"
  bottom: "conv2"
  top: "conv2"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "filter_ip3"
  type: "InnerProduct"
  bottom: "embedding_fc2"
  top: "filter_ip3"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 884736
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "pool2"
  bottom: "filter_ip3"
  top: "conv3"
  param {
    name: "conv3_w"
    lr_mult: 1
    decay_mult: 1
  }
  param {
    name: "conv3_b"
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
    weight_operation: COPY
  }
}
layer {
  name: "bn_conv3"
  type: "BatchNorm"
  bottom: "conv3"
  top: "conv3"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_conv3"
  type: "Scale"
  bottom: "conv3"
  top: "conv3"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "filter_ip4"
  type: "InnerProduct"
  bottom: "embedding_fc2"
  top: "filter_ip4"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 663552
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  bottom: "filter_ip4"
  top: "conv4"
  param {
    name: "conv4_w"
    lr_mult: 1
    decay_mult: 1
  }
  param {
    name: "conv4_b"
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
    weight_operation: COPY
  }
}
layer {
  name: "bn_conv4"
  type: "BatchNorm"
  bottom: "conv4"
  top: "conv4"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_conv4"
  type: "Scale"
  bottom: "conv4"
  top: "conv4"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "filter_ip5"
  type: "InnerProduct"
  bottom: "embedding_fc2"
  top: "filter_ip5"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 442368
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  bottom: "filter_ip5"
  top: "conv5"
  param {
    name: "conv5_w"
    lr_mult: 1
    decay_mult: 1
  }
  param {
    name: "conv5_b"
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
    weight_operation: COPY
  }
}
layer {
  name: "bn_conv5"
  type: "BatchNorm"
  bottom: "conv5"
  top: "conv5"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_conv5"
  type: "Scale"
  bottom: "conv5"
  top: "conv5"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "filter_ip6"
  type: "InnerProduct"
  bottom: "embedding_fc2"
  top: "filter_ip6"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 4718592
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "feat0"
  type: "Convolution"
  bottom: "pool5"
  bottom: "filter_ip6"
  top: "feat0"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 512
    kernel_size: 6
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
    weight_operation: COPY
  }
}
layer {
  name: "bn_feat0"
  type: "BatchNorm"
  bottom: "feat0"
  top: "feat0"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_feat0"
  type: "Scale"
  bottom: "feat0"
  top: "feat0"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu_feat0"
  type: "ReLU"
  bottom: "feat0"
  top: "feat0"
}
layer {
  name: "filter_ip7"
  type: "InnerProduct"
  bottom: "embedding_fc2"
  top: "filter_ip7"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 512
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "feat1"
  type: "Convolution"
  bottom: "feat0"
  bottom: "filter_ip7"
  top: "feat1"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 1
    kernel_size: 1
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
    weight_operation: COPY
  }
}
I0210 17:00:24.979038 16731 layer_factory.hpp:77] Creating layer input
I0210 17:00:24.979045 16731 net.cpp:84] Creating Layer input
I0210 17:00:24.979048 16731 net.cpp:380] input -> data
I0210 17:00:24.979056 16731 net.cpp:380] input -> extra
I0210 17:00:24.979144 16731 net.cpp:122] Setting up input
I0210 17:00:24.979149 16731 net.cpp:129] Top shape: 1 3 224 224 (150528)
I0210 17:00:24.979152 16731 net.cpp:129] Top shape: 1 2 1 1 (2)
I0210 17:00:24.979154 16731 net.cpp:137] Memory required for data: 602120
I0210 17:00:24.979156 16731 layer_factory.hpp:77] Creating layer embedding_fc1
I0210 17:00:24.979161 16731 net.cpp:84] Creating Layer embedding_fc1
I0210 17:00:24.979163 16731 net.cpp:406] embedding_fc1 <- extra
I0210 17:00:24.979167 16731 net.cpp:380] embedding_fc1 -> embedding_fc1
I0210 17:00:24.979271 16731 net.cpp:122] Setting up embedding_fc1
I0210 17:00:24.979275 16731 net.cpp:129] Top shape: 1 256 (256)
I0210 17:00:24.979277 16731 net.cpp:137] Memory required for data: 603144
I0210 17:00:24.979285 16731 layer_factory.hpp:77] Creating layer bn_embedding_fc1
I0210 17:00:24.979288 16731 net.cpp:84] Creating Layer bn_embedding_fc1
I0210 17:00:24.979290 16731 net.cpp:406] bn_embedding_fc1 <- embedding_fc1
I0210 17:00:24.979293 16731 net.cpp:367] bn_embedding_fc1 -> embedding_fc1 (in-place)
I0210 17:00:24.979454 16731 net.cpp:122] Setting up bn_embedding_fc1
I0210 17:00:24.979459 16731 net.cpp:129] Top shape: 1 256 (256)
I0210 17:00:24.979460 16731 net.cpp:137] Memory required for data: 604168
I0210 17:00:24.979465 16731 layer_factory.hpp:77] Creating layer scale_embedding_fc1
I0210 17:00:24.979470 16731 net.cpp:84] Creating Layer scale_embedding_fc1
I0210 17:00:24.979472 16731 net.cpp:406] scale_embedding_fc1 <- embedding_fc1
I0210 17:00:24.979475 16731 net.cpp:367] scale_embedding_fc1 -> embedding_fc1 (in-place)
I0210 17:00:24.979506 16731 layer_factory.hpp:77] Creating layer scale_embedding_fc1
I0210 17:00:24.979596 16731 net.cpp:122] Setting up scale_embedding_fc1
I0210 17:00:24.979600 16731 net.cpp:129] Top shape: 1 256 (256)
I0210 17:00:24.979602 16731 net.cpp:137] Memory required for data: 605192
I0210 17:00:24.979605 16731 layer_factory.hpp:77] Creating layer relu_embedding_fc1
I0210 17:00:24.979610 16731 net.cpp:84] Creating Layer relu_embedding_fc1
I0210 17:00:24.979612 16731 net.cpp:406] relu_embedding_fc1 <- embedding_fc1
I0210 17:00:24.979622 16731 net.cpp:367] relu_embedding_fc1 -> embedding_fc1 (in-place)
I0210 17:00:24.979877 16731 net.cpp:122] Setting up relu_embedding_fc1
I0210 17:00:24.979883 16731 net.cpp:129] Top shape: 1 256 (256)
I0210 17:00:24.979885 16731 net.cpp:137] Memory required for data: 606216
I0210 17:00:24.979887 16731 layer_factory.hpp:77] Creating layer embedding_fc2
I0210 17:00:24.979890 16731 net.cpp:84] Creating Layer embedding_fc2
I0210 17:00:24.979893 16731 net.cpp:406] embedding_fc2 <- embedding_fc1
I0210 17:00:24.979897 16731 net.cpp:380] embedding_fc2 -> embedding_fc2
I0210 17:00:24.979987 16731 net.cpp:122] Setting up embedding_fc2
I0210 17:00:24.979991 16731 net.cpp:129] Top shape: 1 1 (1)
I0210 17:00:24.979993 16731 net.cpp:137] Memory required for data: 606220
I0210 17:00:24.979998 16731 layer_factory.hpp:77] Creating layer embedding_fc2_embedding_fc2_0_split
I0210 17:00:24.980002 16731 net.cpp:84] Creating Layer embedding_fc2_embedding_fc2_0_split
I0210 17:00:24.980005 16731 net.cpp:406] embedding_fc2_embedding_fc2_0_split <- embedding_fc2
I0210 17:00:24.980008 16731 net.cpp:380] embedding_fc2_embedding_fc2_0_split -> embedding_fc2_embedding_fc2_0_split_0
I0210 17:00:24.980012 16731 net.cpp:380] embedding_fc2_embedding_fc2_0_split -> embedding_fc2_embedding_fc2_0_split_1
I0210 17:00:24.980016 16731 net.cpp:380] embedding_fc2_embedding_fc2_0_split -> embedding_fc2_embedding_fc2_0_split_2
I0210 17:00:24.980020 16731 net.cpp:380] embedding_fc2_embedding_fc2_0_split -> embedding_fc2_embedding_fc2_0_split_3
I0210 17:00:24.980024 16731 net.cpp:380] embedding_fc2_embedding_fc2_0_split -> embedding_fc2_embedding_fc2_0_split_4
I0210 17:00:24.980028 16731 net.cpp:380] embedding_fc2_embedding_fc2_0_split -> embedding_fc2_embedding_fc2_0_split_5
I0210 17:00:24.980099 16731 net.cpp:122] Setting up embedding_fc2_embedding_fc2_0_split
I0210 17:00:24.980103 16731 net.cpp:129] Top shape: 1 1 (1)
I0210 17:00:24.980105 16731 net.cpp:129] Top shape: 1 1 (1)
I0210 17:00:24.980108 16731 net.cpp:129] Top shape: 1 1 (1)
I0210 17:00:24.980109 16731 net.cpp:129] Top shape: 1 1 (1)
I0210 17:00:24.980113 16731 net.cpp:129] Top shape: 1 1 (1)
I0210 17:00:24.980114 16731 net.cpp:129] Top shape: 1 1 (1)
I0210 17:00:24.980116 16731 net.cpp:137] Memory required for data: 606244
I0210 17:00:24.980118 16731 layer_factory.hpp:77] Creating layer conv1
I0210 17:00:24.980123 16731 net.cpp:84] Creating Layer conv1
I0210 17:00:24.980126 16731 net.cpp:406] conv1 <- data
I0210 17:00:24.980130 16731 net.cpp:380] conv1 -> conv1
I0210 17:00:24.980576 16731 net.cpp:122] Setting up conv1
I0210 17:00:24.980581 16731 net.cpp:129] Top shape: 1 96 54 54 (279936)
I0210 17:00:24.980583 16731 net.cpp:137] Memory required for data: 1725988
I0210 17:00:24.980587 16731 layer_factory.hpp:77] Creating layer bn_conv1
I0210 17:00:24.980592 16731 net.cpp:84] Creating Layer bn_conv1
I0210 17:00:24.980593 16731 net.cpp:406] bn_conv1 <- conv1
I0210 17:00:24.980597 16731 net.cpp:367] bn_conv1 -> conv1 (in-place)
I0210 17:00:24.980769 16731 net.cpp:122] Setting up bn_conv1
I0210 17:00:24.980772 16731 net.cpp:129] Top shape: 1 96 54 54 (279936)
I0210 17:00:24.980774 16731 net.cpp:137] Memory required for data: 2845732
I0210 17:00:24.980779 16731 layer_factory.hpp:77] Creating layer scale_conv1
I0210 17:00:24.980782 16731 net.cpp:84] Creating Layer scale_conv1
I0210 17:00:24.980784 16731 net.cpp:406] scale_conv1 <- conv1
I0210 17:00:24.980787 16731 net.cpp:367] scale_conv1 -> conv1 (in-place)
I0210 17:00:24.980819 16731 layer_factory.hpp:77] Creating layer scale_conv1
I0210 17:00:24.980921 16731 net.cpp:122] Setting up scale_conv1
I0210 17:00:24.980924 16731 net.cpp:129] Top shape: 1 96 54 54 (279936)
I0210 17:00:24.980926 16731 net.cpp:137] Memory required for data: 3965476
I0210 17:00:24.980931 16731 layer_factory.hpp:77] Creating layer relu1
I0210 17:00:24.980933 16731 net.cpp:84] Creating Layer relu1
I0210 17:00:24.980935 16731 net.cpp:406] relu1 <- conv1
I0210 17:00:24.980938 16731 net.cpp:367] relu1 -> conv1 (in-place)
I0210 17:00:24.981150 16731 net.cpp:122] Setting up relu1
I0210 17:00:24.981155 16731 net.cpp:129] Top shape: 1 96 54 54 (279936)
I0210 17:00:24.981158 16731 net.cpp:137] Memory required for data: 5085220
I0210 17:00:24.981159 16731 layer_factory.hpp:77] Creating layer pool1
I0210 17:00:24.981164 16731 net.cpp:84] Creating Layer pool1
I0210 17:00:24.981166 16731 net.cpp:406] pool1 <- conv1
I0210 17:00:24.981169 16731 net.cpp:380] pool1 -> pool1
I0210 17:00:24.981204 16731 net.cpp:122] Setting up pool1
I0210 17:00:24.981209 16731 net.cpp:129] Top shape: 1 96 27 27 (69984)
I0210 17:00:24.981210 16731 net.cpp:137] Memory required for data: 5365156
I0210 17:00:24.981212 16731 layer_factory.hpp:77] Creating layer filter_ip2
I0210 17:00:24.981215 16731 net.cpp:84] Creating Layer filter_ip2
I0210 17:00:24.981218 16731 net.cpp:406] filter_ip2 <- embedding_fc2_embedding_fc2_0_split_0
I0210 17:00:24.981221 16731 net.cpp:380] filter_ip2 -> filter_ip2
I0210 17:00:24.984583 16731 net.cpp:122] Setting up filter_ip2
I0210 17:00:24.984597 16731 net.cpp:129] Top shape: 1 307200 (307200)
I0210 17:00:24.984601 16731 net.cpp:137] Memory required for data: 6593956
I0210 17:00:24.984608 16731 layer_factory.hpp:77] Creating layer conv2
I0210 17:00:24.984618 16731 net.cpp:84] Creating Layer conv2
I0210 17:00:24.984622 16731 net.cpp:406] conv2 <- pool1
I0210 17:00:24.984625 16731 net.cpp:406] conv2 <- filter_ip2
I0210 17:00:24.984629 16731 net.cpp:380] conv2 -> conv2
I0210 17:00:24.987373 16731 net.cpp:122] Setting up conv2
I0210 17:00:24.987393 16731 net.cpp:129] Top shape: 1 256 27 27 (186624)
I0210 17:00:24.987396 16731 net.cpp:137] Memory required for data: 7340452
I0210 17:00:24.987402 16731 layer_factory.hpp:77] Creating layer bn_conv2
I0210 17:00:24.987411 16731 net.cpp:84] Creating Layer bn_conv2
I0210 17:00:24.987414 16731 net.cpp:406] bn_conv2 <- conv2
I0210 17:00:24.987419 16731 net.cpp:367] bn_conv2 -> conv2 (in-place)
I0210 17:00:24.987604 16731 net.cpp:122] Setting up bn_conv2
I0210 17:00:24.987608 16731 net.cpp:129] Top shape: 1 256 27 27 (186624)
I0210 17:00:24.987610 16731 net.cpp:137] Memory required for data: 8086948
I0210 17:00:24.987617 16731 layer_factory.hpp:77] Creating layer scale_conv2
I0210 17:00:24.987622 16731 net.cpp:84] Creating Layer scale_conv2
I0210 17:00:24.987623 16731 net.cpp:406] scale_conv2 <- conv2
I0210 17:00:24.987627 16731 net.cpp:367] scale_conv2 -> conv2 (in-place)
I0210 17:00:24.987660 16731 layer_factory.hpp:77] Creating layer scale_conv2
I0210 17:00:24.987761 16731 net.cpp:122] Setting up scale_conv2
I0210 17:00:24.987764 16731 net.cpp:129] Top shape: 1 256 27 27 (186624)
I0210 17:00:24.987766 16731 net.cpp:137] Memory required for data: 8833444
I0210 17:00:24.987771 16731 layer_factory.hpp:77] Creating layer relu2
I0210 17:00:24.987776 16731 net.cpp:84] Creating Layer relu2
I0210 17:00:24.987778 16731 net.cpp:406] relu2 <- conv2
I0210 17:00:24.987782 16731 net.cpp:367] relu2 -> conv2 (in-place)
I0210 17:00:24.988036 16731 net.cpp:122] Setting up relu2
I0210 17:00:24.988042 16731 net.cpp:129] Top shape: 1 256 27 27 (186624)
I0210 17:00:24.988044 16731 net.cpp:137] Memory required for data: 9579940
I0210 17:00:24.988046 16731 layer_factory.hpp:77] Creating layer pool2
I0210 17:00:24.988051 16731 net.cpp:84] Creating Layer pool2
I0210 17:00:24.988054 16731 net.cpp:406] pool2 <- conv2
I0210 17:00:24.988056 16731 net.cpp:380] pool2 -> pool2
I0210 17:00:24.988095 16731 net.cpp:122] Setting up pool2
I0210 17:00:24.988098 16731 net.cpp:129] Top shape: 1 256 13 13 (43264)
I0210 17:00:24.988101 16731 net.cpp:137] Memory required for data: 9752996
I0210 17:00:24.988102 16731 layer_factory.hpp:77] Creating layer filter_ip3
I0210 17:00:24.988106 16731 net.cpp:84] Creating Layer filter_ip3
I0210 17:00:24.988109 16731 net.cpp:406] filter_ip3 <- embedding_fc2_embedding_fc2_0_split_1
I0210 17:00:24.988113 16731 net.cpp:380] filter_ip3 -> filter_ip3
I0210 17:00:24.995738 16731 net.cpp:122] Setting up filter_ip3
I0210 17:00:24.995752 16731 net.cpp:129] Top shape: 1 884736 (884736)
I0210 17:00:24.995755 16731 net.cpp:137] Memory required for data: 13291940
I0210 17:00:24.995781 16731 layer_factory.hpp:77] Creating layer conv3
I0210 17:00:24.995792 16731 net.cpp:84] Creating Layer conv3
I0210 17:00:24.995795 16731 net.cpp:406] conv3 <- pool2
I0210 17:00:24.995800 16731 net.cpp:406] conv3 <- filter_ip3
I0210 17:00:24.995803 16731 net.cpp:380] conv3 -> conv3
I0210 17:00:25.002318 16731 net.cpp:122] Setting up conv3
I0210 17:00:25.002332 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 17:00:25.002336 16731 net.cpp:137] Memory required for data: 13551524
I0210 17:00:25.002341 16731 layer_factory.hpp:77] Creating layer bn_conv3
I0210 17:00:25.002346 16731 net.cpp:84] Creating Layer bn_conv3
I0210 17:00:25.002349 16731 net.cpp:406] bn_conv3 <- conv3
I0210 17:00:25.002353 16731 net.cpp:367] bn_conv3 -> conv3 (in-place)
I0210 17:00:25.002526 16731 net.cpp:122] Setting up bn_conv3
I0210 17:00:25.002530 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 17:00:25.002533 16731 net.cpp:137] Memory required for data: 13811108
I0210 17:00:25.002538 16731 layer_factory.hpp:77] Creating layer scale_conv3
I0210 17:00:25.002542 16731 net.cpp:84] Creating Layer scale_conv3
I0210 17:00:25.002544 16731 net.cpp:406] scale_conv3 <- conv3
I0210 17:00:25.002547 16731 net.cpp:367] scale_conv3 -> conv3 (in-place)
I0210 17:00:25.002578 16731 layer_factory.hpp:77] Creating layer scale_conv3
I0210 17:00:25.002676 16731 net.cpp:122] Setting up scale_conv3
I0210 17:00:25.002679 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 17:00:25.002681 16731 net.cpp:137] Memory required for data: 14070692
I0210 17:00:25.002688 16731 layer_factory.hpp:77] Creating layer relu3
I0210 17:00:25.002692 16731 net.cpp:84] Creating Layer relu3
I0210 17:00:25.002694 16731 net.cpp:406] relu3 <- conv3
I0210 17:00:25.002696 16731 net.cpp:367] relu3 -> conv3 (in-place)
I0210 17:00:25.003005 16731 net.cpp:122] Setting up relu3
I0210 17:00:25.003010 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 17:00:25.003012 16731 net.cpp:137] Memory required for data: 14330276
I0210 17:00:25.003015 16731 layer_factory.hpp:77] Creating layer filter_ip4
I0210 17:00:25.003021 16731 net.cpp:84] Creating Layer filter_ip4
I0210 17:00:25.003022 16731 net.cpp:406] filter_ip4 <- embedding_fc2_embedding_fc2_0_split_2
I0210 17:00:25.003026 16731 net.cpp:380] filter_ip4 -> filter_ip4
I0210 17:00:25.009136 16731 net.cpp:122] Setting up filter_ip4
I0210 17:00:25.009156 16731 net.cpp:129] Top shape: 1 663552 (663552)
I0210 17:00:25.009158 16731 net.cpp:137] Memory required for data: 16984484
I0210 17:00:25.009166 16731 layer_factory.hpp:77] Creating layer conv4
I0210 17:00:25.009177 16731 net.cpp:84] Creating Layer conv4
I0210 17:00:25.009181 16731 net.cpp:406] conv4 <- conv3
I0210 17:00:25.009186 16731 net.cpp:406] conv4 <- filter_ip4
I0210 17:00:25.009189 16731 net.cpp:380] conv4 -> conv4
I0210 17:00:25.014710 16731 net.cpp:122] Setting up conv4
I0210 17:00:25.014729 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 17:00:25.014730 16731 net.cpp:137] Memory required for data: 17244068
I0210 17:00:25.014735 16731 layer_factory.hpp:77] Creating layer bn_conv4
I0210 17:00:25.014742 16731 net.cpp:84] Creating Layer bn_conv4
I0210 17:00:25.014745 16731 net.cpp:406] bn_conv4 <- conv4
I0210 17:00:25.014750 16731 net.cpp:367] bn_conv4 -> conv4 (in-place)
I0210 17:00:25.014928 16731 net.cpp:122] Setting up bn_conv4
I0210 17:00:25.014932 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 17:00:25.014935 16731 net.cpp:137] Memory required for data: 17503652
I0210 17:00:25.014940 16731 layer_factory.hpp:77] Creating layer scale_conv4
I0210 17:00:25.014943 16731 net.cpp:84] Creating Layer scale_conv4
I0210 17:00:25.014945 16731 net.cpp:406] scale_conv4 <- conv4
I0210 17:00:25.014950 16731 net.cpp:367] scale_conv4 -> conv4 (in-place)
I0210 17:00:25.014979 16731 layer_factory.hpp:77] Creating layer scale_conv4
I0210 17:00:25.015079 16731 net.cpp:122] Setting up scale_conv4
I0210 17:00:25.015082 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 17:00:25.015084 16731 net.cpp:137] Memory required for data: 17763236
I0210 17:00:25.015108 16731 layer_factory.hpp:77] Creating layer relu4
I0210 17:00:25.015113 16731 net.cpp:84] Creating Layer relu4
I0210 17:00:25.015115 16731 net.cpp:406] relu4 <- conv4
I0210 17:00:25.015118 16731 net.cpp:367] relu4 -> conv4 (in-place)
I0210 17:00:25.015447 16731 net.cpp:122] Setting up relu4
I0210 17:00:25.015453 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 17:00:25.015455 16731 net.cpp:137] Memory required for data: 18022820
I0210 17:00:25.015457 16731 layer_factory.hpp:77] Creating layer filter_ip5
I0210 17:00:25.015462 16731 net.cpp:84] Creating Layer filter_ip5
I0210 17:00:25.015465 16731 net.cpp:406] filter_ip5 <- embedding_fc2_embedding_fc2_0_split_3
I0210 17:00:25.015468 16731 net.cpp:380] filter_ip5 -> filter_ip5
I0210 17:00:25.019464 16731 net.cpp:122] Setting up filter_ip5
I0210 17:00:25.019474 16731 net.cpp:129] Top shape: 1 442368 (442368)
I0210 17:00:25.019477 16731 net.cpp:137] Memory required for data: 19792292
I0210 17:00:25.019481 16731 layer_factory.hpp:77] Creating layer conv5
I0210 17:00:25.019490 16731 net.cpp:84] Creating Layer conv5
I0210 17:00:25.019492 16731 net.cpp:406] conv5 <- conv4
I0210 17:00:25.019495 16731 net.cpp:406] conv5 <- filter_ip5
I0210 17:00:25.019500 16731 net.cpp:380] conv5 -> conv5
I0210 17:00:25.022887 16731 net.cpp:122] Setting up conv5
I0210 17:00:25.022897 16731 net.cpp:129] Top shape: 1 256 13 13 (43264)
I0210 17:00:25.022899 16731 net.cpp:137] Memory required for data: 19965348
I0210 17:00:25.022904 16731 layer_factory.hpp:77] Creating layer bn_conv5
I0210 17:00:25.022910 16731 net.cpp:84] Creating Layer bn_conv5
I0210 17:00:25.022912 16731 net.cpp:406] bn_conv5 <- conv5
I0210 17:00:25.022917 16731 net.cpp:367] bn_conv5 -> conv5 (in-place)
I0210 17:00:25.023092 16731 net.cpp:122] Setting up bn_conv5
I0210 17:00:25.023097 16731 net.cpp:129] Top shape: 1 256 13 13 (43264)
I0210 17:00:25.023098 16731 net.cpp:137] Memory required for data: 20138404
I0210 17:00:25.023103 16731 layer_factory.hpp:77] Creating layer scale_conv5
I0210 17:00:25.023108 16731 net.cpp:84] Creating Layer scale_conv5
I0210 17:00:25.023110 16731 net.cpp:406] scale_conv5 <- conv5
I0210 17:00:25.023113 16731 net.cpp:367] scale_conv5 -> conv5 (in-place)
I0210 17:00:25.023146 16731 layer_factory.hpp:77] Creating layer scale_conv5
I0210 17:00:25.023243 16731 net.cpp:122] Setting up scale_conv5
I0210 17:00:25.023247 16731 net.cpp:129] Top shape: 1 256 13 13 (43264)
I0210 17:00:25.023249 16731 net.cpp:137] Memory required for data: 20311460
I0210 17:00:25.023252 16731 layer_factory.hpp:77] Creating layer relu5
I0210 17:00:25.023258 16731 net.cpp:84] Creating Layer relu5
I0210 17:00:25.023262 16731 net.cpp:406] relu5 <- conv5
I0210 17:00:25.023264 16731 net.cpp:367] relu5 -> conv5 (in-place)
I0210 17:00:25.023777 16731 net.cpp:122] Setting up relu5
I0210 17:00:25.023784 16731 net.cpp:129] Top shape: 1 256 13 13 (43264)
I0210 17:00:25.023787 16731 net.cpp:137] Memory required for data: 20484516
I0210 17:00:25.023789 16731 layer_factory.hpp:77] Creating layer pool5
I0210 17:00:25.023793 16731 net.cpp:84] Creating Layer pool5
I0210 17:00:25.023795 16731 net.cpp:406] pool5 <- conv5
I0210 17:00:25.023799 16731 net.cpp:380] pool5 -> pool5
I0210 17:00:25.023838 16731 net.cpp:122] Setting up pool5
I0210 17:00:25.023842 16731 net.cpp:129] Top shape: 1 256 6 6 (9216)
I0210 17:00:25.023844 16731 net.cpp:137] Memory required for data: 20521380
I0210 17:00:25.023846 16731 layer_factory.hpp:77] Creating layer filter_ip6
I0210 17:00:25.023850 16731 net.cpp:84] Creating Layer filter_ip6
I0210 17:00:25.023852 16731 net.cpp:406] filter_ip6 <- embedding_fc2_embedding_fc2_0_split_4
I0210 17:00:25.023855 16731 net.cpp:380] filter_ip6 -> filter_ip6
I0210 17:00:25.061590 16731 net.cpp:122] Setting up filter_ip6
I0210 17:00:25.061610 16731 net.cpp:129] Top shape: 1 4718592 (4718592)
I0210 17:00:25.061614 16731 net.cpp:137] Memory required for data: 39395748
I0210 17:00:25.061620 16731 layer_factory.hpp:77] Creating layer feat0
I0210 17:00:25.061630 16731 net.cpp:84] Creating Layer feat0
I0210 17:00:25.061656 16731 net.cpp:406] feat0 <- pool5
I0210 17:00:25.061661 16731 net.cpp:406] feat0 <- filter_ip6
I0210 17:00:25.061664 16731 net.cpp:380] feat0 -> feat0
I0210 17:00:25.093907 16731 net.cpp:122] Setting up feat0
I0210 17:00:25.093924 16731 net.cpp:129] Top shape: 1 512 1 1 (512)
I0210 17:00:25.093925 16731 net.cpp:137] Memory required for data: 39397796
I0210 17:00:25.093931 16731 layer_factory.hpp:77] Creating layer bn_feat0
I0210 17:00:25.093937 16731 net.cpp:84] Creating Layer bn_feat0
I0210 17:00:25.093940 16731 net.cpp:406] bn_feat0 <- feat0
I0210 17:00:25.093945 16731 net.cpp:367] bn_feat0 -> feat0 (in-place)
I0210 17:00:25.094169 16731 net.cpp:122] Setting up bn_feat0
I0210 17:00:25.094174 16731 net.cpp:129] Top shape: 1 512 1 1 (512)
I0210 17:00:25.094175 16731 net.cpp:137] Memory required for data: 39399844
I0210 17:00:25.094180 16731 layer_factory.hpp:77] Creating layer scale_feat0
I0210 17:00:25.094184 16731 net.cpp:84] Creating Layer scale_feat0
I0210 17:00:25.094187 16731 net.cpp:406] scale_feat0 <- feat0
I0210 17:00:25.094189 16731 net.cpp:367] scale_feat0 -> feat0 (in-place)
I0210 17:00:25.094221 16731 layer_factory.hpp:77] Creating layer scale_feat0
I0210 17:00:25.094323 16731 net.cpp:122] Setting up scale_feat0
I0210 17:00:25.094327 16731 net.cpp:129] Top shape: 1 512 1 1 (512)
I0210 17:00:25.094329 16731 net.cpp:137] Memory required for data: 39401892
I0210 17:00:25.094332 16731 layer_factory.hpp:77] Creating layer relu_feat0
I0210 17:00:25.094336 16731 net.cpp:84] Creating Layer relu_feat0
I0210 17:00:25.094338 16731 net.cpp:406] relu_feat0 <- feat0
I0210 17:00:25.094341 16731 net.cpp:367] relu_feat0 -> feat0 (in-place)
I0210 17:00:25.094676 16731 net.cpp:122] Setting up relu_feat0
I0210 17:00:25.094681 16731 net.cpp:129] Top shape: 1 512 1 1 (512)
I0210 17:00:25.094683 16731 net.cpp:137] Memory required for data: 39403940
I0210 17:00:25.094686 16731 layer_factory.hpp:77] Creating layer filter_ip7
I0210 17:00:25.094691 16731 net.cpp:84] Creating Layer filter_ip7
I0210 17:00:25.094692 16731 net.cpp:406] filter_ip7 <- embedding_fc2_embedding_fc2_0_split_5
I0210 17:00:25.094696 16731 net.cpp:380] filter_ip7 -> filter_ip7
I0210 17:00:25.094800 16731 net.cpp:122] Setting up filter_ip7
I0210 17:00:25.094804 16731 net.cpp:129] Top shape: 1 512 (512)
I0210 17:00:25.094805 16731 net.cpp:137] Memory required for data: 39405988
I0210 17:00:25.094810 16731 layer_factory.hpp:77] Creating layer feat1
I0210 17:00:25.094815 16731 net.cpp:84] Creating Layer feat1
I0210 17:00:25.094818 16731 net.cpp:406] feat1 <- feat0
I0210 17:00:25.094820 16731 net.cpp:406] feat1 <- filter_ip7
I0210 17:00:25.094825 16731 net.cpp:380] feat1 -> feat1
I0210 17:00:25.095063 16731 net.cpp:122] Setting up feat1
I0210 17:00:25.095067 16731 net.cpp:129] Top shape: 1 1 1 1 (1)
I0210 17:00:25.095069 16731 net.cpp:137] Memory required for data: 39405992
I0210 17:00:25.095077 16731 net.cpp:200] feat1 does not need backward computation.
I0210 17:00:25.095080 16731 net.cpp:200] filter_ip7 does not need backward computation.
I0210 17:00:25.095082 16731 net.cpp:200] relu_feat0 does not need backward computation.
I0210 17:00:25.095084 16731 net.cpp:200] scale_feat0 does not need backward computation.
I0210 17:00:25.095086 16731 net.cpp:200] bn_feat0 does not need backward computation.
I0210 17:00:25.095088 16731 net.cpp:200] feat0 does not need backward computation.
I0210 17:00:25.095090 16731 net.cpp:200] filter_ip6 does not need backward computation.
I0210 17:00:25.095093 16731 net.cpp:200] pool5 does not need backward computation.
I0210 17:00:25.095094 16731 net.cpp:200] relu5 does not need backward computation.
I0210 17:00:25.095096 16731 net.cpp:200] scale_conv5 does not need backward computation.
I0210 17:00:25.095098 16731 net.cpp:200] bn_conv5 does not need backward computation.
I0210 17:00:25.095100 16731 net.cpp:200] conv5 does not need backward computation.
I0210 17:00:25.095103 16731 net.cpp:200] filter_ip5 does not need backward computation.
I0210 17:00:25.095105 16731 net.cpp:200] relu4 does not need backward computation.
I0210 17:00:25.095127 16731 net.cpp:200] scale_conv4 does not need backward computation.
I0210 17:00:25.095129 16731 net.cpp:200] bn_conv4 does not need backward computation.
I0210 17:00:25.095132 16731 net.cpp:200] conv4 does not need backward computation.
I0210 17:00:25.095134 16731 net.cpp:200] filter_ip4 does not need backward computation.
I0210 17:00:25.095136 16731 net.cpp:200] relu3 does not need backward computation.
I0210 17:00:25.095139 16731 net.cpp:200] scale_conv3 does not need backward computation.
I0210 17:00:25.095140 16731 net.cpp:200] bn_conv3 does not need backward computation.
I0210 17:00:25.095142 16731 net.cpp:200] conv3 does not need backward computation.
I0210 17:00:25.095144 16731 net.cpp:200] filter_ip3 does not need backward computation.
I0210 17:00:25.095146 16731 net.cpp:200] pool2 does not need backward computation.
I0210 17:00:25.095149 16731 net.cpp:200] relu2 does not need backward computation.
I0210 17:00:25.095151 16731 net.cpp:200] scale_conv2 does not need backward computation.
I0210 17:00:25.095152 16731 net.cpp:200] bn_conv2 does not need backward computation.
I0210 17:00:25.095155 16731 net.cpp:200] conv2 does not need backward computation.
I0210 17:00:25.095157 16731 net.cpp:200] filter_ip2 does not need backward computation.
I0210 17:00:25.095160 16731 net.cpp:200] pool1 does not need backward computation.
I0210 17:00:25.095161 16731 net.cpp:200] relu1 does not need backward computation.
I0210 17:00:25.095163 16731 net.cpp:200] scale_conv1 does not need backward computation.
I0210 17:00:25.095165 16731 net.cpp:200] bn_conv1 does not need backward computation.
I0210 17:00:25.095167 16731 net.cpp:200] conv1 does not need backward computation.
I0210 17:00:25.095170 16731 net.cpp:200] embedding_fc2_embedding_fc2_0_split does not need backward computation.
I0210 17:00:25.095171 16731 net.cpp:200] embedding_fc2 does not need backward computation.
I0210 17:00:25.095175 16731 net.cpp:200] relu_embedding_fc1 does not need backward computation.
I0210 17:00:25.095176 16731 net.cpp:200] scale_embedding_fc1 does not need backward computation.
I0210 17:00:25.095178 16731 net.cpp:200] bn_embedding_fc1 does not need backward computation.
I0210 17:00:25.095180 16731 net.cpp:200] embedding_fc1 does not need backward computation.
I0210 17:00:25.095182 16731 net.cpp:200] input does not need backward computation.
I0210 17:00:25.095185 16731 net.cpp:242] This network produces output feat1
I0210 17:00:25.095198 16731 net.cpp:255] Network initialization done.
I0210 17:00:25.130576 16731 upgrade_proto.cpp:77] Attempting to upgrade batch norm layers using deprecated params: ./snapshot/1/alex-ignet-embed_iter_10000.caffemodel
I0210 17:00:25.130596 16731 upgrade_proto.cpp:80] Successfully upgraded batch norm layers using deprecated params.
I0210 17:00:25.130599 16731 net.cpp:744] Ignoring source layer data
I0210 17:00:25.196769 16731 net.cpp:744] Ignoring source layer eucli_loss
I0210 17:00:41.369413 16731 solver.cpp:397]     Test net output #0: accuracy = 0.852163
I0210 17:00:41.369555 16731 solver.cpp:397]     Test net output #1: mae = 0.397775
I0210 17:00:41.369563 16731 solver.cpp:397]     Test net output #2: rmse = 0.494322
I0210 17:00:41.512311 16731 solver.cpp:218] Iteration 10000 (3.16793 iter/s, 31.5664s/100 iters), loss = 0.0289524
I0210 17:00:41.512346 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0289525 (* 1 = 0.0289525 loss)
I0210 17:00:41.512353 16731 sgd_solver.cpp:114] Iteration 10000, lr = 0.00555556
I0210 17:00:55.687952 16731 solver.cpp:218] Iteration 10100 (7.05468 iter/s, 14.175s/100 iters), loss = 0.0558173
I0210 17:00:55.688004 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0558174 (* 1 = 0.0558174 loss)
I0210 17:00:55.688011 16731 sgd_solver.cpp:114] Iteration 10100, lr = 0.0055
I0210 17:01:09.849062 16731 solver.cpp:218] Iteration 10200 (7.06193 iter/s, 14.1604s/100 iters), loss = 0.0388831
I0210 17:01:09.849092 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0388832 (* 1 = 0.0388832 loss)
I0210 17:01:09.849098 16731 sgd_solver.cpp:114] Iteration 10200, lr = 0.00544444
I0210 17:01:24.175659 16731 solver.cpp:218] Iteration 10300 (6.98034 iter/s, 14.3259s/100 iters), loss = 0.0418535
I0210 17:01:24.175794 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0418536 (* 1 = 0.0418536 loss)
I0210 17:01:24.175806 16731 sgd_solver.cpp:114] Iteration 10300, lr = 0.00538889
I0210 17:01:38.505396 16731 solver.cpp:218] Iteration 10400 (6.97886 iter/s, 14.329s/100 iters), loss = 0.0229967
I0210 17:01:38.505431 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0229968 (* 1 = 0.0229968 loss)
I0210 17:01:38.505439 16731 sgd_solver.cpp:114] Iteration 10400, lr = 0.00533333
I0210 17:01:52.881984 16731 solver.cpp:218] Iteration 10500 (6.95614 iter/s, 14.3758s/100 iters), loss = 0.0329377
I0210 17:01:52.882086 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0329378 (* 1 = 0.0329378 loss)
I0210 17:01:52.882097 16731 sgd_solver.cpp:114] Iteration 10500, lr = 0.00527778
I0210 17:02:07.158432 16731 solver.cpp:218] Iteration 10600 (7.00489 iter/s, 14.2757s/100 iters), loss = 0.0288693
I0210 17:02:07.158561 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0288694 (* 1 = 0.0288694 loss)
I0210 17:02:07.158571 16731 sgd_solver.cpp:114] Iteration 10600, lr = 0.00522222
I0210 17:02:21.413066 16731 solver.cpp:218] Iteration 10700 (7.01562 iter/s, 14.2539s/100 iters), loss = 0.0346086
I0210 17:02:21.413096 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0346087 (* 1 = 0.0346087 loss)
I0210 17:02:21.413102 16731 sgd_solver.cpp:114] Iteration 10700, lr = 0.00516667
I0210 17:02:35.734827 16731 solver.cpp:218] Iteration 10800 (6.98269 iter/s, 14.3211s/100 iters), loss = 0.0256844
I0210 17:02:35.734876 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0256845 (* 1 = 0.0256845 loss)
I0210 17:02:35.734885 16731 sgd_solver.cpp:114] Iteration 10800, lr = 0.00511111
I0210 17:02:50.073351 16731 solver.cpp:218] Iteration 10900 (6.97454 iter/s, 14.3379s/100 iters), loss = 0.0586723
I0210 17:02:50.074316 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0586724 (* 1 = 0.0586724 loss)
I0210 17:02:50.074329 16731 sgd_solver.cpp:114] Iteration 10900, lr = 0.00505556
I0210 17:03:04.403445 16731 solver.cpp:218] Iteration 11000 (6.9791 iter/s, 14.3285s/100 iters), loss = 0.0246192
I0210 17:03:04.403477 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0246193 (* 1 = 0.0246193 loss)
I0210 17:03:04.403483 16731 sgd_solver.cpp:114] Iteration 11000, lr = 0.005
I0210 17:03:18.632480 16731 solver.cpp:218] Iteration 11100 (7.02819 iter/s, 14.2284s/100 iters), loss = 0.0344422
I0210 17:03:18.632525 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0344423 (* 1 = 0.0344423 loss)
I0210 17:03:18.632534 16731 sgd_solver.cpp:114] Iteration 11100, lr = 0.00494444
I0210 17:03:32.877804 16731 solver.cpp:218] Iteration 11200 (7.02016 iter/s, 14.2447s/100 iters), loss = 0.0653025
I0210 17:03:32.877956 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0653026 (* 1 = 0.0653026 loss)
I0210 17:03:32.877964 16731 sgd_solver.cpp:114] Iteration 11200, lr = 0.00488889
I0210 17:03:47.130215 16731 solver.cpp:218] Iteration 11300 (7.01672 iter/s, 14.2517s/100 iters), loss = 0.0227047
I0210 17:03:47.130247 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0227048 (* 1 = 0.0227048 loss)
I0210 17:03:47.130254 16731 sgd_solver.cpp:114] Iteration 11300, lr = 0.00483333
I0210 17:04:01.400108 16731 solver.cpp:218] Iteration 11400 (7.00807 iter/s, 14.2693s/100 iters), loss = 0.0222423
I0210 17:04:01.400152 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0222424 (* 1 = 0.0222424 loss)
I0210 17:04:01.400161 16731 sgd_solver.cpp:114] Iteration 11400, lr = 0.00477778
I0210 17:04:15.685022 16731 solver.cpp:218] Iteration 11500 (7.0007 iter/s, 14.2843s/100 iters), loss = 0.033641
I0210 17:04:15.685143 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0336411 (* 1 = 0.0336411 loss)
I0210 17:04:15.685153 16731 sgd_solver.cpp:114] Iteration 11500, lr = 0.00472222
I0210 17:04:29.942651 16731 solver.cpp:218] Iteration 11600 (7.01414 iter/s, 14.2569s/100 iters), loss = 0.0231071
I0210 17:04:29.942693 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0231072 (* 1 = 0.0231072 loss)
I0210 17:04:29.942700 16731 sgd_solver.cpp:114] Iteration 11600, lr = 0.00466667
I0210 17:04:44.199904 16731 solver.cpp:218] Iteration 11700 (7.01433 iter/s, 14.2565s/100 iters), loss = 0.0177196
I0210 17:04:44.199939 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0177197 (* 1 = 0.0177197 loss)
I0210 17:04:44.199945 16731 sgd_solver.cpp:114] Iteration 11700, lr = 0.00461111
I0210 17:04:58.452632 16731 solver.cpp:218] Iteration 11800 (7.0165 iter/s, 14.2521s/100 iters), loss = 0.0290971
I0210 17:04:58.452805 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0290972 (* 1 = 0.0290972 loss)
I0210 17:04:58.452816 16731 sgd_solver.cpp:114] Iteration 11800, lr = 0.00455556
I0210 17:05:12.725591 16731 solver.cpp:218] Iteration 11900 (7.00662 iter/s, 14.2722s/100 iters), loss = 0.0159226
I0210 17:05:12.725620 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0159227 (* 1 = 0.0159227 loss)
I0210 17:05:12.725628 16731 sgd_solver.cpp:114] Iteration 11900, lr = 0.0045
I0210 17:05:26.979677 16731 solver.cpp:218] Iteration 12000 (7.01583 iter/s, 14.2535s/100 iters), loss = 0.0269777
I0210 17:05:26.979707 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0269779 (* 1 = 0.0269779 loss)
I0210 17:05:26.979713 16731 sgd_solver.cpp:114] Iteration 12000, lr = 0.00444444
I0210 17:05:41.253506 16731 solver.cpp:218] Iteration 12100 (7.00612 iter/s, 14.2732s/100 iters), loss = 0.0394085
I0210 17:05:41.253679 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0394086 (* 1 = 0.0394086 loss)
I0210 17:05:41.253690 16731 sgd_solver.cpp:114] Iteration 12100, lr = 0.00438889
I0210 17:05:55.517392 16731 solver.cpp:218] Iteration 12200 (7.01107 iter/s, 14.2632s/100 iters), loss = 0.0238302
I0210 17:05:55.517438 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0238303 (* 1 = 0.0238303 loss)
I0210 17:05:55.517447 16731 sgd_solver.cpp:114] Iteration 12200, lr = 0.00433333
I0210 17:06:09.807456 16731 solver.cpp:218] Iteration 12300 (6.99817 iter/s, 14.2894s/100 iters), loss = 0.0456624
I0210 17:06:09.807487 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0456625 (* 1 = 0.0456625 loss)
I0210 17:06:09.807492 16731 sgd_solver.cpp:114] Iteration 12300, lr = 0.00427778
I0210 17:06:24.082948 16731 solver.cpp:218] Iteration 12400 (7.0053 iter/s, 14.2749s/100 iters), loss = 0.0250803
I0210 17:06:24.083065 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0250804 (* 1 = 0.0250804 loss)
I0210 17:06:24.083072 16731 sgd_solver.cpp:114] Iteration 12400, lr = 0.00422222
I0210 17:06:38.378710 16731 solver.cpp:218] Iteration 12500 (6.99541 iter/s, 14.2951s/100 iters), loss = 0.0270413
I0210 17:06:38.378737 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0270414 (* 1 = 0.0270414 loss)
I0210 17:06:38.378743 16731 sgd_solver.cpp:114] Iteration 12500, lr = 0.00416667
I0210 17:06:52.652187 16731 solver.cpp:218] Iteration 12600 (7.00629 iter/s, 14.2729s/100 iters), loss = 0.0292012
I0210 17:06:52.652235 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0292013 (* 1 = 0.0292013 loss)
I0210 17:06:52.652242 16731 sgd_solver.cpp:114] Iteration 12600, lr = 0.00411111
I0210 17:07:06.904613 16731 solver.cpp:218] Iteration 12700 (7.01665 iter/s, 14.2518s/100 iters), loss = 0.0142719
I0210 17:07:06.904718 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.014272 (* 1 = 0.014272 loss)
I0210 17:07:06.904726 16731 sgd_solver.cpp:114] Iteration 12700, lr = 0.00405556
I0210 17:07:21.236289 16731 solver.cpp:218] Iteration 12800 (6.97787 iter/s, 14.331s/100 iters), loss = 0.0194833
I0210 17:07:21.236317 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0194834 (* 1 = 0.0194834 loss)
I0210 17:07:21.236323 16731 sgd_solver.cpp:114] Iteration 12800, lr = 0.004
I0210 17:07:35.528246 16731 solver.cpp:218] Iteration 12900 (6.99723 iter/s, 14.2914s/100 iters), loss = 0.03145
I0210 17:07:35.528295 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0314501 (* 1 = 0.0314501 loss)
I0210 17:07:35.528303 16731 sgd_solver.cpp:114] Iteration 12900, lr = 0.00394444
I0210 17:07:49.905391 16731 solver.cpp:218] Iteration 13000 (6.95578 iter/s, 14.3765s/100 iters), loss = 0.0300403
I0210 17:07:49.905514 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0300404 (* 1 = 0.0300404 loss)
I0210 17:07:49.905536 16731 sgd_solver.cpp:114] Iteration 13000, lr = 0.00388889
I0210 17:08:04.248476 16731 solver.cpp:218] Iteration 13100 (6.97235 iter/s, 14.3424s/100 iters), loss = 0.0221492
I0210 17:08:04.248522 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0221493 (* 1 = 0.0221493 loss)
I0210 17:08:04.248531 16731 sgd_solver.cpp:114] Iteration 13100, lr = 0.00383333
I0210 17:08:18.586000 16731 solver.cpp:218] Iteration 13200 (6.975 iter/s, 14.3369s/100 iters), loss = 0.0236843
I0210 17:08:18.586051 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0236844 (* 1 = 0.0236844 loss)
I0210 17:08:18.586060 16731 sgd_solver.cpp:114] Iteration 13200, lr = 0.00377778
I0210 17:08:32.909116 16731 solver.cpp:218] Iteration 13300 (6.98211 iter/s, 14.3223s/100 iters), loss = 0.0792066
I0210 17:08:32.909248 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0792067 (* 1 = 0.0792067 loss)
I0210 17:08:32.909257 16731 sgd_solver.cpp:114] Iteration 13300, lr = 0.00372222
I0210 17:08:47.228364 16731 solver.cpp:218] Iteration 13400 (6.98394 iter/s, 14.3186s/100 iters), loss = 0.0309975
I0210 17:08:47.228410 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0309976 (* 1 = 0.0309976 loss)
I0210 17:08:47.228418 16731 sgd_solver.cpp:114] Iteration 13400, lr = 0.00366667
I0210 17:09:01.586860 16731 solver.cpp:218] Iteration 13500 (6.96481 iter/s, 14.3579s/100 iters), loss = 0.0294131
I0210 17:09:01.586905 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0294132 (* 1 = 0.0294132 loss)
I0210 17:09:01.586912 16731 sgd_solver.cpp:114] Iteration 13500, lr = 0.00361111
I0210 17:09:15.893913 16731 solver.cpp:218] Iteration 13600 (6.9899 iter/s, 14.3063s/100 iters), loss = 0.0252856
I0210 17:09:15.894021 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0252857 (* 1 = 0.0252857 loss)
I0210 17:09:15.894028 16731 sgd_solver.cpp:114] Iteration 13600, lr = 0.00355556
I0210 17:09:30.151469 16731 solver.cpp:218] Iteration 13700 (7.01415 iter/s, 14.2569s/100 iters), loss = 0.0219938
I0210 17:09:30.151518 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0219939 (* 1 = 0.0219939 loss)
I0210 17:09:30.151527 16731 sgd_solver.cpp:114] Iteration 13700, lr = 0.0035
I0210 17:09:44.472983 16731 solver.cpp:218] Iteration 13800 (6.9828 iter/s, 14.3209s/100 iters), loss = 0.0519657
I0210 17:09:44.473018 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0519658 (* 1 = 0.0519658 loss)
I0210 17:09:44.473026 16731 sgd_solver.cpp:114] Iteration 13800, lr = 0.00344444
I0210 17:09:58.763852 16731 solver.cpp:218] Iteration 13900 (6.99776 iter/s, 14.2903s/100 iters), loss = 0.0174932
I0210 17:09:58.763996 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0174933 (* 1 = 0.0174933 loss)
I0210 17:09:58.764019 16731 sgd_solver.cpp:114] Iteration 13900, lr = 0.00338889
I0210 17:10:13.051069 16731 solver.cpp:218] Iteration 14000 (6.99961 iter/s, 14.2865s/100 iters), loss = 0.00836576
I0210 17:10:13.051096 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.00836586 (* 1 = 0.00836586 loss)
I0210 17:10:13.051102 16731 sgd_solver.cpp:114] Iteration 14000, lr = 0.00333333
I0210 17:10:27.297667 16731 solver.cpp:218] Iteration 14100 (7.0195 iter/s, 14.246s/100 iters), loss = 0.0239045
I0210 17:10:27.297695 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0239046 (* 1 = 0.0239046 loss)
I0210 17:10:27.297703 16731 sgd_solver.cpp:114] Iteration 14100, lr = 0.00327778
I0210 17:10:41.552906 16731 solver.cpp:218] Iteration 14200 (7.01525 iter/s, 14.2547s/100 iters), loss = 0.0286327
I0210 17:10:41.553033 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0286328 (* 1 = 0.0286328 loss)
I0210 17:10:41.553042 16731 sgd_solver.cpp:114] Iteration 14200, lr = 0.00322222
I0210 17:10:55.850494 16731 solver.cpp:218] Iteration 14300 (6.99451 iter/s, 14.2969s/100 iters), loss = 0.0145009
I0210 17:10:55.850523 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.014501 (* 1 = 0.014501 loss)
I0210 17:10:55.850529 16731 sgd_solver.cpp:114] Iteration 14300, lr = 0.00316667
I0210 17:11:10.112476 16731 solver.cpp:218] Iteration 14400 (7.01193 iter/s, 14.2614s/100 iters), loss = 0.0320468
I0210 17:11:10.112515 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0320469 (* 1 = 0.0320469 loss)
I0210 17:11:10.112522 16731 sgd_solver.cpp:114] Iteration 14400, lr = 0.00311111
I0210 17:11:24.371549 16731 solver.cpp:218] Iteration 14500 (7.01336 iter/s, 14.2585s/100 iters), loss = 0.0213655
I0210 17:11:24.371655 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0213656 (* 1 = 0.0213656 loss)
I0210 17:11:24.371665 16731 sgd_solver.cpp:114] Iteration 14500, lr = 0.00305556
I0210 17:11:38.633721 16731 solver.cpp:218] Iteration 14600 (7.01187 iter/s, 14.2615s/100 iters), loss = 0.0232998
I0210 17:11:38.633770 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0232999 (* 1 = 0.0232999 loss)
I0210 17:11:38.633780 16731 sgd_solver.cpp:114] Iteration 14600, lr = 0.003
I0210 17:11:52.884413 16731 solver.cpp:218] Iteration 14700 (7.01749 iter/s, 14.2501s/100 iters), loss = 0.0152048
I0210 17:11:52.884440 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0152049 (* 1 = 0.0152049 loss)
I0210 17:11:52.884446 16731 sgd_solver.cpp:114] Iteration 14700, lr = 0.00294444
I0210 17:12:07.166611 16731 solver.cpp:218] Iteration 14800 (7.002 iter/s, 14.2816s/100 iters), loss = 0.0187929
I0210 17:12:07.166761 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.018793 (* 1 = 0.018793 loss)
I0210 17:12:07.166790 16731 sgd_solver.cpp:114] Iteration 14800, lr = 0.00288889
I0210 17:12:21.430954 16731 solver.cpp:218] Iteration 14900 (7.01083 iter/s, 14.2637s/100 iters), loss = 0.0307433
I0210 17:12:21.431000 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0307434 (* 1 = 0.0307434 loss)
I0210 17:12:21.431010 16731 sgd_solver.cpp:114] Iteration 14900, lr = 0.00283333
I0210 17:12:35.546638 16731 solver.cpp:447] Snapshotting to binary proto file ./snapshot/1/alex-ignet-embed_iter_15000.caffemodel
I0210 17:12:35.815217 16731 sgd_solver.cpp:282] Snapshotting solver state to binary proto file ./snapshot/1/alex-ignet-embed_iter_15000.solverstate
I0210 17:12:36.285521 16731 solver.cpp:330] Iteration 15000, Testing net (#0)
I0210 17:12:36.285580 16731 net.cpp:676] Ignoring source layer data
I0210 17:12:36.285594 16731 net.cpp:676] Ignoring source layer embedding_fc1
I0210 17:12:36.285606 16731 net.cpp:676] Ignoring source layer bn_embedding_fc1
I0210 17:12:36.285624 16731 net.cpp:676] Ignoring source layer scale_embedding_fc1
I0210 17:12:36.285637 16731 net.cpp:676] Ignoring source layer relu_embedding_fc1
I0210 17:12:36.285651 16731 net.cpp:676] Ignoring source layer embedding_fc2
I0210 17:12:36.285665 16731 net.cpp:676] Ignoring source layer embedding_fc2_embedding_fc2_0_split
I0210 17:12:36.285682 16731 net.cpp:676] Ignoring source layer conv1
I0210 17:12:36.285696 16731 net.cpp:676] Ignoring source layer bn_conv1
I0210 17:12:36.285709 16731 net.cpp:676] Ignoring source layer scale_conv1
I0210 17:12:36.285722 16731 net.cpp:676] Ignoring source layer relu1
I0210 17:12:36.285738 16731 net.cpp:676] Ignoring source layer pool1
I0210 17:12:36.285751 16731 net.cpp:676] Ignoring source layer filter_ip2
I0210 17:12:36.285764 16731 net.cpp:676] Ignoring source layer conv2
I0210 17:12:36.285778 16731 net.cpp:676] Ignoring source layer bn_conv2
I0210 17:12:36.285792 16731 net.cpp:676] Ignoring source layer scale_conv2
I0210 17:12:36.285806 16731 net.cpp:676] Ignoring source layer relu2
I0210 17:12:36.285820 16731 net.cpp:676] Ignoring source layer pool2
I0210 17:12:36.285831 16731 net.cpp:676] Ignoring source layer filter_ip3
I0210 17:12:36.285848 16731 net.cpp:676] Ignoring source layer conv3
I0210 17:12:36.285861 16731 net.cpp:676] Ignoring source layer bn_conv3
I0210 17:12:36.285872 16731 net.cpp:676] Ignoring source layer scale_conv3
I0210 17:12:36.285887 16731 net.cpp:676] Ignoring source layer relu3
I0210 17:12:36.285902 16731 net.cpp:676] Ignoring source layer filter_ip4
I0210 17:12:36.285912 16731 net.cpp:676] Ignoring source layer conv4
I0210 17:12:36.285926 16731 net.cpp:676] Ignoring source layer bn_conv4
I0210 17:12:36.285939 16731 net.cpp:676] Ignoring source layer scale_conv4
I0210 17:12:36.285957 16731 net.cpp:676] Ignoring source layer relu4
I0210 17:12:36.285970 16731 net.cpp:676] Ignoring source layer filter_ip5
I0210 17:12:36.285984 16731 net.cpp:676] Ignoring source layer conv5
I0210 17:12:36.285997 16731 net.cpp:676] Ignoring source layer bn_conv5
I0210 17:12:36.286032 16731 net.cpp:676] Ignoring source layer scale_conv5
I0210 17:12:36.286047 16731 net.cpp:676] Ignoring source layer relu5
I0210 17:12:36.286061 16731 net.cpp:676] Ignoring source layer pool5
I0210 17:12:36.286073 16731 net.cpp:676] Ignoring source layer filter_ip6
I0210 17:12:36.286088 16731 net.cpp:676] Ignoring source layer feat0
I0210 17:12:36.286103 16731 net.cpp:676] Ignoring source layer bn_feat0
I0210 17:12:36.286114 16731 net.cpp:676] Ignoring source layer scale_feat0
I0210 17:12:36.286128 16731 net.cpp:676] Ignoring source layer relu_feat0
I0210 17:12:36.286144 16731 net.cpp:676] Ignoring source layer filter_ip7
I0210 17:12:36.286159 16731 net.cpp:676] Ignoring source layer feat1
I0210 17:12:36.286172 16731 net.cpp:676] Ignoring source layer eucli_loss
W0210 17:12:36.546286 16731 _caffe.cpp:139] DEPRECATION WARNING - deprecated use of Python interface
W0210 17:12:36.546316 16731 _caffe.cpp:140] Use this instead (with the named "weights" parameter):
W0210 17:12:36.546332 16731 _caffe.cpp:142] Net('./alexnet-deploy-ignet-embed.prototxt', 1, weights='./snapshot/1/alex-ignet-embed_iter_15000.caffemodel')
I0210 17:12:36.546545 16731 upgrade_proto.cpp:67] Attempting to upgrade input file specified using deprecated input fields: ./alexnet-deploy-ignet-embed.prototxt
I0210 17:12:36.546553 16731 upgrade_proto.cpp:70] Successfully upgraded file specified using deprecated input fields.
W0210 17:12:36.546555 16731 upgrade_proto.cpp:72] Note that future Caffe releases will only support input layers and not input fields.
I0210 17:12:36.546748 16731 net.cpp:51] Initializing net from parameters: 
name: "AlexNet-ignet"
state {
  phase: TEST
  level: 0
}
layer {
  name: "input"
  type: "Input"
  top: "data"
  top: "extra"
  input_param {
    shape {
      dim: 1
      dim: 3
      dim: 224
      dim: 224
    }
    shape {
      dim: 1
      dim: 2
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding_fc1"
  type: "InnerProduct"
  bottom: "extra"
  top: "embedding_fc1"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 256
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "bn_embedding_fc1"
  type: "BatchNorm"
  bottom: "embedding_fc1"
  top: "embedding_fc1"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_embedding_fc1"
  type: "Scale"
  bottom: "embedding_fc1"
  top: "embedding_fc1"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu_embedding_fc1"
  type: "ReLU"
  bottom: "embedding_fc1"
  top: "embedding_fc1"
}
layer {
  name: "embedding_fc2"
  type: "InnerProduct"
  bottom: "embedding_fc1"
  top: "embedding_fc2"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 1
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  param {
    name: "conv1_w"
    lr_mult: 1
    decay_mult: 1
  }
  param {
    name: "conv1_b"
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
  }
}
layer {
  name: "bn_conv1"
  type: "BatchNorm"
  bottom: "conv1"
  top: "conv1"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_conv1"
  type: "Scale"
  bottom: "conv1"
  top: "conv1"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "filter_ip2"
  type: "InnerProduct"
  bottom: "embedding_fc2"
  top: "filter_ip2"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 307200
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "pool1"
  bottom: "filter_ip2"
  top: "conv2"
  param {
    name: "conv2_w"
    lr_mult: 1
    decay_mult: 1
  }
  param {
    name: "conv2_b"
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
    weight_operation: COPY
  }
}
layer {
  name: "bn_conv2"
  type: "BatchNorm"
  bottom: "conv2"
  top: "conv2"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_conv2"
  type: "Scale"
  bottom: "conv2"
  top: "conv2"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "filter_ip3"
  type: "InnerProduct"
  bottom: "embedding_fc2"
  top: "filter_ip3"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 884736
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "pool2"
  bottom: "filter_ip3"
  top: "conv3"
  param {
    name: "conv3_w"
    lr_mult: 1
    decay_mult: 1
  }
  param {
    name: "conv3_b"
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
    weight_operation: COPY
  }
}
layer {
  name: "bn_conv3"
  type: "BatchNorm"
  bottom: "conv3"
  top: "conv3"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_conv3"
  type: "Scale"
  bottom: "conv3"
  top: "conv3"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "filter_ip4"
  type: "InnerProduct"
  bottom: "embedding_fc2"
  top: "filter_ip4"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 663552
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  bottom: "filter_ip4"
  top: "conv4"
  param {
    name: "conv4_w"
    lr_mult: 1
    decay_mult: 1
  }
  param {
    name: "conv4_b"
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
    weight_operation: COPY
  }
}
layer {
  name: "bn_conv4"
  type: "BatchNorm"
  bottom: "conv4"
  top: "conv4"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_conv4"
  type: "Scale"
  bottom: "conv4"
  top: "conv4"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "filter_ip5"
  type: "InnerProduct"
  bottom: "embedding_fc2"
  top: "filter_ip5"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 442368
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  bottom: "filter_ip5"
  top: "conv5"
  param {
    name: "conv5_w"
    lr_mult: 1
    decay_mult: 1
  }
  param {
    name: "conv5_b"
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
    weight_operation: COPY
  }
}
layer {
  name: "bn_conv5"
  type: "BatchNorm"
  bottom: "conv5"
  top: "conv5"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_conv5"
  type: "Scale"
  bottom: "conv5"
  top: "conv5"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "filter_ip6"
  type: "InnerProduct"
  bottom: "embedding_fc2"
  top: "filter_ip6"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 4718592
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "feat0"
  type: "Convolution"
  bottom: "pool5"
  bottom: "filter_ip6"
  top: "feat0"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 512
    kernel_size: 6
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
    weight_operation: COPY
  }
}
layer {
  name: "bn_feat0"
  type: "BatchNorm"
  bottom: "feat0"
  top: "feat0"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_feat0"
  type: "Scale"
  bottom: "feat0"
  top: "feat0"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu_feat0"
  type: "ReLU"
  bottom: "feat0"
  top: "feat0"
}
layer {
  name: "filter_ip7"
  type: "InnerProduct"
  bottom: "embedding_fc2"
  top: "filter_ip7"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 512
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "feat1"
  type: "Convolution"
  bottom: "feat0"
  bottom: "filter_ip7"
  top: "feat1"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 1
    kernel_size: 1
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
    weight_operation: COPY
  }
}
I0210 17:12:36.546846 16731 layer_factory.hpp:77] Creating layer input
I0210 17:12:36.546854 16731 net.cpp:84] Creating Layer input
I0210 17:12:36.546857 16731 net.cpp:380] input -> data
I0210 17:12:36.546864 16731 net.cpp:380] input -> extra
I0210 17:12:36.546979 16731 net.cpp:122] Setting up input
I0210 17:12:36.546983 16731 net.cpp:129] Top shape: 1 3 224 224 (150528)
I0210 17:12:36.546986 16731 net.cpp:129] Top shape: 1 2 1 1 (2)
I0210 17:12:36.546988 16731 net.cpp:137] Memory required for data: 602120
I0210 17:12:36.546990 16731 layer_factory.hpp:77] Creating layer embedding_fc1
I0210 17:12:36.546994 16731 net.cpp:84] Creating Layer embedding_fc1
I0210 17:12:36.546996 16731 net.cpp:406] embedding_fc1 <- extra
I0210 17:12:36.547000 16731 net.cpp:380] embedding_fc1 -> embedding_fc1
I0210 17:12:36.547103 16731 net.cpp:122] Setting up embedding_fc1
I0210 17:12:36.547106 16731 net.cpp:129] Top shape: 1 256 (256)
I0210 17:12:36.547108 16731 net.cpp:137] Memory required for data: 603144
I0210 17:12:36.547114 16731 layer_factory.hpp:77] Creating layer bn_embedding_fc1
I0210 17:12:36.547118 16731 net.cpp:84] Creating Layer bn_embedding_fc1
I0210 17:12:36.547121 16731 net.cpp:406] bn_embedding_fc1 <- embedding_fc1
I0210 17:12:36.547124 16731 net.cpp:367] bn_embedding_fc1 -> embedding_fc1 (in-place)
I0210 17:12:36.547283 16731 net.cpp:122] Setting up bn_embedding_fc1
I0210 17:12:36.547287 16731 net.cpp:129] Top shape: 1 256 (256)
I0210 17:12:36.547288 16731 net.cpp:137] Memory required for data: 604168
I0210 17:12:36.547294 16731 layer_factory.hpp:77] Creating layer scale_embedding_fc1
I0210 17:12:36.547298 16731 net.cpp:84] Creating Layer scale_embedding_fc1
I0210 17:12:36.547300 16731 net.cpp:406] scale_embedding_fc1 <- embedding_fc1
I0210 17:12:36.547303 16731 net.cpp:367] scale_embedding_fc1 -> embedding_fc1 (in-place)
I0210 17:12:36.547333 16731 layer_factory.hpp:77] Creating layer scale_embedding_fc1
I0210 17:12:36.547423 16731 net.cpp:122] Setting up scale_embedding_fc1
I0210 17:12:36.547427 16731 net.cpp:129] Top shape: 1 256 (256)
I0210 17:12:36.547430 16731 net.cpp:137] Memory required for data: 605192
I0210 17:12:36.547432 16731 layer_factory.hpp:77] Creating layer relu_embedding_fc1
I0210 17:12:36.547436 16731 net.cpp:84] Creating Layer relu_embedding_fc1
I0210 17:12:36.547438 16731 net.cpp:406] relu_embedding_fc1 <- embedding_fc1
I0210 17:12:36.547449 16731 net.cpp:367] relu_embedding_fc1 -> embedding_fc1 (in-place)
I0210 17:12:36.547729 16731 net.cpp:122] Setting up relu_embedding_fc1
I0210 17:12:36.547734 16731 net.cpp:129] Top shape: 1 256 (256)
I0210 17:12:36.547736 16731 net.cpp:137] Memory required for data: 606216
I0210 17:12:36.547739 16731 layer_factory.hpp:77] Creating layer embedding_fc2
I0210 17:12:36.547742 16731 net.cpp:84] Creating Layer embedding_fc2
I0210 17:12:36.547744 16731 net.cpp:406] embedding_fc2 <- embedding_fc1
I0210 17:12:36.547747 16731 net.cpp:380] embedding_fc2 -> embedding_fc2
I0210 17:12:36.547837 16731 net.cpp:122] Setting up embedding_fc2
I0210 17:12:36.547842 16731 net.cpp:129] Top shape: 1 1 (1)
I0210 17:12:36.547842 16731 net.cpp:137] Memory required for data: 606220
I0210 17:12:36.547847 16731 layer_factory.hpp:77] Creating layer embedding_fc2_embedding_fc2_0_split
I0210 17:12:36.547850 16731 net.cpp:84] Creating Layer embedding_fc2_embedding_fc2_0_split
I0210 17:12:36.547853 16731 net.cpp:406] embedding_fc2_embedding_fc2_0_split <- embedding_fc2
I0210 17:12:36.547857 16731 net.cpp:380] embedding_fc2_embedding_fc2_0_split -> embedding_fc2_embedding_fc2_0_split_0
I0210 17:12:36.547861 16731 net.cpp:380] embedding_fc2_embedding_fc2_0_split -> embedding_fc2_embedding_fc2_0_split_1
I0210 17:12:36.547865 16731 net.cpp:380] embedding_fc2_embedding_fc2_0_split -> embedding_fc2_embedding_fc2_0_split_2
I0210 17:12:36.547869 16731 net.cpp:380] embedding_fc2_embedding_fc2_0_split -> embedding_fc2_embedding_fc2_0_split_3
I0210 17:12:36.547873 16731 net.cpp:380] embedding_fc2_embedding_fc2_0_split -> embedding_fc2_embedding_fc2_0_split_4
I0210 17:12:36.547876 16731 net.cpp:380] embedding_fc2_embedding_fc2_0_split -> embedding_fc2_embedding_fc2_0_split_5
I0210 17:12:36.547945 16731 net.cpp:122] Setting up embedding_fc2_embedding_fc2_0_split
I0210 17:12:36.547950 16731 net.cpp:129] Top shape: 1 1 (1)
I0210 17:12:36.547951 16731 net.cpp:129] Top shape: 1 1 (1)
I0210 17:12:36.547953 16731 net.cpp:129] Top shape: 1 1 (1)
I0210 17:12:36.547955 16731 net.cpp:129] Top shape: 1 1 (1)
I0210 17:12:36.547958 16731 net.cpp:129] Top shape: 1 1 (1)
I0210 17:12:36.547960 16731 net.cpp:129] Top shape: 1 1 (1)
I0210 17:12:36.547961 16731 net.cpp:137] Memory required for data: 606244
I0210 17:12:36.547963 16731 layer_factory.hpp:77] Creating layer conv1
I0210 17:12:36.547969 16731 net.cpp:84] Creating Layer conv1
I0210 17:12:36.547971 16731 net.cpp:406] conv1 <- data
I0210 17:12:36.547974 16731 net.cpp:380] conv1 -> conv1
I0210 17:12:36.548446 16731 net.cpp:122] Setting up conv1
I0210 17:12:36.548451 16731 net.cpp:129] Top shape: 1 96 54 54 (279936)
I0210 17:12:36.548454 16731 net.cpp:137] Memory required for data: 1725988
I0210 17:12:36.548456 16731 layer_factory.hpp:77] Creating layer bn_conv1
I0210 17:12:36.548460 16731 net.cpp:84] Creating Layer bn_conv1
I0210 17:12:36.548463 16731 net.cpp:406] bn_conv1 <- conv1
I0210 17:12:36.548465 16731 net.cpp:367] bn_conv1 -> conv1 (in-place)
I0210 17:12:36.548669 16731 net.cpp:122] Setting up bn_conv1
I0210 17:12:36.548672 16731 net.cpp:129] Top shape: 1 96 54 54 (279936)
I0210 17:12:36.548674 16731 net.cpp:137] Memory required for data: 2845732
I0210 17:12:36.548678 16731 layer_factory.hpp:77] Creating layer scale_conv1
I0210 17:12:36.548682 16731 net.cpp:84] Creating Layer scale_conv1
I0210 17:12:36.548684 16731 net.cpp:406] scale_conv1 <- conv1
I0210 17:12:36.548687 16731 net.cpp:367] scale_conv1 -> conv1 (in-place)
I0210 17:12:36.548718 16731 layer_factory.hpp:77] Creating layer scale_conv1
I0210 17:12:36.548816 16731 net.cpp:122] Setting up scale_conv1
I0210 17:12:36.548820 16731 net.cpp:129] Top shape: 1 96 54 54 (279936)
I0210 17:12:36.548822 16731 net.cpp:137] Memory required for data: 3965476
I0210 17:12:36.548825 16731 layer_factory.hpp:77] Creating layer relu1
I0210 17:12:36.548830 16731 net.cpp:84] Creating Layer relu1
I0210 17:12:36.548831 16731 net.cpp:406] relu1 <- conv1
I0210 17:12:36.548835 16731 net.cpp:367] relu1 -> conv1 (in-place)
I0210 17:12:36.549039 16731 net.cpp:122] Setting up relu1
I0210 17:12:36.549044 16731 net.cpp:129] Top shape: 1 96 54 54 (279936)
I0210 17:12:36.549046 16731 net.cpp:137] Memory required for data: 5085220
I0210 17:12:36.549048 16731 layer_factory.hpp:77] Creating layer pool1
I0210 17:12:36.549052 16731 net.cpp:84] Creating Layer pool1
I0210 17:12:36.549054 16731 net.cpp:406] pool1 <- conv1
I0210 17:12:36.549057 16731 net.cpp:380] pool1 -> pool1
I0210 17:12:36.549093 16731 net.cpp:122] Setting up pool1
I0210 17:12:36.549096 16731 net.cpp:129] Top shape: 1 96 27 27 (69984)
I0210 17:12:36.549098 16731 net.cpp:137] Memory required for data: 5365156
I0210 17:12:36.549099 16731 layer_factory.hpp:77] Creating layer filter_ip2
I0210 17:12:36.549103 16731 net.cpp:84] Creating Layer filter_ip2
I0210 17:12:36.549105 16731 net.cpp:406] filter_ip2 <- embedding_fc2_embedding_fc2_0_split_0
I0210 17:12:36.549108 16731 net.cpp:380] filter_ip2 -> filter_ip2
I0210 17:12:36.552230 16731 net.cpp:122] Setting up filter_ip2
I0210 17:12:36.552240 16731 net.cpp:129] Top shape: 1 307200 (307200)
I0210 17:12:36.552242 16731 net.cpp:137] Memory required for data: 6593956
I0210 17:12:36.552250 16731 layer_factory.hpp:77] Creating layer conv2
I0210 17:12:36.552258 16731 net.cpp:84] Creating Layer conv2
I0210 17:12:36.552260 16731 net.cpp:406] conv2 <- pool1
I0210 17:12:36.552263 16731 net.cpp:406] conv2 <- filter_ip2
I0210 17:12:36.552266 16731 net.cpp:380] conv2 -> conv2
I0210 17:12:36.554884 16731 net.cpp:122] Setting up conv2
I0210 17:12:36.554894 16731 net.cpp:129] Top shape: 1 256 27 27 (186624)
I0210 17:12:36.554898 16731 net.cpp:137] Memory required for data: 7340452
I0210 17:12:36.554901 16731 layer_factory.hpp:77] Creating layer bn_conv2
I0210 17:12:36.554908 16731 net.cpp:84] Creating Layer bn_conv2
I0210 17:12:36.554909 16731 net.cpp:406] bn_conv2 <- conv2
I0210 17:12:36.554913 16731 net.cpp:367] bn_conv2 -> conv2 (in-place)
I0210 17:12:36.555084 16731 net.cpp:122] Setting up bn_conv2
I0210 17:12:36.555088 16731 net.cpp:129] Top shape: 1 256 27 27 (186624)
I0210 17:12:36.555090 16731 net.cpp:137] Memory required for data: 8086948
I0210 17:12:36.555095 16731 layer_factory.hpp:77] Creating layer scale_conv2
I0210 17:12:36.555100 16731 net.cpp:84] Creating Layer scale_conv2
I0210 17:12:36.555102 16731 net.cpp:406] scale_conv2 <- conv2
I0210 17:12:36.555104 16731 net.cpp:367] scale_conv2 -> conv2 (in-place)
I0210 17:12:36.555136 16731 layer_factory.hpp:77] Creating layer scale_conv2
I0210 17:12:36.555233 16731 net.cpp:122] Setting up scale_conv2
I0210 17:12:36.555235 16731 net.cpp:129] Top shape: 1 256 27 27 (186624)
I0210 17:12:36.555238 16731 net.cpp:137] Memory required for data: 8833444
I0210 17:12:36.555241 16731 layer_factory.hpp:77] Creating layer relu2
I0210 17:12:36.555248 16731 net.cpp:84] Creating Layer relu2
I0210 17:12:36.555249 16731 net.cpp:406] relu2 <- conv2
I0210 17:12:36.555251 16731 net.cpp:367] relu2 -> conv2 (in-place)
I0210 17:12:36.555490 16731 net.cpp:122] Setting up relu2
I0210 17:12:36.555495 16731 net.cpp:129] Top shape: 1 256 27 27 (186624)
I0210 17:12:36.555496 16731 net.cpp:137] Memory required for data: 9579940
I0210 17:12:36.555498 16731 layer_factory.hpp:77] Creating layer pool2
I0210 17:12:36.555503 16731 net.cpp:84] Creating Layer pool2
I0210 17:12:36.555505 16731 net.cpp:406] pool2 <- conv2
I0210 17:12:36.555508 16731 net.cpp:380] pool2 -> pool2
I0210 17:12:36.555544 16731 net.cpp:122] Setting up pool2
I0210 17:12:36.555548 16731 net.cpp:129] Top shape: 1 256 13 13 (43264)
I0210 17:12:36.555549 16731 net.cpp:137] Memory required for data: 9752996
I0210 17:12:36.555552 16731 layer_factory.hpp:77] Creating layer filter_ip3
I0210 17:12:36.555555 16731 net.cpp:84] Creating Layer filter_ip3
I0210 17:12:36.555558 16731 net.cpp:406] filter_ip3 <- embedding_fc2_embedding_fc2_0_split_1
I0210 17:12:36.555562 16731 net.cpp:380] filter_ip3 -> filter_ip3
I0210 17:12:36.562984 16731 net.cpp:122] Setting up filter_ip3
I0210 17:12:36.562999 16731 net.cpp:129] Top shape: 1 884736 (884736)
I0210 17:12:36.563000 16731 net.cpp:137] Memory required for data: 13291940
I0210 17:12:36.563026 16731 layer_factory.hpp:77] Creating layer conv3
I0210 17:12:36.563036 16731 net.cpp:84] Creating Layer conv3
I0210 17:12:36.563040 16731 net.cpp:406] conv3 <- pool2
I0210 17:12:36.563043 16731 net.cpp:406] conv3 <- filter_ip3
I0210 17:12:36.563047 16731 net.cpp:380] conv3 -> conv3
I0210 17:12:36.569547 16731 net.cpp:122] Setting up conv3
I0210 17:12:36.569558 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 17:12:36.569561 16731 net.cpp:137] Memory required for data: 13551524
I0210 17:12:36.569566 16731 layer_factory.hpp:77] Creating layer bn_conv3
I0210 17:12:36.569571 16731 net.cpp:84] Creating Layer bn_conv3
I0210 17:12:36.569574 16731 net.cpp:406] bn_conv3 <- conv3
I0210 17:12:36.569578 16731 net.cpp:367] bn_conv3 -> conv3 (in-place)
I0210 17:12:36.569751 16731 net.cpp:122] Setting up bn_conv3
I0210 17:12:36.569754 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 17:12:36.569756 16731 net.cpp:137] Memory required for data: 13811108
I0210 17:12:36.569761 16731 layer_factory.hpp:77] Creating layer scale_conv3
I0210 17:12:36.569766 16731 net.cpp:84] Creating Layer scale_conv3
I0210 17:12:36.569767 16731 net.cpp:406] scale_conv3 <- conv3
I0210 17:12:36.569769 16731 net.cpp:367] scale_conv3 -> conv3 (in-place)
I0210 17:12:36.569800 16731 layer_factory.hpp:77] Creating layer scale_conv3
I0210 17:12:36.569896 16731 net.cpp:122] Setting up scale_conv3
I0210 17:12:36.569900 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 17:12:36.569902 16731 net.cpp:137] Memory required for data: 14070692
I0210 17:12:36.569908 16731 layer_factory.hpp:77] Creating layer relu3
I0210 17:12:36.569912 16731 net.cpp:84] Creating Layer relu3
I0210 17:12:36.569914 16731 net.cpp:406] relu3 <- conv3
I0210 17:12:36.569917 16731 net.cpp:367] relu3 -> conv3 (in-place)
I0210 17:12:36.570225 16731 net.cpp:122] Setting up relu3
I0210 17:12:36.570231 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 17:12:36.570233 16731 net.cpp:137] Memory required for data: 14330276
I0210 17:12:36.570235 16731 layer_factory.hpp:77] Creating layer filter_ip4
I0210 17:12:36.570240 16731 net.cpp:84] Creating Layer filter_ip4
I0210 17:12:36.570243 16731 net.cpp:406] filter_ip4 <- embedding_fc2_embedding_fc2_0_split_2
I0210 17:12:36.570246 16731 net.cpp:380] filter_ip4 -> filter_ip4
I0210 17:12:36.575908 16731 net.cpp:122] Setting up filter_ip4
I0210 17:12:36.575920 16731 net.cpp:129] Top shape: 1 663552 (663552)
I0210 17:12:36.575923 16731 net.cpp:137] Memory required for data: 16984484
I0210 17:12:36.575928 16731 layer_factory.hpp:77] Creating layer conv4
I0210 17:12:36.575937 16731 net.cpp:84] Creating Layer conv4
I0210 17:12:36.575940 16731 net.cpp:406] conv4 <- conv3
I0210 17:12:36.575943 16731 net.cpp:406] conv4 <- filter_ip4
I0210 17:12:36.575947 16731 net.cpp:380] conv4 -> conv4
I0210 17:12:36.580818 16731 net.cpp:122] Setting up conv4
I0210 17:12:36.580828 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 17:12:36.580830 16731 net.cpp:137] Memory required for data: 17244068
I0210 17:12:36.580835 16731 layer_factory.hpp:77] Creating layer bn_conv4
I0210 17:12:36.580840 16731 net.cpp:84] Creating Layer bn_conv4
I0210 17:12:36.580843 16731 net.cpp:406] bn_conv4 <- conv4
I0210 17:12:36.580847 16731 net.cpp:367] bn_conv4 -> conv4 (in-place)
I0210 17:12:36.581022 16731 net.cpp:122] Setting up bn_conv4
I0210 17:12:36.581025 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 17:12:36.581028 16731 net.cpp:137] Memory required for data: 17503652
I0210 17:12:36.581032 16731 layer_factory.hpp:77] Creating layer scale_conv4
I0210 17:12:36.581037 16731 net.cpp:84] Creating Layer scale_conv4
I0210 17:12:36.581038 16731 net.cpp:406] scale_conv4 <- conv4
I0210 17:12:36.581041 16731 net.cpp:367] scale_conv4 -> conv4 (in-place)
I0210 17:12:36.581071 16731 layer_factory.hpp:77] Creating layer scale_conv4
I0210 17:12:36.581169 16731 net.cpp:122] Setting up scale_conv4
I0210 17:12:36.581173 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 17:12:36.581176 16731 net.cpp:137] Memory required for data: 17763236
I0210 17:12:36.581197 16731 layer_factory.hpp:77] Creating layer relu4
I0210 17:12:36.581200 16731 net.cpp:84] Creating Layer relu4
I0210 17:12:36.581202 16731 net.cpp:406] relu4 <- conv4
I0210 17:12:36.581207 16731 net.cpp:367] relu4 -> conv4 (in-place)
I0210 17:12:36.581526 16731 net.cpp:122] Setting up relu4
I0210 17:12:36.581531 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 17:12:36.581533 16731 net.cpp:137] Memory required for data: 18022820
I0210 17:12:36.581535 16731 layer_factory.hpp:77] Creating layer filter_ip5
I0210 17:12:36.581540 16731 net.cpp:84] Creating Layer filter_ip5
I0210 17:12:36.581542 16731 net.cpp:406] filter_ip5 <- embedding_fc2_embedding_fc2_0_split_3
I0210 17:12:36.581547 16731 net.cpp:380] filter_ip5 -> filter_ip5
I0210 17:12:36.585618 16731 net.cpp:122] Setting up filter_ip5
I0210 17:12:36.585631 16731 net.cpp:129] Top shape: 1 442368 (442368)
I0210 17:12:36.585633 16731 net.cpp:137] Memory required for data: 19792292
I0210 17:12:36.585640 16731 layer_factory.hpp:77] Creating layer conv5
I0210 17:12:36.585650 16731 net.cpp:84] Creating Layer conv5
I0210 17:12:36.585654 16731 net.cpp:406] conv5 <- conv4
I0210 17:12:36.585657 16731 net.cpp:406] conv5 <- filter_ip5
I0210 17:12:36.585661 16731 net.cpp:380] conv5 -> conv5
I0210 17:12:36.589243 16731 net.cpp:122] Setting up conv5
I0210 17:12:36.589260 16731 net.cpp:129] Top shape: 1 256 13 13 (43264)
I0210 17:12:36.589262 16731 net.cpp:137] Memory required for data: 19965348
I0210 17:12:36.589267 16731 layer_factory.hpp:77] Creating layer bn_conv5
I0210 17:12:36.589274 16731 net.cpp:84] Creating Layer bn_conv5
I0210 17:12:36.589277 16731 net.cpp:406] bn_conv5 <- conv5
I0210 17:12:36.589280 16731 net.cpp:367] bn_conv5 -> conv5 (in-place)
I0210 17:12:36.589460 16731 net.cpp:122] Setting up bn_conv5
I0210 17:12:36.589464 16731 net.cpp:129] Top shape: 1 256 13 13 (43264)
I0210 17:12:36.589467 16731 net.cpp:137] Memory required for data: 20138404
I0210 17:12:36.589471 16731 layer_factory.hpp:77] Creating layer scale_conv5
I0210 17:12:36.589476 16731 net.cpp:84] Creating Layer scale_conv5
I0210 17:12:36.589478 16731 net.cpp:406] scale_conv5 <- conv5
I0210 17:12:36.589481 16731 net.cpp:367] scale_conv5 -> conv5 (in-place)
I0210 17:12:36.589514 16731 layer_factory.hpp:77] Creating layer scale_conv5
I0210 17:12:36.589608 16731 net.cpp:122] Setting up scale_conv5
I0210 17:12:36.589613 16731 net.cpp:129] Top shape: 1 256 13 13 (43264)
I0210 17:12:36.589615 16731 net.cpp:137] Memory required for data: 20311460
I0210 17:12:36.589618 16731 layer_factory.hpp:77] Creating layer relu5
I0210 17:12:36.589624 16731 net.cpp:84] Creating Layer relu5
I0210 17:12:36.589627 16731 net.cpp:406] relu5 <- conv5
I0210 17:12:36.589630 16731 net.cpp:367] relu5 -> conv5 (in-place)
I0210 17:12:36.590034 16731 net.cpp:122] Setting up relu5
I0210 17:12:36.590039 16731 net.cpp:129] Top shape: 1 256 13 13 (43264)
I0210 17:12:36.590041 16731 net.cpp:137] Memory required for data: 20484516
I0210 17:12:36.590044 16731 layer_factory.hpp:77] Creating layer pool5
I0210 17:12:36.590047 16731 net.cpp:84] Creating Layer pool5
I0210 17:12:36.590050 16731 net.cpp:406] pool5 <- conv5
I0210 17:12:36.590054 16731 net.cpp:380] pool5 -> pool5
I0210 17:12:36.590106 16731 net.cpp:122] Setting up pool5
I0210 17:12:36.590109 16731 net.cpp:129] Top shape: 1 256 6 6 (9216)
I0210 17:12:36.590111 16731 net.cpp:137] Memory required for data: 20521380
I0210 17:12:36.590113 16731 layer_factory.hpp:77] Creating layer filter_ip6
I0210 17:12:36.590117 16731 net.cpp:84] Creating Layer filter_ip6
I0210 17:12:36.590119 16731 net.cpp:406] filter_ip6 <- embedding_fc2_embedding_fc2_0_split_4
I0210 17:12:36.590123 16731 net.cpp:380] filter_ip6 -> filter_ip6
I0210 17:12:36.628392 16731 net.cpp:122] Setting up filter_ip6
I0210 17:12:36.628412 16731 net.cpp:129] Top shape: 1 4718592 (4718592)
I0210 17:12:36.628414 16731 net.cpp:137] Memory required for data: 39395748
I0210 17:12:36.628422 16731 layer_factory.hpp:77] Creating layer feat0
I0210 17:12:36.628432 16731 net.cpp:84] Creating Layer feat0
I0210 17:12:36.628458 16731 net.cpp:406] feat0 <- pool5
I0210 17:12:36.628463 16731 net.cpp:406] feat0 <- filter_ip6
I0210 17:12:36.628466 16731 net.cpp:380] feat0 -> feat0
I0210 17:12:36.661053 16731 net.cpp:122] Setting up feat0
I0210 17:12:36.661068 16731 net.cpp:129] Top shape: 1 512 1 1 (512)
I0210 17:12:36.661070 16731 net.cpp:137] Memory required for data: 39397796
I0210 17:12:36.661077 16731 layer_factory.hpp:77] Creating layer bn_feat0
I0210 17:12:36.661083 16731 net.cpp:84] Creating Layer bn_feat0
I0210 17:12:36.661087 16731 net.cpp:406] bn_feat0 <- feat0
I0210 17:12:36.661090 16731 net.cpp:367] bn_feat0 -> feat0 (in-place)
I0210 17:12:36.661273 16731 net.cpp:122] Setting up bn_feat0
I0210 17:12:36.661278 16731 net.cpp:129] Top shape: 1 512 1 1 (512)
I0210 17:12:36.661279 16731 net.cpp:137] Memory required for data: 39399844
I0210 17:12:36.661283 16731 layer_factory.hpp:77] Creating layer scale_feat0
I0210 17:12:36.661288 16731 net.cpp:84] Creating Layer scale_feat0
I0210 17:12:36.661290 16731 net.cpp:406] scale_feat0 <- feat0
I0210 17:12:36.661293 16731 net.cpp:367] scale_feat0 -> feat0 (in-place)
I0210 17:12:36.661325 16731 layer_factory.hpp:77] Creating layer scale_feat0
I0210 17:12:36.661427 16731 net.cpp:122] Setting up scale_feat0
I0210 17:12:36.661430 16731 net.cpp:129] Top shape: 1 512 1 1 (512)
I0210 17:12:36.661432 16731 net.cpp:137] Memory required for data: 39401892
I0210 17:12:36.661435 16731 layer_factory.hpp:77] Creating layer relu_feat0
I0210 17:12:36.661438 16731 net.cpp:84] Creating Layer relu_feat0
I0210 17:12:36.661442 16731 net.cpp:406] relu_feat0 <- feat0
I0210 17:12:36.661443 16731 net.cpp:367] relu_feat0 -> feat0 (in-place)
I0210 17:12:36.661787 16731 net.cpp:122] Setting up relu_feat0
I0210 17:12:36.661792 16731 net.cpp:129] Top shape: 1 512 1 1 (512)
I0210 17:12:36.661793 16731 net.cpp:137] Memory required for data: 39403940
I0210 17:12:36.661795 16731 layer_factory.hpp:77] Creating layer filter_ip7
I0210 17:12:36.661800 16731 net.cpp:84] Creating Layer filter_ip7
I0210 17:12:36.661803 16731 net.cpp:406] filter_ip7 <- embedding_fc2_embedding_fc2_0_split_5
I0210 17:12:36.661806 16731 net.cpp:380] filter_ip7 -> filter_ip7
I0210 17:12:36.661912 16731 net.cpp:122] Setting up filter_ip7
I0210 17:12:36.661916 16731 net.cpp:129] Top shape: 1 512 (512)
I0210 17:12:36.661917 16731 net.cpp:137] Memory required for data: 39405988
I0210 17:12:36.661921 16731 layer_factory.hpp:77] Creating layer feat1
I0210 17:12:36.661927 16731 net.cpp:84] Creating Layer feat1
I0210 17:12:36.661931 16731 net.cpp:406] feat1 <- feat0
I0210 17:12:36.661932 16731 net.cpp:406] feat1 <- filter_ip7
I0210 17:12:36.661936 16731 net.cpp:380] feat1 -> feat1
I0210 17:12:36.662184 16731 net.cpp:122] Setting up feat1
I0210 17:12:36.662189 16731 net.cpp:129] Top shape: 1 1 1 1 (1)
I0210 17:12:36.662190 16731 net.cpp:137] Memory required for data: 39405992
I0210 17:12:36.662199 16731 net.cpp:200] feat1 does not need backward computation.
I0210 17:12:36.662202 16731 net.cpp:200] filter_ip7 does not need backward computation.
I0210 17:12:36.662204 16731 net.cpp:200] relu_feat0 does not need backward computation.
I0210 17:12:36.662206 16731 net.cpp:200] scale_feat0 does not need backward computation.
I0210 17:12:36.662209 16731 net.cpp:200] bn_feat0 does not need backward computation.
I0210 17:12:36.662210 16731 net.cpp:200] feat0 does not need backward computation.
I0210 17:12:36.662212 16731 net.cpp:200] filter_ip6 does not need backward computation.
I0210 17:12:36.662214 16731 net.cpp:200] pool5 does not need backward computation.
I0210 17:12:36.662216 16731 net.cpp:200] relu5 does not need backward computation.
I0210 17:12:36.662219 16731 net.cpp:200] scale_conv5 does not need backward computation.
I0210 17:12:36.662220 16731 net.cpp:200] bn_conv5 does not need backward computation.
I0210 17:12:36.662222 16731 net.cpp:200] conv5 does not need backward computation.
I0210 17:12:36.662225 16731 net.cpp:200] filter_ip5 does not need backward computation.
I0210 17:12:36.662227 16731 net.cpp:200] relu4 does not need backward computation.
I0210 17:12:36.662245 16731 net.cpp:200] scale_conv4 does not need backward computation.
I0210 17:12:36.662246 16731 net.cpp:200] bn_conv4 does not need backward computation.
I0210 17:12:36.662250 16731 net.cpp:200] conv4 does not need backward computation.
I0210 17:12:36.662251 16731 net.cpp:200] filter_ip4 does not need backward computation.
I0210 17:12:36.662253 16731 net.cpp:200] relu3 does not need backward computation.
I0210 17:12:36.662256 16731 net.cpp:200] scale_conv3 does not need backward computation.
I0210 17:12:36.662258 16731 net.cpp:200] bn_conv3 does not need backward computation.
I0210 17:12:36.662259 16731 net.cpp:200] conv3 does not need backward computation.
I0210 17:12:36.662261 16731 net.cpp:200] filter_ip3 does not need backward computation.
I0210 17:12:36.662264 16731 net.cpp:200] pool2 does not need backward computation.
I0210 17:12:36.662266 16731 net.cpp:200] relu2 does not need backward computation.
I0210 17:12:36.662268 16731 net.cpp:200] scale_conv2 does not need backward computation.
I0210 17:12:36.662271 16731 net.cpp:200] bn_conv2 does not need backward computation.
I0210 17:12:36.662271 16731 net.cpp:200] conv2 does not need backward computation.
I0210 17:12:36.662274 16731 net.cpp:200] filter_ip2 does not need backward computation.
I0210 17:12:36.662276 16731 net.cpp:200] pool1 does not need backward computation.
I0210 17:12:36.662278 16731 net.cpp:200] relu1 does not need backward computation.
I0210 17:12:36.662281 16731 net.cpp:200] scale_conv1 does not need backward computation.
I0210 17:12:36.662282 16731 net.cpp:200] bn_conv1 does not need backward computation.
I0210 17:12:36.662284 16731 net.cpp:200] conv1 does not need backward computation.
I0210 17:12:36.662286 16731 net.cpp:200] embedding_fc2_embedding_fc2_0_split does not need backward computation.
I0210 17:12:36.662288 16731 net.cpp:200] embedding_fc2 does not need backward computation.
I0210 17:12:36.662292 16731 net.cpp:200] relu_embedding_fc1 does not need backward computation.
I0210 17:12:36.662293 16731 net.cpp:200] scale_embedding_fc1 does not need backward computation.
I0210 17:12:36.662295 16731 net.cpp:200] bn_embedding_fc1 does not need backward computation.
I0210 17:12:36.662297 16731 net.cpp:200] embedding_fc1 does not need backward computation.
I0210 17:12:36.662299 16731 net.cpp:200] input does not need backward computation.
I0210 17:12:36.662302 16731 net.cpp:242] This network produces output feat1
I0210 17:12:36.662315 16731 net.cpp:255] Network initialization done.
I0210 17:12:36.696791 16731 upgrade_proto.cpp:77] Attempting to upgrade batch norm layers using deprecated params: ./snapshot/1/alex-ignet-embed_iter_15000.caffemodel
I0210 17:12:36.696807 16731 upgrade_proto.cpp:80] Successfully upgraded batch norm layers using deprecated params.
I0210 17:12:36.696810 16731 net.cpp:744] Ignoring source layer data
I0210 17:12:36.758924 16731 net.cpp:744] Ignoring source layer eucli_loss
I0210 17:12:52.814596 16731 solver.cpp:397]     Test net output #0: accuracy = 0.880569
I0210 17:12:52.814748 16731 solver.cpp:397]     Test net output #1: mae = 0.295433
I0210 17:12:52.814755 16731 solver.cpp:397]     Test net output #2: rmse = 0.373207
I0210 17:12:52.955251 16731 solver.cpp:218] Iteration 15000 (3.17228 iter/s, 31.5231s/100 iters), loss = 0.0202502
I0210 17:12:52.955286 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0202503 (* 1 = 0.0202503 loss)
I0210 17:12:52.955292 16731 sgd_solver.cpp:114] Iteration 15000, lr = 0.00277778
I0210 17:13:07.174530 16731 solver.cpp:218] Iteration 15100 (7.03299 iter/s, 14.2187s/100 iters), loss = 0.014659
I0210 17:13:07.174558 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0146591 (* 1 = 0.0146591 loss)
I0210 17:13:07.174566 16731 sgd_solver.cpp:114] Iteration 15100, lr = 0.00272222
I0210 17:13:21.434073 16731 solver.cpp:218] Iteration 15200 (7.01313 iter/s, 14.259s/100 iters), loss = 0.0150751
I0210 17:13:21.434124 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0150752 (* 1 = 0.0150752 loss)
I0210 17:13:21.434132 16731 sgd_solver.cpp:114] Iteration 15200, lr = 0.00266667
I0210 17:13:35.764187 16731 solver.cpp:218] Iteration 15300 (6.9786 iter/s, 14.3295s/100 iters), loss = 0.0146194
I0210 17:13:35.764348 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0146196 (* 1 = 0.0146196 loss)
I0210 17:13:35.764358 16731 sgd_solver.cpp:114] Iteration 15300, lr = 0.00261111
I0210 17:13:50.058142 16731 solver.cpp:218] Iteration 15400 (6.99632 iter/s, 14.2932s/100 iters), loss = 0.0133592
I0210 17:13:50.058192 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0133593 (* 1 = 0.0133593 loss)
I0210 17:13:50.058202 16731 sgd_solver.cpp:114] Iteration 15400, lr = 0.00255556
I0210 17:14:04.371417 16731 solver.cpp:218] Iteration 15500 (6.98681 iter/s, 14.3127s/100 iters), loss = 0.0235604
I0210 17:14:04.371448 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0235605 (* 1 = 0.0235605 loss)
I0210 17:14:04.371454 16731 sgd_solver.cpp:114] Iteration 15500, lr = 0.0025
I0210 17:14:18.707291 16731 solver.cpp:218] Iteration 15600 (6.97578 iter/s, 14.3353s/100 iters), loss = 0.0127475
I0210 17:14:18.707420 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0127476 (* 1 = 0.0127476 loss)
I0210 17:14:18.707429 16731 sgd_solver.cpp:114] Iteration 15600, lr = 0.00244444
I0210 17:14:33.021037 16731 solver.cpp:218] Iteration 15700 (6.98662 iter/s, 14.3131s/100 iters), loss = 0.0461976
I0210 17:14:33.021081 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0461977 (* 1 = 0.0461977 loss)
I0210 17:14:33.021090 16731 sgd_solver.cpp:114] Iteration 15700, lr = 0.00238889
I0210 17:14:47.300415 16731 solver.cpp:218] Iteration 15800 (7.00339 iter/s, 14.2788s/100 iters), loss = 0.0112594
I0210 17:14:47.300449 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0112595 (* 1 = 0.0112595 loss)
I0210 17:14:47.300456 16731 sgd_solver.cpp:114] Iteration 15800, lr = 0.00233333
I0210 17:15:01.588363 16731 solver.cpp:218] Iteration 15900 (6.99929 iter/s, 14.2872s/100 iters), loss = 0.016128
I0210 17:15:01.588516 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0161281 (* 1 = 0.0161281 loss)
I0210 17:15:01.588527 16731 sgd_solver.cpp:114] Iteration 15900, lr = 0.00227778
I0210 17:15:15.891829 16731 solver.cpp:218] Iteration 16000 (6.99165 iter/s, 14.3028s/100 iters), loss = 0.0125786
I0210 17:15:15.891865 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0125787 (* 1 = 0.0125787 loss)
I0210 17:15:15.891872 16731 sgd_solver.cpp:114] Iteration 16000, lr = 0.00222222
I0210 17:15:30.183915 16731 solver.cpp:218] Iteration 16100 (6.99722 iter/s, 14.2914s/100 iters), loss = 0.0144232
I0210 17:15:30.183948 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0144233 (* 1 = 0.0144233 loss)
I0210 17:15:30.183954 16731 sgd_solver.cpp:114] Iteration 16100, lr = 0.00216667
I0210 17:15:44.491488 16731 solver.cpp:218] Iteration 16200 (6.9896 iter/s, 14.307s/100 iters), loss = 0.0145154
I0210 17:15:44.491629 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0145155 (* 1 = 0.0145155 loss)
I0210 17:15:44.491638 16731 sgd_solver.cpp:114] Iteration 16200, lr = 0.00211111
I0210 17:15:58.782503 16731 solver.cpp:218] Iteration 16300 (6.99775 iter/s, 14.2903s/100 iters), loss = 0.0107628
I0210 17:15:58.782532 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.010763 (* 1 = 0.010763 loss)
I0210 17:15:58.782538 16731 sgd_solver.cpp:114] Iteration 16300, lr = 0.00205556
I0210 17:16:13.102751 16731 solver.cpp:218] Iteration 16400 (6.98339 iter/s, 14.3197s/100 iters), loss = 0.0184096
I0210 17:16:13.102785 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0184097 (* 1 = 0.0184097 loss)
I0210 17:16:13.102792 16731 sgd_solver.cpp:114] Iteration 16400, lr = 0.002
I0210 17:16:27.408655 16731 solver.cpp:218] Iteration 16500 (6.99039 iter/s, 14.3053s/100 iters), loss = 0.0121623
I0210 17:16:27.408779 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0121624 (* 1 = 0.0121624 loss)
I0210 17:16:27.408785 16731 sgd_solver.cpp:114] Iteration 16500, lr = 0.00194444
I0210 17:16:41.717808 16731 solver.cpp:218] Iteration 16600 (6.98885 iter/s, 14.3085s/100 iters), loss = 0.0215691
I0210 17:16:41.717851 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0215692 (* 1 = 0.0215692 loss)
I0210 17:16:41.717860 16731 sgd_solver.cpp:114] Iteration 16600, lr = 0.00188889
I0210 17:16:56.033485 16731 solver.cpp:218] Iteration 16700 (6.98563 iter/s, 14.3151s/100 iters), loss = 0.0180264
I0210 17:16:56.033535 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0180266 (* 1 = 0.0180266 loss)
I0210 17:16:56.033543 16731 sgd_solver.cpp:114] Iteration 16700, lr = 0.00183333
I0210 17:17:10.390800 16731 solver.cpp:218] Iteration 16800 (6.96537 iter/s, 14.3567s/100 iters), loss = 0.0243104
I0210 17:17:10.390908 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0243105 (* 1 = 0.0243105 loss)
I0210 17:17:10.390914 16731 sgd_solver.cpp:114] Iteration 16800, lr = 0.00177778
I0210 17:17:24.737782 16731 solver.cpp:218] Iteration 16900 (6.97041 iter/s, 14.3463s/100 iters), loss = 0.0103857
I0210 17:17:24.737813 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0103858 (* 1 = 0.0103858 loss)
I0210 17:17:24.737820 16731 sgd_solver.cpp:114] Iteration 16900, lr = 0.00172222
I0210 17:17:39.078313 16731 solver.cpp:218] Iteration 17000 (6.97351 iter/s, 14.34s/100 iters), loss = 0.0260465
I0210 17:17:39.078341 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0260466 (* 1 = 0.0260466 loss)
I0210 17:17:39.078347 16731 sgd_solver.cpp:114] Iteration 17000, lr = 0.00166667
I0210 17:17:53.736513 16731 solver.cpp:218] Iteration 17100 (6.82239 iter/s, 14.6576s/100 iters), loss = 0.0105334
I0210 17:17:53.736660 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0105335 (* 1 = 0.0105335 loss)
I0210 17:17:53.736670 16731 sgd_solver.cpp:114] Iteration 17100, lr = 0.00161111
I0210 17:18:08.027437 16731 solver.cpp:218] Iteration 17200 (6.99778 iter/s, 14.2903s/100 iters), loss = 0.0101047
I0210 17:18:08.027467 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0101049 (* 1 = 0.0101049 loss)
I0210 17:18:08.027474 16731 sgd_solver.cpp:114] Iteration 17200, lr = 0.00155556
I0210 17:18:22.204754 16731 solver.cpp:218] Iteration 17300 (7.05379 iter/s, 14.1768s/100 iters), loss = 0.021205
I0210 17:18:22.204782 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0212052 (* 1 = 0.0212052 loss)
I0210 17:18:22.204787 16731 sgd_solver.cpp:114] Iteration 17300, lr = 0.0015
I0210 17:18:36.456151 16731 solver.cpp:218] Iteration 17400 (7.01713 iter/s, 14.2508s/100 iters), loss = 0.0110477
I0210 17:18:36.456256 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0110478 (* 1 = 0.0110478 loss)
I0210 17:18:36.456264 16731 sgd_solver.cpp:114] Iteration 17400, lr = 0.00144444
I0210 17:18:50.675550 16731 solver.cpp:218] Iteration 17500 (7.03295 iter/s, 14.2188s/100 iters), loss = 0.012961
I0210 17:18:50.675580 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0129611 (* 1 = 0.0129611 loss)
I0210 17:18:50.675587 16731 sgd_solver.cpp:114] Iteration 17500, lr = 0.00138889
I0210 17:19:04.917955 16731 solver.cpp:218] Iteration 17600 (7.02156 iter/s, 14.2419s/100 iters), loss = 0.0156175
I0210 17:19:04.917985 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0156176 (* 1 = 0.0156176 loss)
I0210 17:19:04.917992 16731 sgd_solver.cpp:114] Iteration 17600, lr = 0.00133333
I0210 17:19:19.223337 16731 solver.cpp:218] Iteration 17700 (6.99065 iter/s, 14.3048s/100 iters), loss = 0.0210453
I0210 17:19:19.223467 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0210454 (* 1 = 0.0210454 loss)
I0210 17:19:19.223475 16731 sgd_solver.cpp:114] Iteration 17700, lr = 0.00127778
I0210 17:19:33.526887 16731 solver.cpp:218] Iteration 17800 (6.99159 iter/s, 14.3029s/100 iters), loss = 0.0106367
I0210 17:19:33.526921 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0106368 (* 1 = 0.0106368 loss)
I0210 17:19:33.526928 16731 sgd_solver.cpp:114] Iteration 17800, lr = 0.00122222
I0210 17:19:47.783093 16731 solver.cpp:218] Iteration 17900 (7.01481 iter/s, 14.2556s/100 iters), loss = 0.0137261
I0210 17:19:47.783119 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0137262 (* 1 = 0.0137262 loss)
I0210 17:19:47.783125 16731 sgd_solver.cpp:114] Iteration 17900, lr = 0.00116667
I0210 17:20:02.047576 16731 solver.cpp:218] Iteration 18000 (7.01069 iter/s, 14.2639s/100 iters), loss = 0.00922959
I0210 17:20:02.047730 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.00922971 (* 1 = 0.00922971 loss)
I0210 17:20:02.047739 16731 sgd_solver.cpp:114] Iteration 18000, lr = 0.00111111
I0210 17:20:16.218781 16731 solver.cpp:218] Iteration 18100 (7.0569 iter/s, 14.1705s/100 iters), loss = 0.0137931
I0210 17:20:16.218811 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0137932 (* 1 = 0.0137932 loss)
I0210 17:20:16.218818 16731 sgd_solver.cpp:114] Iteration 18100, lr = 0.00105556
I0210 17:20:30.490358 16731 solver.cpp:218] Iteration 18200 (7.00721 iter/s, 14.271s/100 iters), loss = 0.0336432
I0210 17:20:30.490399 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0336433 (* 1 = 0.0336433 loss)
I0210 17:20:30.490406 16731 sgd_solver.cpp:114] Iteration 18200, lr = 0.001
I0210 17:20:44.717636 16731 solver.cpp:218] Iteration 18300 (7.02903 iter/s, 14.2267s/100 iters), loss = 0.00782645
I0210 17:20:44.717738 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.00782657 (* 1 = 0.00782657 loss)
I0210 17:20:44.717746 16731 sgd_solver.cpp:114] Iteration 18300, lr = 0.000944445
I0210 17:20:58.959929 16731 solver.cpp:218] Iteration 18400 (7.02165 iter/s, 14.2417s/100 iters), loss = 0.0269662
I0210 17:20:58.959962 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0269663 (* 1 = 0.0269663 loss)
I0210 17:20:58.959969 16731 sgd_solver.cpp:114] Iteration 18400, lr = 0.000888889
I0210 17:21:13.209955 16731 solver.cpp:218] Iteration 18500 (7.0178 iter/s, 14.2495s/100 iters), loss = 0.0322366
I0210 17:21:13.209997 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0322367 (* 1 = 0.0322367 loss)
I0210 17:21:13.210008 16731 sgd_solver.cpp:114] Iteration 18500, lr = 0.000833333
I0210 17:21:27.446777 16731 solver.cpp:218] Iteration 18600 (7.02432 iter/s, 14.2363s/100 iters), loss = 0.0149426
I0210 17:21:27.446882 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0149427 (* 1 = 0.0149427 loss)
I0210 17:21:27.446902 16731 sgd_solver.cpp:114] Iteration 18600, lr = 0.000777778
I0210 17:21:41.654001 16731 solver.cpp:218] Iteration 18700 (7.03898 iter/s, 14.2066s/100 iters), loss = 0.010561
I0210 17:21:41.654031 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0105611 (* 1 = 0.0105611 loss)
I0210 17:21:41.654037 16731 sgd_solver.cpp:114] Iteration 18700, lr = 0.000722222
I0210 17:21:55.900657 16731 solver.cpp:218] Iteration 18800 (7.01946 iter/s, 14.2461s/100 iters), loss = 0.0106106
I0210 17:21:55.900684 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0106107 (* 1 = 0.0106107 loss)
I0210 17:21:55.900691 16731 sgd_solver.cpp:114] Iteration 18800, lr = 0.000666667
I0210 17:22:10.114853 16731 solver.cpp:218] Iteration 18900 (7.03549 iter/s, 14.2136s/100 iters), loss = 0.0139196
I0210 17:22:10.115015 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0139197 (* 1 = 0.0139197 loss)
I0210 17:22:10.115023 16731 sgd_solver.cpp:114] Iteration 18900, lr = 0.000611111
I0210 17:22:24.305778 16731 solver.cpp:218] Iteration 19000 (7.04709 iter/s, 14.1903s/100 iters), loss = 0.00860304
I0210 17:22:24.305806 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.00860315 (* 1 = 0.00860315 loss)
I0210 17:22:24.305812 16731 sgd_solver.cpp:114] Iteration 19000, lr = 0.000555556
I0210 17:22:38.504515 16731 solver.cpp:218] Iteration 19100 (7.04315 iter/s, 14.1982s/100 iters), loss = 0.00841945
I0210 17:22:38.504556 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.00841956 (* 1 = 0.00841956 loss)
I0210 17:22:38.504564 16731 sgd_solver.cpp:114] Iteration 19100, lr = 0.0005
I0210 17:22:52.696611 16731 solver.cpp:218] Iteration 19200 (7.04645 iter/s, 14.1915s/100 iters), loss = 0.014083
I0210 17:22:52.696736 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0140831 (* 1 = 0.0140831 loss)
I0210 17:22:52.696743 16731 sgd_solver.cpp:114] Iteration 19200, lr = 0.000444444
I0210 17:23:06.936573 16731 solver.cpp:218] Iteration 19300 (7.02281 iter/s, 14.2393s/100 iters), loss = 0.0109187
I0210 17:23:06.936605 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0109188 (* 1 = 0.0109188 loss)
I0210 17:23:06.936612 16731 sgd_solver.cpp:114] Iteration 19300, lr = 0.000388889
I0210 17:23:21.120975 16731 solver.cpp:218] Iteration 19400 (7.05027 iter/s, 14.1839s/100 iters), loss = 0.0209317
I0210 17:23:21.121002 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0209318 (* 1 = 0.0209318 loss)
I0210 17:23:21.121008 16731 sgd_solver.cpp:114] Iteration 19400, lr = 0.000333334
I0210 17:23:35.338227 16731 solver.cpp:218] Iteration 19500 (7.03398 iter/s, 14.2167s/100 iters), loss = 0.010759
I0210 17:23:35.338757 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0107591 (* 1 = 0.0107591 loss)
I0210 17:23:35.338783 16731 sgd_solver.cpp:114] Iteration 19500, lr = 0.000277778
I0210 17:23:49.545167 16731 solver.cpp:218] Iteration 19600 (7.03933 iter/s, 14.2059s/100 iters), loss = 0.0319209
I0210 17:23:49.545199 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.031921 (* 1 = 0.031921 loss)
I0210 17:23:49.545207 16731 sgd_solver.cpp:114] Iteration 19600, lr = 0.000222222
I0210 17:24:03.743173 16731 solver.cpp:218] Iteration 19700 (7.04351 iter/s, 14.1975s/100 iters), loss = 0.00883404
I0210 17:24:03.743204 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.00883416 (* 1 = 0.00883416 loss)
I0210 17:24:03.743211 16731 sgd_solver.cpp:114] Iteration 19700, lr = 0.000166667
I0210 17:24:17.975781 16731 solver.cpp:218] Iteration 19800 (7.02639 iter/s, 14.2321s/100 iters), loss = 0.0226018
I0210 17:24:17.975919 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0226019 (* 1 = 0.0226019 loss)
I0210 17:24:17.975929 16731 sgd_solver.cpp:114] Iteration 19800, lr = 0.000111111
I0210 17:24:32.188251 16731 solver.cpp:218] Iteration 19900 (7.03639 iter/s, 14.2118s/100 iters), loss = 0.0135151
I0210 17:24:32.188279 16731 solver.cpp:237]     Train net output #0: eucli_loss = 0.0135152 (* 1 = 0.0135152 loss)
I0210 17:24:32.188287 16731 sgd_solver.cpp:114] Iteration 19900, lr = 5.55557e-05
I0210 17:24:46.285434 16731 solver.cpp:447] Snapshotting to binary proto file ./snapshot/1/alex-ignet-embed_iter_20000.caffemodel
I0210 17:24:46.500501 16731 sgd_solver.cpp:282] Snapshotting solver state to binary proto file ./snapshot/1/alex-ignet-embed_iter_20000.solverstate
I0210 17:24:46.779721 16731 solver.cpp:310] Iteration 20000, loss = 0.010677
I0210 17:24:46.779739 16731 solver.cpp:330] Iteration 20000, Testing net (#0)
I0210 17:24:46.779744 16731 net.cpp:676] Ignoring source layer data
I0210 17:24:46.779747 16731 net.cpp:676] Ignoring source layer embedding_fc1
I0210 17:24:46.779748 16731 net.cpp:676] Ignoring source layer bn_embedding_fc1
I0210 17:24:46.779750 16731 net.cpp:676] Ignoring source layer scale_embedding_fc1
I0210 17:24:46.779752 16731 net.cpp:676] Ignoring source layer relu_embedding_fc1
I0210 17:24:46.779754 16731 net.cpp:676] Ignoring source layer embedding_fc2
I0210 17:24:46.779757 16731 net.cpp:676] Ignoring source layer embedding_fc2_embedding_fc2_0_split
I0210 17:24:46.779758 16731 net.cpp:676] Ignoring source layer conv1
I0210 17:24:46.779762 16731 net.cpp:676] Ignoring source layer bn_conv1
I0210 17:24:46.779764 16731 net.cpp:676] Ignoring source layer scale_conv1
I0210 17:24:46.779767 16731 net.cpp:676] Ignoring source layer relu1
I0210 17:24:46.779768 16731 net.cpp:676] Ignoring source layer pool1
I0210 17:24:46.779772 16731 net.cpp:676] Ignoring source layer filter_ip2
I0210 17:24:46.779773 16731 net.cpp:676] Ignoring source layer conv2
I0210 17:24:46.779775 16731 net.cpp:676] Ignoring source layer bn_conv2
I0210 17:24:46.779778 16731 net.cpp:676] Ignoring source layer scale_conv2
I0210 17:24:46.779781 16731 net.cpp:676] Ignoring source layer relu2
I0210 17:24:46.779783 16731 net.cpp:676] Ignoring source layer pool2
I0210 17:24:46.779785 16731 net.cpp:676] Ignoring source layer filter_ip3
I0210 17:24:46.779788 16731 net.cpp:676] Ignoring source layer conv3
I0210 17:24:46.779790 16731 net.cpp:676] Ignoring source layer bn_conv3
I0210 17:24:46.779793 16731 net.cpp:676] Ignoring source layer scale_conv3
I0210 17:24:46.779795 16731 net.cpp:676] Ignoring source layer relu3
I0210 17:24:46.779798 16731 net.cpp:676] Ignoring source layer filter_ip4
I0210 17:24:46.779801 16731 net.cpp:676] Ignoring source layer conv4
I0210 17:24:46.779803 16731 net.cpp:676] Ignoring source layer bn_conv4
I0210 17:24:46.779806 16731 net.cpp:676] Ignoring source layer scale_conv4
I0210 17:24:46.779808 16731 net.cpp:676] Ignoring source layer relu4
I0210 17:24:46.779810 16731 net.cpp:676] Ignoring source layer filter_ip5
I0210 17:24:46.779814 16731 net.cpp:676] Ignoring source layer conv5
I0210 17:24:46.779815 16731 net.cpp:676] Ignoring source layer bn_conv5
I0210 17:24:46.779817 16731 net.cpp:676] Ignoring source layer scale_conv5
I0210 17:24:46.779820 16731 net.cpp:676] Ignoring source layer relu5
I0210 17:24:46.779822 16731 net.cpp:676] Ignoring source layer pool5
I0210 17:24:46.779825 16731 net.cpp:676] Ignoring source layer filter_ip6
I0210 17:24:46.779827 16731 net.cpp:676] Ignoring source layer feat0
I0210 17:24:46.779830 16731 net.cpp:676] Ignoring source layer bn_feat0
I0210 17:24:46.779832 16731 net.cpp:676] Ignoring source layer scale_feat0
I0210 17:24:46.779834 16731 net.cpp:676] Ignoring source layer relu_feat0
I0210 17:24:46.779836 16731 net.cpp:676] Ignoring source layer filter_ip7
I0210 17:24:46.779839 16731 net.cpp:676] Ignoring source layer feat1
I0210 17:24:46.779841 16731 net.cpp:676] Ignoring source layer eucli_loss
W0210 17:24:47.006426 16731 _caffe.cpp:139] DEPRECATION WARNING - deprecated use of Python interface
W0210 17:24:47.006465 16731 _caffe.cpp:140] Use this instead (with the named "weights" parameter):
W0210 17:24:47.006470 16731 _caffe.cpp:142] Net('./alexnet-deploy-ignet-embed.prototxt', 1, weights='./snapshot/1/alex-ignet-embed_iter_20000.caffemodel')
I0210 17:24:47.006680 16731 upgrade_proto.cpp:67] Attempting to upgrade input file specified using deprecated input fields: ./alexnet-deploy-ignet-embed.prototxt
I0210 17:24:47.006688 16731 upgrade_proto.cpp:70] Successfully upgraded file specified using deprecated input fields.
W0210 17:24:47.006690 16731 upgrade_proto.cpp:72] Note that future Caffe releases will only support input layers and not input fields.
I0210 17:24:47.006925 16731 net.cpp:51] Initializing net from parameters: 
name: "AlexNet-ignet"
state {
  phase: TEST
  level: 0
}
layer {
  name: "input"
  type: "Input"
  top: "data"
  top: "extra"
  input_param {
    shape {
      dim: 1
      dim: 3
      dim: 224
      dim: 224
    }
    shape {
      dim: 1
      dim: 2
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding_fc1"
  type: "InnerProduct"
  bottom: "extra"
  top: "embedding_fc1"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 256
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "bn_embedding_fc1"
  type: "BatchNorm"
  bottom: "embedding_fc1"
  top: "embedding_fc1"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_embedding_fc1"
  type: "Scale"
  bottom: "embedding_fc1"
  top: "embedding_fc1"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu_embedding_fc1"
  type: "ReLU"
  bottom: "embedding_fc1"
  top: "embedding_fc1"
}
layer {
  name: "embedding_fc2"
  type: "InnerProduct"
  bottom: "embedding_fc1"
  top: "embedding_fc2"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 1
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  param {
    name: "conv1_w"
    lr_mult: 1
    decay_mult: 1
  }
  param {
    name: "conv1_b"
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
  }
}
layer {
  name: "bn_conv1"
  type: "BatchNorm"
  bottom: "conv1"
  top: "conv1"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_conv1"
  type: "Scale"
  bottom: "conv1"
  top: "conv1"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "filter_ip2"
  type: "InnerProduct"
  bottom: "embedding_fc2"
  top: "filter_ip2"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 307200
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "pool1"
  bottom: "filter_ip2"
  top: "conv2"
  param {
    name: "conv2_w"
    lr_mult: 1
    decay_mult: 1
  }
  param {
    name: "conv2_b"
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
    weight_operation: COPY
  }
}
layer {
  name: "bn_conv2"
  type: "BatchNorm"
  bottom: "conv2"
  top: "conv2"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_conv2"
  type: "Scale"
  bottom: "conv2"
  top: "conv2"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "filter_ip3"
  type: "InnerProduct"
  bottom: "embedding_fc2"
  top: "filter_ip3"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 884736
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "pool2"
  bottom: "filter_ip3"
  top: "conv3"
  param {
    name: "conv3_w"
    lr_mult: 1
    decay_mult: 1
  }
  param {
    name: "conv3_b"
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
    weight_operation: COPY
  }
}
layer {
  name: "bn_conv3"
  type: "BatchNorm"
  bottom: "conv3"
  top: "conv3"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_conv3"
  type: "Scale"
  bottom: "conv3"
  top: "conv3"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "filter_ip4"
  type: "InnerProduct"
  bottom: "embedding_fc2"
  top: "filter_ip4"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 663552
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  bottom: "filter_ip4"
  top: "conv4"
  param {
    name: "conv4_w"
    lr_mult: 1
    decay_mult: 1
  }
  param {
    name: "conv4_b"
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
    weight_operation: COPY
  }
}
layer {
  name: "bn_conv4"
  type: "BatchNorm"
  bottom: "conv4"
  top: "conv4"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_conv4"
  type: "Scale"
  bottom: "conv4"
  top: "conv4"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "filter_ip5"
  type: "InnerProduct"
  bottom: "embedding_fc2"
  top: "filter_ip5"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 442368
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  bottom: "filter_ip5"
  top: "conv5"
  param {
    name: "conv5_w"
    lr_mult: 1
    decay_mult: 1
  }
  param {
    name: "conv5_b"
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
    weight_operation: COPY
  }
}
layer {
  name: "bn_conv5"
  type: "BatchNorm"
  bottom: "conv5"
  top: "conv5"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_conv5"
  type: "Scale"
  bottom: "conv5"
  top: "conv5"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "filter_ip6"
  type: "InnerProduct"
  bottom: "embedding_fc2"
  top: "filter_ip6"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 4718592
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "feat0"
  type: "Convolution"
  bottom: "pool5"
  bottom: "filter_ip6"
  top: "feat0"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 512
    kernel_size: 6
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
    weight_operation: COPY
  }
}
layer {
  name: "bn_feat0"
  type: "BatchNorm"
  bottom: "feat0"
  top: "feat0"
  batch_norm_param {
    moving_average_fraction: 0.999
  }
}
layer {
  name: "scale_feat0"
  type: "Scale"
  bottom: "feat0"
  top: "feat0"
  scale_param {
    bias_term: true
  }
}
layer {
  name: "relu_feat0"
  type: "ReLU"
  bottom: "feat0"
  top: "feat0"
}
layer {
  name: "filter_ip7"
  type: "InnerProduct"
  bottom: "embedding_fc2"
  top: "filter_ip7"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 512
    weight_filler {
      type: "gaussian"
      std: 0.001
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "feat1"
  type: "Convolution"
  bottom: "feat0"
  bottom: "filter_ip7"
  top: "feat1"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  convolution_param {
    num_output: 1
    kernel_size: 1
    weight_filler {
      type: "msra"
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    engine: CAFFE
    weight_operation: COPY
  }
}
I0210 17:24:47.007025 16731 layer_factory.hpp:77] Creating layer input
I0210 17:24:47.007032 16731 net.cpp:84] Creating Layer input
I0210 17:24:47.007035 16731 net.cpp:380] input -> data
I0210 17:24:47.007042 16731 net.cpp:380] input -> extra
I0210 17:24:47.007129 16731 net.cpp:122] Setting up input
I0210 17:24:47.007133 16731 net.cpp:129] Top shape: 1 3 224 224 (150528)
I0210 17:24:47.007136 16731 net.cpp:129] Top shape: 1 2 1 1 (2)
I0210 17:24:47.007138 16731 net.cpp:137] Memory required for data: 602120
I0210 17:24:47.007140 16731 layer_factory.hpp:77] Creating layer embedding_fc1
I0210 17:24:47.007144 16731 net.cpp:84] Creating Layer embedding_fc1
I0210 17:24:47.007146 16731 net.cpp:406] embedding_fc1 <- extra
I0210 17:24:47.007151 16731 net.cpp:380] embedding_fc1 -> embedding_fc1
I0210 17:24:47.007285 16731 net.cpp:122] Setting up embedding_fc1
I0210 17:24:47.007289 16731 net.cpp:129] Top shape: 1 256 (256)
I0210 17:24:47.007292 16731 net.cpp:137] Memory required for data: 603144
I0210 17:24:47.007297 16731 layer_factory.hpp:77] Creating layer bn_embedding_fc1
I0210 17:24:47.007318 16731 net.cpp:84] Creating Layer bn_embedding_fc1
I0210 17:24:47.007320 16731 net.cpp:406] bn_embedding_fc1 <- embedding_fc1
I0210 17:24:47.007323 16731 net.cpp:367] bn_embedding_fc1 -> embedding_fc1 (in-place)
I0210 17:24:47.007496 16731 net.cpp:122] Setting up bn_embedding_fc1
I0210 17:24:47.007500 16731 net.cpp:129] Top shape: 1 256 (256)
I0210 17:24:47.007501 16731 net.cpp:137] Memory required for data: 604168
I0210 17:24:47.007508 16731 layer_factory.hpp:77] Creating layer scale_embedding_fc1
I0210 17:24:47.007511 16731 net.cpp:84] Creating Layer scale_embedding_fc1
I0210 17:24:47.007513 16731 net.cpp:406] scale_embedding_fc1 <- embedding_fc1
I0210 17:24:47.007516 16731 net.cpp:367] scale_embedding_fc1 -> embedding_fc1 (in-place)
I0210 17:24:47.007545 16731 layer_factory.hpp:77] Creating layer scale_embedding_fc1
I0210 17:24:47.007634 16731 net.cpp:122] Setting up scale_embedding_fc1
I0210 17:24:47.007637 16731 net.cpp:129] Top shape: 1 256 (256)
I0210 17:24:47.007639 16731 net.cpp:137] Memory required for data: 605192
I0210 17:24:47.007643 16731 layer_factory.hpp:77] Creating layer relu_embedding_fc1
I0210 17:24:47.007655 16731 net.cpp:84] Creating Layer relu_embedding_fc1
I0210 17:24:47.007658 16731 net.cpp:406] relu_embedding_fc1 <- embedding_fc1
I0210 17:24:47.007660 16731 net.cpp:367] relu_embedding_fc1 -> embedding_fc1 (in-place)
I0210 17:24:47.007972 16731 net.cpp:122] Setting up relu_embedding_fc1
I0210 17:24:47.007977 16731 net.cpp:129] Top shape: 1 256 (256)
I0210 17:24:47.007979 16731 net.cpp:137] Memory required for data: 606216
I0210 17:24:47.007982 16731 layer_factory.hpp:77] Creating layer embedding_fc2
I0210 17:24:47.007984 16731 net.cpp:84] Creating Layer embedding_fc2
I0210 17:24:47.007987 16731 net.cpp:406] embedding_fc2 <- embedding_fc1
I0210 17:24:47.007990 16731 net.cpp:380] embedding_fc2 -> embedding_fc2
I0210 17:24:47.008080 16731 net.cpp:122] Setting up embedding_fc2
I0210 17:24:47.008083 16731 net.cpp:129] Top shape: 1 1 (1)
I0210 17:24:47.008085 16731 net.cpp:137] Memory required for data: 606220
I0210 17:24:47.008090 16731 layer_factory.hpp:77] Creating layer embedding_fc2_embedding_fc2_0_split
I0210 17:24:47.008095 16731 net.cpp:84] Creating Layer embedding_fc2_embedding_fc2_0_split
I0210 17:24:47.008096 16731 net.cpp:406] embedding_fc2_embedding_fc2_0_split <- embedding_fc2
I0210 17:24:47.008100 16731 net.cpp:380] embedding_fc2_embedding_fc2_0_split -> embedding_fc2_embedding_fc2_0_split_0
I0210 17:24:47.008105 16731 net.cpp:380] embedding_fc2_embedding_fc2_0_split -> embedding_fc2_embedding_fc2_0_split_1
I0210 17:24:47.008108 16731 net.cpp:380] embedding_fc2_embedding_fc2_0_split -> embedding_fc2_embedding_fc2_0_split_2
I0210 17:24:47.008111 16731 net.cpp:380] embedding_fc2_embedding_fc2_0_split -> embedding_fc2_embedding_fc2_0_split_3
I0210 17:24:47.008116 16731 net.cpp:380] embedding_fc2_embedding_fc2_0_split -> embedding_fc2_embedding_fc2_0_split_4
I0210 17:24:47.008119 16731 net.cpp:380] embedding_fc2_embedding_fc2_0_split -> embedding_fc2_embedding_fc2_0_split_5
I0210 17:24:47.008188 16731 net.cpp:122] Setting up embedding_fc2_embedding_fc2_0_split
I0210 17:24:47.008193 16731 net.cpp:129] Top shape: 1 1 (1)
I0210 17:24:47.008195 16731 net.cpp:129] Top shape: 1 1 (1)
I0210 17:24:47.008198 16731 net.cpp:129] Top shape: 1 1 (1)
I0210 17:24:47.008199 16731 net.cpp:129] Top shape: 1 1 (1)
I0210 17:24:47.008201 16731 net.cpp:129] Top shape: 1 1 (1)
I0210 17:24:47.008203 16731 net.cpp:129] Top shape: 1 1 (1)
I0210 17:24:47.008205 16731 net.cpp:137] Memory required for data: 606244
I0210 17:24:47.008208 16731 layer_factory.hpp:77] Creating layer conv1
I0210 17:24:47.008213 16731 net.cpp:84] Creating Layer conv1
I0210 17:24:47.008215 16731 net.cpp:406] conv1 <- data
I0210 17:24:47.008219 16731 net.cpp:380] conv1 -> conv1
I0210 17:24:47.008695 16731 net.cpp:122] Setting up conv1
I0210 17:24:47.008700 16731 net.cpp:129] Top shape: 1 96 54 54 (279936)
I0210 17:24:47.008702 16731 net.cpp:137] Memory required for data: 1725988
I0210 17:24:47.008705 16731 layer_factory.hpp:77] Creating layer bn_conv1
I0210 17:24:47.008710 16731 net.cpp:84] Creating Layer bn_conv1
I0210 17:24:47.008713 16731 net.cpp:406] bn_conv1 <- conv1
I0210 17:24:47.008715 16731 net.cpp:367] bn_conv1 -> conv1 (in-place)
I0210 17:24:47.008882 16731 net.cpp:122] Setting up bn_conv1
I0210 17:24:47.008886 16731 net.cpp:129] Top shape: 1 96 54 54 (279936)
I0210 17:24:47.008888 16731 net.cpp:137] Memory required for data: 2845732
I0210 17:24:47.008893 16731 layer_factory.hpp:77] Creating layer scale_conv1
I0210 17:24:47.008896 16731 net.cpp:84] Creating Layer scale_conv1
I0210 17:24:47.008898 16731 net.cpp:406] scale_conv1 <- conv1
I0210 17:24:47.008900 16731 net.cpp:367] scale_conv1 -> conv1 (in-place)
I0210 17:24:47.008931 16731 layer_factory.hpp:77] Creating layer scale_conv1
I0210 17:24:47.009028 16731 net.cpp:122] Setting up scale_conv1
I0210 17:24:47.009032 16731 net.cpp:129] Top shape: 1 96 54 54 (279936)
I0210 17:24:47.009033 16731 net.cpp:137] Memory required for data: 3965476
I0210 17:24:47.009037 16731 layer_factory.hpp:77] Creating layer relu1
I0210 17:24:47.009040 16731 net.cpp:84] Creating Layer relu1
I0210 17:24:47.009042 16731 net.cpp:406] relu1 <- conv1
I0210 17:24:47.009053 16731 net.cpp:367] relu1 -> conv1 (in-place)
I0210 17:24:47.009250 16731 net.cpp:122] Setting up relu1
I0210 17:24:47.009255 16731 net.cpp:129] Top shape: 1 96 54 54 (279936)
I0210 17:24:47.009258 16731 net.cpp:137] Memory required for data: 5085220
I0210 17:24:47.009259 16731 layer_factory.hpp:77] Creating layer pool1
I0210 17:24:47.009263 16731 net.cpp:84] Creating Layer pool1
I0210 17:24:47.009265 16731 net.cpp:406] pool1 <- conv1
I0210 17:24:47.009268 16731 net.cpp:380] pool1 -> pool1
I0210 17:24:47.009302 16731 net.cpp:122] Setting up pool1
I0210 17:24:47.009305 16731 net.cpp:129] Top shape: 1 96 27 27 (69984)
I0210 17:24:47.009307 16731 net.cpp:137] Memory required for data: 5365156
I0210 17:24:47.009310 16731 layer_factory.hpp:77] Creating layer filter_ip2
I0210 17:24:47.009313 16731 net.cpp:84] Creating Layer filter_ip2
I0210 17:24:47.009315 16731 net.cpp:406] filter_ip2 <- embedding_fc2_embedding_fc2_0_split_0
I0210 17:24:47.009320 16731 net.cpp:380] filter_ip2 -> filter_ip2
I0210 17:24:47.012465 16731 net.cpp:122] Setting up filter_ip2
I0210 17:24:47.012475 16731 net.cpp:129] Top shape: 1 307200 (307200)
I0210 17:24:47.012476 16731 net.cpp:137] Memory required for data: 6593956
I0210 17:24:47.012483 16731 layer_factory.hpp:77] Creating layer conv2
I0210 17:24:47.012491 16731 net.cpp:84] Creating Layer conv2
I0210 17:24:47.012493 16731 net.cpp:406] conv2 <- pool1
I0210 17:24:47.012496 16731 net.cpp:406] conv2 <- filter_ip2
I0210 17:24:47.012501 16731 net.cpp:380] conv2 -> conv2
I0210 17:24:47.015053 16731 net.cpp:122] Setting up conv2
I0210 17:24:47.015060 16731 net.cpp:129] Top shape: 1 256 27 27 (186624)
I0210 17:24:47.015063 16731 net.cpp:137] Memory required for data: 7340452
I0210 17:24:47.015067 16731 layer_factory.hpp:77] Creating layer bn_conv2
I0210 17:24:47.015071 16731 net.cpp:84] Creating Layer bn_conv2
I0210 17:24:47.015074 16731 net.cpp:406] bn_conv2 <- conv2
I0210 17:24:47.015077 16731 net.cpp:367] bn_conv2 -> conv2 (in-place)
I0210 17:24:47.015246 16731 net.cpp:122] Setting up bn_conv2
I0210 17:24:47.015250 16731 net.cpp:129] Top shape: 1 256 27 27 (186624)
I0210 17:24:47.015252 16731 net.cpp:137] Memory required for data: 8086948
I0210 17:24:47.015256 16731 layer_factory.hpp:77] Creating layer scale_conv2
I0210 17:24:47.015261 16731 net.cpp:84] Creating Layer scale_conv2
I0210 17:24:47.015264 16731 net.cpp:406] scale_conv2 <- conv2
I0210 17:24:47.015265 16731 net.cpp:367] scale_conv2 -> conv2 (in-place)
I0210 17:24:47.015295 16731 layer_factory.hpp:77] Creating layer scale_conv2
I0210 17:24:47.015388 16731 net.cpp:122] Setting up scale_conv2
I0210 17:24:47.015393 16731 net.cpp:129] Top shape: 1 256 27 27 (186624)
I0210 17:24:47.015394 16731 net.cpp:137] Memory required for data: 8833444
I0210 17:24:47.015398 16731 layer_factory.hpp:77] Creating layer relu2
I0210 17:24:47.015403 16731 net.cpp:84] Creating Layer relu2
I0210 17:24:47.015405 16731 net.cpp:406] relu2 <- conv2
I0210 17:24:47.015408 16731 net.cpp:367] relu2 -> conv2 (in-place)
I0210 17:24:47.015637 16731 net.cpp:122] Setting up relu2
I0210 17:24:47.015642 16731 net.cpp:129] Top shape: 1 256 27 27 (186624)
I0210 17:24:47.015645 16731 net.cpp:137] Memory required for data: 9579940
I0210 17:24:47.015646 16731 layer_factory.hpp:77] Creating layer pool2
I0210 17:24:47.015650 16731 net.cpp:84] Creating Layer pool2
I0210 17:24:47.015653 16731 net.cpp:406] pool2 <- conv2
I0210 17:24:47.015656 16731 net.cpp:380] pool2 -> pool2
I0210 17:24:47.015691 16731 net.cpp:122] Setting up pool2
I0210 17:24:47.015694 16731 net.cpp:129] Top shape: 1 256 13 13 (43264)
I0210 17:24:47.015697 16731 net.cpp:137] Memory required for data: 9752996
I0210 17:24:47.015698 16731 layer_factory.hpp:77] Creating layer filter_ip3
I0210 17:24:47.015702 16731 net.cpp:84] Creating Layer filter_ip3
I0210 17:24:47.015704 16731 net.cpp:406] filter_ip3 <- embedding_fc2_embedding_fc2_0_split_1
I0210 17:24:47.015708 16731 net.cpp:380] filter_ip3 -> filter_ip3
I0210 17:24:47.023025 16731 net.cpp:122] Setting up filter_ip3
I0210 17:24:47.023057 16731 net.cpp:129] Top shape: 1 884736 (884736)
I0210 17:24:47.023059 16731 net.cpp:137] Memory required for data: 13291940
I0210 17:24:47.023066 16731 layer_factory.hpp:77] Creating layer conv3
I0210 17:24:47.023075 16731 net.cpp:84] Creating Layer conv3
I0210 17:24:47.023078 16731 net.cpp:406] conv3 <- pool2
I0210 17:24:47.023082 16731 net.cpp:406] conv3 <- filter_ip3
I0210 17:24:47.023087 16731 net.cpp:380] conv3 -> conv3
I0210 17:24:47.029413 16731 net.cpp:122] Setting up conv3
I0210 17:24:47.029423 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 17:24:47.029425 16731 net.cpp:137] Memory required for data: 13551524
I0210 17:24:47.029430 16731 layer_factory.hpp:77] Creating layer bn_conv3
I0210 17:24:47.029436 16731 net.cpp:84] Creating Layer bn_conv3
I0210 17:24:47.029438 16731 net.cpp:406] bn_conv3 <- conv3
I0210 17:24:47.029443 16731 net.cpp:367] bn_conv3 -> conv3 (in-place)
I0210 17:24:47.029613 16731 net.cpp:122] Setting up bn_conv3
I0210 17:24:47.029616 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 17:24:47.029618 16731 net.cpp:137] Memory required for data: 13811108
I0210 17:24:47.029623 16731 layer_factory.hpp:77] Creating layer scale_conv3
I0210 17:24:47.029628 16731 net.cpp:84] Creating Layer scale_conv3
I0210 17:24:47.029629 16731 net.cpp:406] scale_conv3 <- conv3
I0210 17:24:47.029633 16731 net.cpp:367] scale_conv3 -> conv3 (in-place)
I0210 17:24:47.029661 16731 layer_factory.hpp:77] Creating layer scale_conv3
I0210 17:24:47.029757 16731 net.cpp:122] Setting up scale_conv3
I0210 17:24:47.029759 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 17:24:47.029762 16731 net.cpp:137] Memory required for data: 14070692
I0210 17:24:47.029768 16731 layer_factory.hpp:77] Creating layer relu3
I0210 17:24:47.029772 16731 net.cpp:84] Creating Layer relu3
I0210 17:24:47.029773 16731 net.cpp:406] relu3 <- conv3
I0210 17:24:47.029776 16731 net.cpp:367] relu3 -> conv3 (in-place)
I0210 17:24:47.030124 16731 net.cpp:122] Setting up relu3
I0210 17:24:47.030130 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 17:24:47.030133 16731 net.cpp:137] Memory required for data: 14330276
I0210 17:24:47.030134 16731 layer_factory.hpp:77] Creating layer filter_ip4
I0210 17:24:47.030139 16731 net.cpp:84] Creating Layer filter_ip4
I0210 17:24:47.030141 16731 net.cpp:406] filter_ip4 <- embedding_fc2_embedding_fc2_0_split_2
I0210 17:24:47.030145 16731 net.cpp:380] filter_ip4 -> filter_ip4
I0210 17:24:47.035588 16731 net.cpp:122] Setting up filter_ip4
I0210 17:24:47.035598 16731 net.cpp:129] Top shape: 1 663552 (663552)
I0210 17:24:47.035601 16731 net.cpp:137] Memory required for data: 16984484
I0210 17:24:47.035606 16731 layer_factory.hpp:77] Creating layer conv4
I0210 17:24:47.035615 16731 net.cpp:84] Creating Layer conv4
I0210 17:24:47.035617 16731 net.cpp:406] conv4 <- conv3
I0210 17:24:47.035621 16731 net.cpp:406] conv4 <- filter_ip4
I0210 17:24:47.035624 16731 net.cpp:380] conv4 -> conv4
I0210 17:24:47.040472 16731 net.cpp:122] Setting up conv4
I0210 17:24:47.040482 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 17:24:47.040485 16731 net.cpp:137] Memory required for data: 17244068
I0210 17:24:47.040489 16731 layer_factory.hpp:77] Creating layer bn_conv4
I0210 17:24:47.040494 16731 net.cpp:84] Creating Layer bn_conv4
I0210 17:24:47.040496 16731 net.cpp:406] bn_conv4 <- conv4
I0210 17:24:47.040500 16731 net.cpp:367] bn_conv4 -> conv4 (in-place)
I0210 17:24:47.040673 16731 net.cpp:122] Setting up bn_conv4
I0210 17:24:47.040676 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 17:24:47.040678 16731 net.cpp:137] Memory required for data: 17503652
I0210 17:24:47.040684 16731 layer_factory.hpp:77] Creating layer scale_conv4
I0210 17:24:47.040688 16731 net.cpp:84] Creating Layer scale_conv4
I0210 17:24:47.040689 16731 net.cpp:406] scale_conv4 <- conv4
I0210 17:24:47.040693 16731 net.cpp:367] scale_conv4 -> conv4 (in-place)
I0210 17:24:47.040722 16731 layer_factory.hpp:77] Creating layer scale_conv4
I0210 17:24:47.040818 16731 net.cpp:122] Setting up scale_conv4
I0210 17:24:47.040822 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 17:24:47.040843 16731 net.cpp:137] Memory required for data: 17763236
I0210 17:24:47.040846 16731 layer_factory.hpp:77] Creating layer relu4
I0210 17:24:47.040850 16731 net.cpp:84] Creating Layer relu4
I0210 17:24:47.040853 16731 net.cpp:406] relu4 <- conv4
I0210 17:24:47.040855 16731 net.cpp:367] relu4 -> conv4 (in-place)
I0210 17:24:47.041187 16731 net.cpp:122] Setting up relu4
I0210 17:24:47.041191 16731 net.cpp:129] Top shape: 1 384 13 13 (64896)
I0210 17:24:47.041193 16731 net.cpp:137] Memory required for data: 18022820
I0210 17:24:47.041195 16731 layer_factory.hpp:77] Creating layer filter_ip5
I0210 17:24:47.041200 16731 net.cpp:84] Creating Layer filter_ip5
I0210 17:24:47.041203 16731 net.cpp:406] filter_ip5 <- embedding_fc2_embedding_fc2_0_split_3
I0210 17:24:47.041206 16731 net.cpp:380] filter_ip5 -> filter_ip5
I0210 17:24:47.045168 16731 net.cpp:122] Setting up filter_ip5
I0210 17:24:47.045179 16731 net.cpp:129] Top shape: 1 442368 (442368)
I0210 17:24:47.045181 16731 net.cpp:137] Memory required for data: 19792292
I0210 17:24:47.045186 16731 layer_factory.hpp:77] Creating layer conv5
I0210 17:24:47.045194 16731 net.cpp:84] Creating Layer conv5
I0210 17:24:47.045198 16731 net.cpp:406] conv5 <- conv4
I0210 17:24:47.045202 16731 net.cpp:406] conv5 <- filter_ip5
I0210 17:24:47.045205 16731 net.cpp:380] conv5 -> conv5
I0210 17:24:47.048549 16731 net.cpp:122] Setting up conv5
I0210 17:24:47.048558 16731 net.cpp:129] Top shape: 1 256 13 13 (43264)
I0210 17:24:47.048560 16731 net.cpp:137] Memory required for data: 19965348
I0210 17:24:47.048564 16731 layer_factory.hpp:77] Creating layer bn_conv5
I0210 17:24:47.048569 16731 net.cpp:84] Creating Layer bn_conv5
I0210 17:24:47.048573 16731 net.cpp:406] bn_conv5 <- conv5
I0210 17:24:47.048575 16731 net.cpp:367] bn_conv5 -> conv5 (in-place)
I0210 17:24:47.048749 16731 net.cpp:122] Setting up bn_conv5
I0210 17:24:47.048753 16731 net.cpp:129] Top shape: 1 256 13 13 (43264)
I0210 17:24:47.048755 16731 net.cpp:137] Memory required for data: 20138404
I0210 17:24:47.048760 16731 layer_factory.hpp:77] Creating layer scale_conv5
I0210 17:24:47.048764 16731 net.cpp:84] Creating Layer scale_conv5
I0210 17:24:47.048766 16731 net.cpp:406] scale_conv5 <- conv5
I0210 17:24:47.048769 16731 net.cpp:367] scale_conv5 -> conv5 (in-place)
I0210 17:24:47.048800 16731 layer_factory.hpp:77] Creating layer scale_conv5
I0210 17:24:47.048893 16731 net.cpp:122] Setting up scale_conv5
I0210 17:24:47.048897 16731 net.cpp:129] Top shape: 1 256 13 13 (43264)
I0210 17:24:47.048899 16731 net.cpp:137] Memory required for data: 20311460
I0210 17:24:47.048903 16731 layer_factory.hpp:77] Creating layer relu5
I0210 17:24:47.048909 16731 net.cpp:84] Creating Layer relu5
I0210 17:24:47.048912 16731 net.cpp:406] relu5 <- conv5
I0210 17:24:47.048914 16731 net.cpp:367] relu5 -> conv5 (in-place)
I0210 17:24:47.049242 16731 net.cpp:122] Setting up relu5
I0210 17:24:47.049247 16731 net.cpp:129] Top shape: 1 256 13 13 (43264)
I0210 17:24:47.049249 16731 net.cpp:137] Memory required for data: 20484516
I0210 17:24:47.049252 16731 layer_factory.hpp:77] Creating layer pool5
I0210 17:24:47.049255 16731 net.cpp:84] Creating Layer pool5
I0210 17:24:47.049257 16731 net.cpp:406] pool5 <- conv5
I0210 17:24:47.049262 16731 net.cpp:380] pool5 -> pool5
I0210 17:24:47.049299 16731 net.cpp:122] Setting up pool5
I0210 17:24:47.049302 16731 net.cpp:129] Top shape: 1 256 6 6 (9216)
I0210 17:24:47.049304 16731 net.cpp:137] Memory required for data: 20521380
I0210 17:24:47.049305 16731 layer_factory.hpp:77] Creating layer filter_ip6
I0210 17:24:47.049310 16731 net.cpp:84] Creating Layer filter_ip6
I0210 17:24:47.049312 16731 net.cpp:406] filter_ip6 <- embedding_fc2_embedding_fc2_0_split_4
I0210 17:24:47.049315 16731 net.cpp:380] filter_ip6 -> filter_ip6
I0210 17:24:47.086630 16731 net.cpp:122] Setting up filter_ip6
I0210 17:24:47.086650 16731 net.cpp:129] Top shape: 1 4718592 (4718592)
I0210 17:24:47.086653 16731 net.cpp:137] Memory required for data: 39395748
I0210 17:24:47.086660 16731 layer_factory.hpp:77] Creating layer feat0
I0210 17:24:47.086694 16731 net.cpp:84] Creating Layer feat0
I0210 17:24:47.086696 16731 net.cpp:406] feat0 <- pool5
I0210 17:24:47.086700 16731 net.cpp:406] feat0 <- filter_ip6
I0210 17:24:47.086704 16731 net.cpp:380] feat0 -> feat0
I0210 17:24:47.118703 16731 net.cpp:122] Setting up feat0
I0210 17:24:47.118718 16731 net.cpp:129] Top shape: 1 512 1 1 (512)
I0210 17:24:47.118721 16731 net.cpp:137] Memory required for data: 39397796
I0210 17:24:47.118727 16731 layer_factory.hpp:77] Creating layer bn_feat0
I0210 17:24:47.118733 16731 net.cpp:84] Creating Layer bn_feat0
I0210 17:24:47.118736 16731 net.cpp:406] bn_feat0 <- feat0
I0210 17:24:47.118741 16731 net.cpp:367] bn_feat0 -> feat0 (in-place)
I0210 17:24:47.118917 16731 net.cpp:122] Setting up bn_feat0
I0210 17:24:47.118921 16731 net.cpp:129] Top shape: 1 512 1 1 (512)
I0210 17:24:47.118923 16731 net.cpp:137] Memory required for data: 39399844
I0210 17:24:47.118927 16731 layer_factory.hpp:77] Creating layer scale_feat0
I0210 17:24:47.118932 16731 net.cpp:84] Creating Layer scale_feat0
I0210 17:24:47.118933 16731 net.cpp:406] scale_feat0 <- feat0
I0210 17:24:47.118937 16731 net.cpp:367] scale_feat0 -> feat0 (in-place)
I0210 17:24:47.118968 16731 layer_factory.hpp:77] Creating layer scale_feat0
I0210 17:24:47.119066 16731 net.cpp:122] Setting up scale_feat0
I0210 17:24:47.119071 16731 net.cpp:129] Top shape: 1 512 1 1 (512)
I0210 17:24:47.119071 16731 net.cpp:137] Memory required for data: 39401892
I0210 17:24:47.119076 16731 layer_factory.hpp:77] Creating layer relu_feat0
I0210 17:24:47.119079 16731 net.cpp:84] Creating Layer relu_feat0
I0210 17:24:47.119081 16731 net.cpp:406] relu_feat0 <- feat0
I0210 17:24:47.119083 16731 net.cpp:367] relu_feat0 -> feat0 (in-place)
I0210 17:24:47.119421 16731 net.cpp:122] Setting up relu_feat0
I0210 17:24:47.119424 16731 net.cpp:129] Top shape: 1 512 1 1 (512)
I0210 17:24:47.119426 16731 net.cpp:137] Memory required for data: 39403940
I0210 17:24:47.119428 16731 layer_factory.hpp:77] Creating layer filter_ip7
I0210 17:24:47.119433 16731 net.cpp:84] Creating Layer filter_ip7
I0210 17:24:47.119436 16731 net.cpp:406] filter_ip7 <- embedding_fc2_embedding_fc2_0_split_5
I0210 17:24:47.119439 16731 net.cpp:380] filter_ip7 -> filter_ip7
I0210 17:24:47.119540 16731 net.cpp:122] Setting up filter_ip7
I0210 17:24:47.119544 16731 net.cpp:129] Top shape: 1 512 (512)
I0210 17:24:47.119546 16731 net.cpp:137] Memory required for data: 39405988
I0210 17:24:47.119549 16731 layer_factory.hpp:77] Creating layer feat1
I0210 17:24:47.119555 16731 net.cpp:84] Creating Layer feat1
I0210 17:24:47.119558 16731 net.cpp:406] feat1 <- feat0
I0210 17:24:47.119560 16731 net.cpp:406] feat1 <- filter_ip7
I0210 17:24:47.119563 16731 net.cpp:380] feat1 -> feat1
I0210 17:24:47.119796 16731 net.cpp:122] Setting up feat1
I0210 17:24:47.119801 16731 net.cpp:129] Top shape: 1 1 1 1 (1)
I0210 17:24:47.119802 16731 net.cpp:137] Memory required for data: 39405992
I0210 17:24:47.119810 16731 net.cpp:200] feat1 does not need backward computation.
I0210 17:24:47.119812 16731 net.cpp:200] filter_ip7 does not need backward computation.
I0210 17:24:47.119815 16731 net.cpp:200] relu_feat0 does not need backward computation.
I0210 17:24:47.119817 16731 net.cpp:200] scale_feat0 does not need backward computation.
I0210 17:24:47.119818 16731 net.cpp:200] bn_feat0 does not need backward computation.
I0210 17:24:47.119820 16731 net.cpp:200] feat0 does not need backward computation.
I0210 17:24:47.119823 16731 net.cpp:200] filter_ip6 does not need backward computation.
I0210 17:24:47.119824 16731 net.cpp:200] pool5 does not need backward computation.
I0210 17:24:47.119827 16731 net.cpp:200] relu5 does not need backward computation.
I0210 17:24:47.119829 16731 net.cpp:200] scale_conv5 does not need backward computation.
I0210 17:24:47.119832 16731 net.cpp:200] bn_conv5 does not need backward computation.
I0210 17:24:47.119833 16731 net.cpp:200] conv5 does not need backward computation.
I0210 17:24:47.119835 16731 net.cpp:200] filter_ip5 does not need backward computation.
I0210 17:24:47.119854 16731 net.cpp:200] relu4 does not need backward computation.
I0210 17:24:47.119858 16731 net.cpp:200] scale_conv4 does not need backward computation.
I0210 17:24:47.119859 16731 net.cpp:200] bn_conv4 does not need backward computation.
I0210 17:24:47.119860 16731 net.cpp:200] conv4 does not need backward computation.
I0210 17:24:47.119863 16731 net.cpp:200] filter_ip4 does not need backward computation.
I0210 17:24:47.119865 16731 net.cpp:200] relu3 does not need backward computation.
I0210 17:24:47.119868 16731 net.cpp:200] scale_conv3 does not need backward computation.
I0210 17:24:47.119869 16731 net.cpp:200] bn_conv3 does not need backward computation.
I0210 17:24:47.119870 16731 net.cpp:200] conv3 does not need backward computation.
I0210 17:24:47.119874 16731 net.cpp:200] filter_ip3 does not need backward computation.
I0210 17:24:47.119875 16731 net.cpp:200] pool2 does not need backward computation.
I0210 17:24:47.119877 16731 net.cpp:200] relu2 does not need backward computation.
I0210 17:24:47.119879 16731 net.cpp:200] scale_conv2 does not need backward computation.
I0210 17:24:47.119881 16731 net.cpp:200] bn_conv2 does not need backward computation.
I0210 17:24:47.119884 16731 net.cpp:200] conv2 does not need backward computation.
I0210 17:24:47.119885 16731 net.cpp:200] filter_ip2 does not need backward computation.
I0210 17:24:47.119887 16731 net.cpp:200] pool1 does not need backward computation.
I0210 17:24:47.119889 16731 net.cpp:200] relu1 does not need backward computation.
I0210 17:24:47.119891 16731 net.cpp:200] scale_conv1 does not need backward computation.
I0210 17:24:47.119894 16731 net.cpp:200] bn_conv1 does not need backward computation.
I0210 17:24:47.119895 16731 net.cpp:200] conv1 does not need backward computation.
I0210 17:24:47.119899 16731 net.cpp:200] embedding_fc2_embedding_fc2_0_split does not need backward computation.
I0210 17:24:47.119900 16731 net.cpp:200] embedding_fc2 does not need backward computation.
I0210 17:24:47.119902 16731 net.cpp:200] relu_embedding_fc1 does not need backward computation.
I0210 17:24:47.119904 16731 net.cpp:200] scale_embedding_fc1 does not need backward computation.
I0210 17:24:47.119906 16731 net.cpp:200] bn_embedding_fc1 does not need backward computation.
I0210 17:24:47.119909 16731 net.cpp:200] embedding_fc1 does not need backward computation.
I0210 17:24:47.119910 16731 net.cpp:200] input does not need backward computation.
I0210 17:24:47.119912 16731 net.cpp:242] This network produces output feat1
I0210 17:24:47.119926 16731 net.cpp:255] Network initialization done.
I0210 17:24:47.154611 16731 upgrade_proto.cpp:77] Attempting to upgrade batch norm layers using deprecated params: ./snapshot/1/alex-ignet-embed_iter_20000.caffemodel
I0210 17:24:47.154629 16731 upgrade_proto.cpp:80] Successfully upgraded batch norm layers using deprecated params.
I0210 17:24:47.154633 16731 net.cpp:744] Ignoring source layer data
I0210 17:24:47.218271 16731 net.cpp:744] Ignoring source layer eucli_loss
I0210 17:25:03.165616 16731 solver.cpp:397]     Test net output #0: accuracy = 0.884274
I0210 17:25:03.165701 16731 solver.cpp:397]     Test net output #1: mae = 0.243019
I0210 17:25:03.165707 16731 solver.cpp:397]     Test net output #2: rmse = 0.319641
I0210 17:25:03.165712 16731 solver.cpp:315] Optimization Done.
I0210 17:25:03.165714 16731 caffe.cpp:259] Optimization Done.
